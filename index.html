<!DOCTYPE html>
<html  lang="zh">
<head>
    <meta charset="utf-8" />

<meta name="generator" content="Hexo 4.0.0" />

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<title>luxq blog</title>


    <meta name="description" content="Stay hungry, stay foolish">
<meta name="keywords" content="前端,js,jquery,javascript,html5,开发者,程序猿,程序媛,极客,编程,代码,开源,IT网站,Developer,Programmer,Coder,Geek,html,css,css3,用户体验">
<meta property="og:type" content="website">
<meta property="og:title" content="luxq blog">
<meta property="og:url" content="https:&#x2F;&#x2F;luxiqiang.github.io&#x2F;index.html">
<meta property="og:site_name" content="luxq blog">
<meta property="og:description" content="Stay hungry, stay foolish">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https:&#x2F;&#x2F;luxiqiang.github.io&#x2F;images&#x2F;og_image.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https:&#x2F;&#x2F;luxiqiang.github.io&#x2F;images&#x2F;og_image.png">







<link rel="icon" href="/images/favicon.svg">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
<style>body>.footer,body>.navbar,body>.section{opacity:0}</style>

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">

    
    
    
    
<link rel="stylesheet" href="/css/back-to-top.css">

    
    
    
    
    
    
    
    <link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
    
    
    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.svg" alt="luxq blog" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item is-active"
                href="/">主页</a>
                
                <a class="navbar-item"
                href="/archives">Archives</a>
                
                <a class="navbar-item"
                href="/categories">Categories</a>
                
                <a class="navbar-item"
                href="/tags">Tags</a>
                
                <a class="navbar-item"
                href="/about">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    <a class="navbar-item" target="_blank" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                
                
                
                <a class="navbar-item search" title="搜索" href="javascript:;" target="_blank" rel="noopener">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main">
    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2021-10-12T11:16:47.000Z">2021-10-12</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    1 小时 读完 (大约 7683 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/">什么是工作流</a>
            
        </h1>
        <div class="content">
            <h1 id="工作流"><a href="#工作流" class="headerlink" title="工作流"></a>工作流</h1><h2 id="一、什么是工作流"><a href="#一、什么是工作流" class="headerlink" title="一、什么是工作流"></a>一、什么是工作流</h2><p>历史发展：</p>
<blockquote>
<p>工作流的理论起源于70年代中期办公的自动化领域。90年代。工作流技术的研究与开发进一步发展。1993年8月，成立第一个工作流技术标准话的工业组织WFMC（工作流管理联盟）。现在，工作流管理系统已由最初的无纸化办公环境，转而成为企业试下业务流程自动执行的必要工具。</p>
</blockquote>
<p>定义：</p>
<blockquote>
<p>WFMC:工作流是指一类能够完全自动执行的经营过程，根据一系列的过程规则，将文档、信息或任务在不同的执行者之间进行传递与执行。</p>
</blockquote>
<blockquote>
<p>Georgakopoulos:工作里是将一组任务组织起来以完成某一个经营过程（定义了任务的触发顺序和触发条件，每一个任务可以由一个或多个软件系统完成，也可以由一个或一组人完成，还可以由一个或者多个人与软件系统协作完成）。</p>
</blockquote>
<blockquote>
<p>百度百科：工作流（WorkFlow），就是“业务过程的部分或整体在计算机应用环境下的自动化”。它主要解决的是“是在多个参与者之间按照某种预定义的规则传递文档、信息或任务的过程自动进行，从而实现某个预期的业务目标，或者促使次目标的实现”。</p>
</blockquote>
<h2 id="二、工作流管理系统WFMS"><a href="#二、工作流管理系统WFMS" class="headerlink" title="二、工作流管理系统WFMS"></a>二、工作流管理系统WFMS</h2><p>工作流管理系统（Workflow Management System，WFMS）是一个软件系统，它完成工作量的定义和管理，并按照在系统中预定义的工作流规则进行工作流实例的执行。工作流管理系统不是企业的业务系统，而是为企业的业务系统的运行提供了一个软件的支撑环境。</p>
<h2 id="三、工作流管理联盟WFMC"><a href="#三、工作流管理联盟WFMC" class="headerlink" title="三、工作流管理联盟WFMC"></a>三、工作流管理联盟WFMC</h2><p>工作流管理联盟（Workflow Management Coalition，WFMC）是一个由设计工作里和业务流程管理的全球性组织。该组织创建并完善了工作流的相关标准，开阔了相关市场，是唯一的致力于工作流标准化的专业组织。该组织推出了工作流XML（Wf-XML）和XML过程定义语言(XPDL)，现在由超过80种有名的解决方案中使用了这两种语言来存储和交换过程模型。</p>
<h2 id="四、为什么要使用工作流？"><a href="#四、为什么要使用工作流？" class="headerlink" title="四、为什么要使用工作流？"></a>四、为什么要使用工作流？</h2><p>我们来看一下这样一个业务场景。一个订货流程.</p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E8%AE%A2%E8%B4%A7%E6%B5%81%E7%A8%8B.png" alt="订货流程"></p>
<p>（1）.客户提交订单  （2）.业务员执行订单处理  （3）.如果缺货，转工厂生产  （4）.仓库发货  （5）.物流发货</p>
<p>不使用工作流，我们从头开发这个订货流程的业务逻辑，我们需要做哪些事？</p>
<ol>
<li>每一个活动点都需要开发交互界面和后台处理程序。</li>
<li>每个活动的流转都需要硬性判断下一步活动节点及其操作人</li>
<li>每次操作都需要维护业务数据和流程的相关数据</li>
</ol>
<p>结果应该是这样：这还不包括监视、控制、分析流程的部分。</p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E4%B8%8D%E4%BD%BF%E7%94%A8%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%BB%93%E6%9E%9C.png" alt="不使用工作流"></p>
<p>如果我们使用了工作流，结果应该是这样：</p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E4%BD%BF%E7%94%A8%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%BB%93%E6%9E%9C.png" alt="使用工作流"></p>
<p>这样做的好处有哪些：</p>
<ol>
<li>使用专门的流程数据系统，维护所有涉及流程流转的数据。</li>
<li>提供“流程设计”工具，帮助用户定义订货流程的模型，而且一般都提供了可视化的界面。</li>
<li>所有的流程都依靠流程引擎来处理，避免了需求更改与硬编码之间的矛盾的产生。</li>
<li>工作流引擎还提供了众多的API，可以很方便的将工作流的管理和有、任务操作完美结合。</li>
</ol>
<p><strong>总结，在核实的项目中引入工作流技术，对于基础开发来说，有这样的一些好处：</strong></p>
<p><em>1. 降低开发风险</em></p>
<p>通过使用诸如活动、流转、状态、行为这样的术语，使得业务分析师和开发人员使用同一种语言交流成为可能。优秀的流程实际建模工具，甚至能使开发人员不必将用户需求转化成详细设计文档。</p>
<p><em>2. 流程实现的集中统一</em></p>
<p>应对业务流程经常变化的情况，使用工作流技术的最大好处是使业务流程的实现代码，不再散落在各式各样的业务系统中。</p>
<p><em>3. 加速开发</em></p>
<p>开发者不用再关注流程的参与者、活动节点的衔接、流转控制等，因为这些工作很多都被工作流框架接管了。因为开发者开发起来更快、代码出错更少、系统更加容易维护。</p>
<p><em>4. 提升对迭代开发的支持</em></p>
<p>工作流管理系统使得业务流程很容易不熟和重新编排，业务流程相关的应用开发可以以一种“迭代/渐进”的方式推进，也就是说工作就技术在某种程度上支持“需求分析不必一次完全成功”。</p>
<h2 id="五、怎么使用工作流？"><a href="#五、怎么使用工作流？" class="headerlink" title="五、怎么使用工作流？"></a>五、怎么使用工作流？</h2><p><strong>重点：工作流一定要结合业务，单独使用没有任何意义。</strong></p>
<p>一些建议：</p>
<ol>
<li>明确工作流适用的行业。</li>
<li>明确关键的业务流程。</li>
<li>选定合适的工作流框架。</li>
<li>工作流一定要结合业务使用。</li>
</ol>
<h1 id="业务流程管理标注（BPMN2-0）"><a href="#业务流程管理标注（BPMN2-0）" class="headerlink" title="业务流程管理标注（BPMN2.0）"></a>业务流程管理标注（BPMN2.0）</h1><p>官网地址：<a href="http://www.bpmn.org" target="_blank" rel="noopener">www.bpmn.org</a></p>
<h2 id="一、什么是BPM？"><a href="#一、什么是BPM？" class="headerlink" title="一、什么是BPM？"></a>一、什么是BPM？</h2><p>业务流程管理（Business Process Management，BPM），是一种以规范化的构造端到端的卓越业务流程为中心，以持续的提高组织业务绩效为目的的系统优化方法；是一套达成企业各种业务环节整合的全面管理模式。</p>
<p>四种方法论：</p>
<blockquote>
<ol>
<li>面向工作流</li>
<li>面向文档</li>
<li>面向业务规则</li>
<li>面向EAI（Enterprise Application Integration，企业应用集成）</li>
</ol>
</blockquote>
<h2 id="二、什么是BPMN？"><a href="#二、什么是BPMN？" class="headerlink" title="二、什么是BPMN？"></a>二、什么是BPMN？</h2><p>业务流程模型注解（Business Process Modeling Notation,BPMN）是业务流程模型的一种标准图形注解。这个标准是由对象管理组（Object Management Group，OMG）来维护。</p>
<p><strong>BPMN的目标是定义可执行的业务流程。</strong></p>
<p>BPMN是一个基于BPM工业接受的标准的流程语言。</p>
<h2 id="三、BPMN2-0"><a href="#三、BPMN2-0" class="headerlink" title="三、BPMN2.0"></a>三、BPMN2.0</h2><h3 id="（1）基本介绍"><a href="#（1）基本介绍" class="headerlink" title="（1）基本介绍"></a>（1）基本介绍</h3><p>BPMN2.0版本，允许添加精确地技术细节在BPMN的图形和元素中，同时制定BPMN元素的执行语法。通过<strong>XML</strong>语言来指定业务流程的可执行语法，BPMN规范已经演变为业务流程语言，基于流程虚拟机（Process Virtual Machine，PVM），可以执行在任何兼容BPMN2.0的流程引擎中，同时依然可以使用强大的图形注解。</p>
<p>流程引擎是根据定义文件的后缀来区分流程定义的。对于BPMN2.0，使用*.bpmn.xml后缀。比如（”jbpm.bpmn.cfg.xml”…）</p>
<ul>
<li>BPMN2.0规范内容</li>
</ul>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/BPMN2%E8%A7%84%E8%8C%83%E5%86%85%E5%AE%B9.png" alt="BPMN2规范内容"></p>
<ul>
<li>BPMN2-Conformance一致性</li>
</ul>
<ol>
<li>Process Modeling Conformance(流程模型一致性)</li>
<li>Process Execution Conformance(流程执行一致性)</li>
<li>BPEL Process Execution Conformance(BPEL流程执行一致性)</li>
<li>Choreography Modeling Conformance(编排模型一致性)</li>
</ol>
<ul>
<li>BPMN2-Diagram Types 流程图类型</li>
</ul>
<ol>
<li>Private Processes 私有流程</li>
<li>Public Processes 共有流程</li>
<li>Choreographies Processes 组合流程</li>
</ol>
<h3 id="（2）流程元素"><a href="#（2）流程元素" class="headerlink" title="（2）流程元素"></a>（2）流程元素</h3><p>我们知道，BPMN2.0是通过<strong>XML</strong>语言来指定业务流程的可执行语法。所以这里有一段最简单的业务流程定义，尽管它还没有内容的。</p>
<p>xml文件：</p>
<figure class="highlight xml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">definitions</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"myProcess"</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLShema-instance"</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://schema/omg.org/spec/BPMN/2.0 BPMN20.xsd"</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">    <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://schema.omg.org/spec/BPMN/2.0"</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">    <span class="hljs-attr">typeLanguage</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema"</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">    <span class="hljs-attr">expressionLanguage</span>=<span class="hljs-string">"http://www.w3.org/1999/Xpath"</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">    <span class="hljs-attr">targetNamespace</span>=<span class="hljs-string">"http://jpbm.org/example/bpmn2"</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">process</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"My Bussiness Process"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"myBussinessProcess"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">    ....<span class="hljs-comment">&lt;!-- 基本结构--&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">process</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">definitions</span>&gt;</span></span></pre></td></tr></table></figure>
<p>流程的根元素是：definitions元素。在命名状态，子元素会包含真正的业务流程定义。每个process子元素，可以拥有一个id（必填）和name（选填）。</p>
<h3 id="（3）基本结构（流程定义的基本要素）"><a href="#（3）基本结构（流程定义的基本要素）" class="headerlink" title="（3）基本结构（流程定义的基本要素）"></a>（3）基本结构（流程定义的基本要素）</h3><p>遵循BPMN2.0新规范的工作流产品能很大程度上解决此类问题，BPMN2.0相对于旧的1.0规范以及XPDL，BPML和BPEL等最大的区别是定义了规范的执行语义和格式，利用标准的图元去描述真实的业务发生过程，保证相同的流程在不同的流程引擎得到的执行结果一致。BPMN2.0对流程执行语义定义了三类基本要素，他们是业务流程的“三板斧”。</p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/BPMN2%E4%B8%89%E7%B1%BB%E5%9F%BA%E6%9C%AC%E6%89%A7%E8%A1%8C%E8%AF%AD%E4%B9%89.png" alt="BPMN2三类基本执行语义"></p>
<h4 id="1-Activities活动"><a href="#1-Activities活动" class="headerlink" title="1.Activities活动"></a>1.Activities活动</h4><p> Activities活动，在工作流中所有具备生命周期状态的都可以成为“活动”，如原子级任务（Task），序列流（Sequence flow），以及子流程（Sub-Process）等。</p>
<p> Task和Sub-Process的符号表示参考：</p>
<p> <img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E6%B4%BB%E5%8A%A8.png" alt="活动"></p>
<h5 id="（1）Sequence-Flow序列流"><a href="#（1）Sequence-Flow序列流" class="headerlink" title="（1）Sequence Flow序列流"></a>（1）Sequence Flow序列流</h5><p>序列流是事件，活动和网关之间的连线，显示为一条实线 带有箭头， 每个顺序流都有一个源头和一个 目标引用，包含了 活动，事件或网关的id。</p>
<p>例如xml中定义一个序列流：</p>
<figure class="highlight xml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">sequenceFlow</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"myFlow"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"My Flow"</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">        <span class="hljs-attr">sourceRef</span>=<span class="hljs-string">"sourceId"</span> <span class="hljs-attr">targetRef</span>=<span class="hljs-string">"targetId"</span> /&gt;</span></span></pre></td></tr></table></figure>

<p>当有多个外向序列流的行为。如</p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E5%A4%9A%E4%B8%AA%E5%A4%96%E5%90%91%E5%BA%8F%E5%88%97%E6%B5%81.png" alt="多个外向序列流"></p>
<p>此时应该在每条序列流上设置流程参数，根据参数条件决定执行哪一条序列流；或者使用网关的形式予以拆分。</p>
<p><strong>默认序列流</strong></p>
<p>活动（比如用户任务）和网关（比如唯一网关）可以使用默认序列流流。 默认序列流只会在活动或网关的所有其他外向序列流的condition条件为false时才会使用。 默认序列流图形像是序列流多了一个斜线标记。</p>
<p>默认序列流通过指定活动或网关的 ‘default’ 属性来使用。</p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E9%BB%98%E8%AE%A4%E5%BA%8F%E5%88%97%E6%B5%81.png" alt="默认序列流"></p>
<p>序列流是BPMN2.0中的Connecting Flow Objects（连接流对象），除此之外，还有Message Flow（消息流）、Associations（关联关系）、Data Associations（数据关联）。</p>
<p><strong>Message Flow（消息流）</strong></p>
<p>Message Flows 用虚线空心箭头表示，用于2个分开的流程参与者直接发送或者接收到的消息流.</p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E6%B6%88%E6%81%AF%E6%B5%81.png" alt="消息流"></p>
<p><strong>Associations（关联关系）、Data Associations（数据关联）</strong></p>
<p>Associations 用点状虚线表示，用于显示活动的输入输出，关联上的箭头表示流动方向（比如：数据）。</p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E5%85%B3%E8%81%94%E5%85%B3%E7%B3%BB%E6%B5%81%E4%B8%8D%E5%B8%A6%E7%AE%AD%E5%A4%B4.png" alt="关联关系不带箭头"></p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E5%85%B3%E8%81%94%E5%85%B3%E7%B3%BB%E6%B5%81%E5%B8%A6%E7%AE%AD%E5%A4%B4.png" alt="关联关系带箭头"></p>
<h5 id="（2）Task任务"><a href="#（2）Task任务" class="headerlink" title="（2）Task任务"></a>（2）Task任务</h5><p> 任务是工作流中的原子活动。当流程中的工作不能被细分为更精细的细节时，将使用任务。通常，最终用户和/或应用程序在被用来执行任务。</p>
<p> 有哪些任务语义：<br> <img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E4%BB%BB%E5%8A%A1%E7%BB%93%E6%9E%84%E5%9B%BE.png" alt="任务结构图"></p>
<p>以下对相关任务做简单进行说明：</p>
<p><strong>①MunualTask手动任务</strong></p>
<p>手动任务是不受任何业务流程引擎管理的任务。它可以被认为是一个非托管任务，不受管理的意义在于业务流程引擎不跟踪此类任务的开始和完成。此类任务不参与实际工作流流转。常用于诸如物流系统中的装货，运顺等任务的描述。</p>
<p><strong>②UserTask用户任务</strong></p>
<p>UserTask用户任务是典型的“工作流”任务,也可以叫“人机交互任务”。人员在软件应用程序的帮助下执行任务。任务的生命周期有软件组件（任务管理器）管理，通常在进程的上下文中执行。主要用来描述人为在软件系统中进行诸如任务明细查询、填写审批意见等业务行为的操作，流程引擎流转到此类节点时，系统会自动生成被动触发任务，需人工响应后才能继续向下流转。</p>
<p>用户任务可以把任务分配给个人，组，角色组来执行，在定义用户任务时指定，完成相应工作后，用户任务完成。</p>
<p><strong>③ServiceTask服务任务</strong></p>
<p>ServiceTask服务任务是某种使用了服务的任务，可以是Web服务或自动应用程序。它是一个自动活动，它会调用一些服务，比如web service、java service等等。</p>
<p>通常在工作流流转的过程中会涉及到与自身系统服务的API调用或外部服务调用的情况，此类任务往往由一个特定业务服务功能的Java类来承担，与UserTask不同，流程引擎经此节点会自动调用Java类中定义的方法，方法执行完毕自动向下一流程节点流转。另外，此类任务还可充当“条件路由”的功能对流程流转可选分支进行自动判断。常用于业务逻辑API的调用。</p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/ServiceTask.png" alt="ServiceTask"></p>
<blockquote>
<p>此外，当服务任务引用一个操作时，会引入以下约束：<br>1.服务任务只有一个inputSet和最多一个outputSet。它具有单个数据输入，其ItemDefinition等同于由相关联操作的inMessageRef属性引用的消息定义的数据输入。<br>2.如果操作定义输出消息，则服务任务具有单个数据输出，其具有与由相关联的操作的outMessageRef属性引用的消息定义的ItemDefinition相同的数据输出。<br>使用服务的实际参与者可以通过使用过程的定义协作中的消息流将服务任务连接到参与者来识别</p>
</blockquote>
<p>我们来看一个例子：</p>
<p>在XML文件中定义一个服务任务：</p>
<figure class="highlight xml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">serviceTask</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"MyServiceTask"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"My service task"</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">  <span class="hljs-attr">implementation</span>=<span class="hljs-string">"Other"</span> <span class="hljs-attr">operationRef</span>=<span class="hljs-string">"myOperation"</span> /&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">&lt;!-- </span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">implementation:此属性指定将用于发送和接收消息的技术。有效值是“## unspec”，用于使实现技术打开，Web服务技术的“## WebService”或标识任何其他技术或协调协议的URI。 Web服务是默认技术。</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">可选值是WebService, Other或者Unspecified。 这里选择Other（java调用）。</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">operationRef：此属性指定由服务任务调用的操作。</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">--&gt;</span></span></pre></td></tr></table></figure>

<p>一个接口实例：</p>
<figure class="highlight xml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">interface</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"myInterface"</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">    <span class="hljs-attr">name</span>=<span class="hljs-string">"org.jbpm.MyJavaServicek"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">operation</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"myOperation"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"myMethod"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">inMessageRef</span>&gt;</span>inputMessage<span class="hljs-tag">&lt;/<span class="hljs-name">inMessageRef</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">outMessageRef</span>&gt;</span>outputMessage<span class="hljs-tag">&lt;/<span class="hljs-name">outMessageRef</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    <span class="hljs-tag">&lt;/<span class="hljs-name">bpmn:operation</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">interface</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">&lt;!-- </span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">服务任务将调用一个操作，operation的id 会在operationRef属性中引用</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">每个操作都至少有一个 输入信息，并且最多有一个 输出信息。</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">对于Java服务，接口的名称用来 指定java类的全类名。操作的名称 用来指定将要调用方法名。 输入/输出信息表示着java方法的参数/返回值</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">--&gt;</span></span></pre></td></tr></table></figure>

<p><strong>④RecieveTask接收任务</strong></p>
<p>接收任务是一个简单任务，它会等待对应消息的到达。一旦接收消息，任务完成。接收任务通常用于启动进程。<br>可以通过使用接收任务连接到参与者来识别接收到消息的实际参与者。</p>
<p>当流程达到接收任务，流程状态会保存到数据库中。</p>
<p>在任务创建后，以为着流程会进入等待状态，直到引擎接收一个特定的消息，这会触发流程穿过接受任务继续执行。</p>
<p><strong>⑤SendTask发送任务</strong></p>
<p>SendTask发送任务是一个简单的任务，旨在向外部参与者发送消息。消息发送完毕后，任务完成。<br>可以通过使用发送任务连接到参与者来识别发送消息的实际参与者。</p>
<p><strong>⑥ScriptTask脚本任务</strong></p>
<p>脚本任务是一个自动活动，由业务流程引擎执行。建模器或实现者使用引擎可以解释的语言定义脚本。当Task启动时，引擎将执行该脚本。脚本完成后，任务也将完成。</p>
<p>目前支持的脚本类型有三种：JUEL（JSP EL）、Groovy、JavaScript。在Activiti中还支持Shell Task，与Script由类似的功能。</p>
<p><strong>⑦Business Rule Task业务规则任务</strong></p>
<p>业务规则任务为流程提供了一种项业务规则引擎提供输入并获取业务规则引擎可能提供的计算输出的机制。该任务允许进程向“业务规则引擎”发送数据并从其接收数据。</p>
<h5 id="（2）Sub-Process子流程-内嵌子流程"><a href="#（2）Sub-Process子流程-内嵌子流程" class="headerlink" title="（2）Sub-Process子流程(内嵌子流程)"></a>（2）Sub-Process子流程(内嵌子流程)</h5><p>子流程是一个活动，其内部细节使用活动，网关，事件和序列流进行建模。 子流程是流程内的图形对象，但也可以“打开”以显示较低级别的流程。 子流程定义可用于属性可见性，事务范围，异常处理，事件或弥补的上下文范围。</p>
<p>子流程的第一目的是实现流程的“继承”，意味着 设计者可以创建多个不同“级别”的细节。顶级视图理解为做一件事情的最高级别方式，最低的级别 就关注具体细节。</p>
<p>这是一个折叠子流程：</p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E6%8A%98%E5%8F%A0%E5%AD%90%E6%B5%81%E7%A8%8B.png" alt="折叠子流程"></p>
<p>这是一个展开的子流程</p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E5%B1%95%E5%BC%80%E5%AD%90%E6%B5%81%E7%A8%8B.png" alt="展开子流程"></p>
<p>下面我们来看一个例子，在这个模型里，只有最高级的步骤显示出来。 实际的实现”Check credit”步骤隐藏在折叠子流程中。在实际与用户交流业务的过程中，落实主要的业务流程，再去落实每个可能涉及的子流程业务细节。</p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E5%AD%90%E6%B5%81%E7%A8%8B%E7%A4%BA%E4%BE%8B.png" alt="子流程示例"></p>
<p>“Check credit”子流程展开是这样的：</p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E5%AD%90%E6%B5%81%E7%A8%8B%E7%A4%BA%E4%BE%8B%E5%B1%95%E5%BC%80.png" alt="子流程示例展开"></p>
<p>这个流程用xml文件描述就是：</p>
<figure class="highlight xml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">process</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"embeddedSubprocess"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">startEvent</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"theStart"</span> /&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">sequenceFlow</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"flow1"</span> <span class="hljs-attr">sourceRef</span>=<span class="hljs-string">"theStart"</span> <span class="hljs-attr">targetRef</span>=<span class="hljs-string">"receiveOrder"</span> /&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">receiveTask</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"Receive order"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"receiveOrder"</span> /&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">sequenceFlow</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"flow2"</span> <span class="hljs-attr">sourceRef</span>=<span class="hljs-string">"receiveOrder"</span> <span class="hljs-attr">targetRef</span>=<span class="hljs-string">"checkCreditSubProcess"</span> /&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">subProcess</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"checkCreditSubProcess"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"Credit check"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">      ...<span class="hljs-comment">&lt;!-- 子流程细节--&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">    <span class="hljs-tag">&lt;/<span class="hljs-name">subProcess</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">sequenceFlow</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"flow9"</span> <span class="hljs-attr">sourceRef</span>=<span class="hljs-string">"checkCreditSubProcess"</span> <span class="hljs-attr">targetRef</span>=<span class="hljs-string">"theEnd"</span> /&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">endEvent</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"theEnd"</span> /&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">process</span>&gt;</span></span></pre></td></tr></table></figure>

<p>再看一个例子：</p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E6%89%A9%E5%B1%95%E5%AD%90%E6%B5%81%E7%A8%8B.png" alt="扩展子流程"></p>
<p>扩展的子流程可以用作以较不混乱，更紧凑的方式显示一组并行活动的机制。活动“C”和“D”包含在未标记的扩展子流程中。这两个活动将并行执行。</p>
<p>BPMN指定了五种类型的子流程的标准标记。 （折叠）子流程标记，可以与四个其他标记组合使用：循环标记、多实例标记、弥补标记、Ad-Hoc标记。在所有组合中，折叠的子流程可能有一到三个这些其他标记，除了循环和多实例不能同时显示。  </p>
<p>下面是组合使用的部分情形：</p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E5%AD%90%E6%B5%81%E7%A8%8B%E6%A0%87%E8%AE%B0%E7%BB%84%E5%90%88%E4%BD%BF%E7%94%A8.png" alt="子流程标记组合使用"></p>
<p>除此之外，还有其他的子流程类型，比如Event Sub-Process（事件子流程）、Transaction Sub-Process(事务子流程)。</p>
<p><strong>Event Sub-Process（事件子流程）</strong></p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E4%BA%8B%E4%BB%B6%E5%AD%90%E6%B5%81%E7%A8%8B.png" alt="事件子流程"></p>
<p><strong>Transaction Sub-Process(事务子流程)</strong></p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E4%BA%8B%E5%8A%A1%E5%AD%90%E6%B5%81%E7%A8%8B.png" alt="事务子流程"> </p>
<h4 id="2-Gateways网关"><a href="#2-Gateways网关" class="headerlink" title="2.Gateways网关"></a>2.Gateways网关</h4><p>网关用于控制序列流在流程内的合并和拆分的相互作用，用来控制流程流转的指向的。如果不需要控制流程则不需要网关。更确切的说，当一个token（令牌）到达一个网关，它会根据网关的类型进行合并和拆分。</p>
<p>网关的符号表示参考：</p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E7%BD%91%E5%85%B3.png" alt="GateWay"></p>
<p>所有的网关类型，都可以设置gatewayDirection。取值：</p>
<blockquote>
<ul>
<li>unspecificed (默认)：网关可能拥有多个 进入和外出顺序流。</li>
<li>mixed：网关必须拥有多个 进入和外出顺序流。</li>
<li>converging：网关必须拥有多个进入顺序流， 但是只能有一个外出顺序流。</li>
<li>diverging：网关必须拥有一个进入顺序流， 和多个外出顺序流。</li>
</ul>
</blockquote>
<p><strong>①Exclusive Gateway排它网关（互斥网关）</strong></p>
<p>排它网关表达了一个流程中的唯一决策。 根据定义在顺序流中的条件,选择符合条件的下一流程流向。</p>
<p>我们来看一个例子：</p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/ExclusiveGateway.png" alt="ExclusiveGateway"></p>
<p>根据amount变量的值， 会选择唯一网关外向的三个外向顺序流 中的一个。  </p>
<p>一般情况下，排它网关需要所有外向顺序流上都定义条件。 但是，有一种例外是默认顺序流， 在网关定义时使用default 属性来引用一个已存在的顺序流的id。当其他外向顺序流的条件都执行为false时，这个顺序流就会被使用。</p>
<p><strong>②Exclusive Gateway并行网关</strong></p>
<p>并行网关用来切分或同步相关的进入或外出顺序流。</p>
<p>我们来看一个例子：</p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/ParallelGateway.png" alt="ParallelGateway"></p>
<p>注意：当流程启动时，在流程启动后， ‘prepare shipment’ 和 ‘bill customer’用户任务都会被激活，同时往下执行。当到达合并节点时，需要两个流程实例都完成，才能继续往下执行。</p>
<p><strong>③Inclusive Gateway包容网关</strong></p>
<p>Inclusive Gateway包含网关， 被用来 进行“条件性”切分或汇聚顺序流。它基本的行为就和一个并行网关一样， 但是它也可以统计条件，在外出顺序流上（切分行为） 和计算，如果这儿有流程离开，可以到达网关（合并行为）。</p>
<p>建议：最佳实践是让包含网关成对使用。</p>
<p>我们看下面这个例子：</p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/InclusiveGateway.png" alt="InclusiveGateWay"></p>
<p>针对以上的例子，作出解释如下：</p>
<ul>
<li>现金多于10000，不是国外银行：只有 “Large deposit” 任务会被激活。</li>
<li>现金多于10000，是国外银行： “Large deposit” 和 “Foreign deposit” 任务会被激活。</li>
<li>现金少于10000，是国外银行： 只有 “Foreign deposit” 任务会被激活。</li>
<li>现金少于10000，不是国外银行： 在这种情况 所有表达式的结果都是false，默认的顺序流会被选择。 在这个例子中国，这意味着”Standard deposit”任务会被激活。</li>
</ul>
<p>无论在包含网关之后多少任务被激活，右侧的聚合包含网关会等到左侧的包含网关所有外向顺序流到达合并网关。<br>和其他网关类型一样，包含网关类型可以同时拥有合并和切分行为。 在这种情况下，包含网关将先等到所有分支流程到达，</p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/InclusiveGatewayFlow.png" alt="InclusiveGatewayFlow"></p>
<h4 id="3-Events事件"><a href="#3-Events事件" class="headerlink" title="3.Events事件"></a>3.Events事件</h4><p>事件在实际的每个业务流程中都会使用。 事件让业务建模工具用很自然的方式描述业务流程。  </p>
<blockquote>
<p>比如 ‘当我接收到客户的订单，这个流程就启动’， ‘如果两天内任务没结束，就终止流程’ 或者‘当我收到一封取消邮件，当流程在运行时， 使用子流程处理邮件’。  </p>
</blockquote>
<p>注意典型的业务通常使用这种事件驱动的方式。人们不会硬编码顺序创建， 但是他们倾向于使用在他们的环境中发生的事情（比如，事件）。 为了覆盖可能的事情， 在业务环境中可能出现的情况,在BPMN规范中，描述了很多事件类型.</p>
<h5 id="1-Start-Event开始事件（启动事件）"><a href="#1-Start-Event开始事件（启动事件）" class="headerlink" title="(1)Start Event开始事件（启动事件）"></a>(1)Start Event开始事件（启动事件）</h5><p>开始事件指定流程将在哪里开始。在序列流方面，启动事件启动进程的流程，因此不会有任何进入的序列流。</p>
<p>Start Event可以用于这些类型的流程：</p>
<ul>
<li>顶级流程</li>
<li>嵌入式的子流程</li>
<li>全局流程</li>
<li>事件子流程</li>
</ul>
<p>一些建议和说明：</p>
<ul>
<li>启动事件的使用对于每个流程的每个级别都是独立的。</li>
<li>如果流程复杂和/或启动条件不明显，则建议使用启动事件。</li>
<li>如果不使用启动事件，则该进程的隐式启动事件不应该具有触发器。</li>
<li>如果有结束事件，则必须至少有一个结束事件。</li>
</ul>
<p>不同类型的流程可以使用的启动事件的类型不同：</p>
<p><strong>①顶级流程Top-Level Process Start Event Types</strong></p>
<table>
<thead>
<tr>
<th align="left">Trigger</th>
<th align="center">Mark</th>
</tr>
</thead>
<tbody><tr>
<td align="left">None空启动事件</td>
<td align="center"><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E7%A9%BA%E5%90%AF%E5%8A%A8%E4%BA%8B%E4%BB%B6.png" alt="空启动事件"></td>
</tr>
<tr>
<td align="left">Message消息启动事件</td>
<td align="center"><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E6%B6%88%E6%81%AF%E5%90%AF%E5%8A%A8%E4%BA%8B%E4%BB%B6.png" alt="消息启动事件"></td>
</tr>
<tr>
<td align="left">Timer定时启动事件</td>
<td align="center"><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E5%AE%9A%E6%97%B6%E5%90%AF%E5%8A%A8%E4%BA%8B%E4%BB%B6.png" alt="定时启动事件"></td>
</tr>
<tr>
<td align="left">Conditional条件启动事件</td>
<td align="center"><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E6%9D%A1%E4%BB%B6%E5%90%AF%E5%8A%A8%E4%BA%8B%E4%BB%B6.png" alt="条件启动事件"></td>
</tr>
<tr>
<td align="left">Signal信号启动事件</td>
<td align="center"><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E4%BF%A1%E5%8F%B7%E5%90%AF%E5%8A%A8%E4%BA%8B%E4%BB%B6.png" alt="定时启动事件"></td>
</tr>
<tr>
<td align="left">Multiple多个启动事件</td>
<td align="center"><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E5%A4%9A%E4%B8%AA%E5%90%AF%E5%8A%A8%E4%BA%8B%E4%BB%B6.png" alt="定时启动事件"></td>
</tr>
<tr>
<td align="left">Parallel Multiple并行多个启动事件</td>
<td align="center"><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E5%B9%B6%E8%A1%8C%E5%A4%9A%E4%B8%AA%E5%90%AF%E5%8A%A8%E4%BA%8B%E4%BB%B6.png" alt="定时启动事件"></td>
</tr>
</tbody></table>
<p><strong>②嵌入式的子流程Start Events for Sub-Processes</strong></p>
<table>
<thead>
<tr>
<th align="left">Trigger</th>
<th align="center">Mark</th>
</tr>
</thead>
<tbody><tr>
<td align="left">None空启动事件</td>
<td align="center"><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E7%A9%BA%E5%90%AF%E5%8A%A8%E4%BA%8B%E4%BB%B6.png" alt="空启动事件"></td>
</tr>
</tbody></table>
<p><strong>③事件子流程Start Events for Event Sub-Processes</strong></p>
<table>
<thead>
<tr>
<th align="left">Trigger</th>
<th align="center">Mark</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Message消息启动事件</td>
<td align="center"><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E6%B6%88%E6%81%AF%E5%90%AF%E5%8A%A8%E4%BA%8B%E4%BB%B6.png" alt="消息启动事件">  <img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E7%A9%BA%E6%B6%88%E6%81%AF%E5%90%AF%E5%8A%A8%E4%BA%8B%E4%BB%B6.png" alt="空消息启动事件"></td>
</tr>
<tr>
<td align="left">Timer定时启动事件</td>
<td align="center"><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E5%AE%9A%E6%97%B6%E5%90%AF%E5%8A%A8%E4%BA%8B%E4%BB%B6.png" alt="定时启动事件">  <img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E7%A9%BA%E5%AE%9A%E6%97%B6%E5%90%AF%E5%8A%A8%E4%BA%8B%E4%BB%B6.png" alt="空定时启动事件"></td>
</tr>
<tr>
<td align="left">Escalation升级启动事件</td>
<td align="center"><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E5%8D%87%E7%BA%A7%E5%90%AF%E5%8A%A8%E4%BA%8B%E4%BB%B6.png" alt="升级启动事件">  <img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E7%A9%BA%E5%8D%87%E7%BA%A7%E5%90%AF%E5%8A%A8%E4%BA%8B%E4%BB%B6.png" alt="升级启动事件"></td>
</tr>
<tr>
<td align="left">Error错误启动事件</td>
<td align="center"><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E9%94%99%E8%AF%AF%E5%90%AF%E5%8A%A8%E4%BA%8B%E4%BB%B6.png" alt="错误启动事件"></td>
</tr>
<tr>
<td align="left">Compensation赔偿启动事件</td>
<td align="center"><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E8%B5%94%E5%81%BF%E5%90%AF%E5%8A%A8%E4%BA%8B%E4%BB%B6.png" alt="赔偿启动事件"></td>
</tr>
<tr>
<td align="left">Conditional条件启动事件</td>
<td align="center"><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E6%9D%A1%E4%BB%B6%E5%90%AF%E5%8A%A8%E4%BA%8B%E4%BB%B6.png" alt="条件启动事件">  <img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E7%A9%BA%E6%9D%A1%E4%BB%B6%E5%90%AF%E5%8A%A8%E4%BA%8B%E4%BB%B6.png" alt="条件启动事件"></td>
</tr>
<tr>
<td align="left">Signal信号条件启动事件</td>
<td align="center"><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E4%BF%A1%E5%8F%B7%E5%90%AF%E5%8A%A8%E4%BA%8B%E4%BB%B6.png" alt="信号启动事件">  <img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E7%A9%BA%E4%BF%A1%E5%8F%B7%E5%90%AF%E5%8A%A8%E4%BA%8B%E4%BB%B6.png" alt="信号启动事件"></td>
</tr>
<tr>
<td align="left">Multiple多个条件启动事件</td>
<td align="center"><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E5%A4%9A%E4%B8%AA%E5%90%AF%E5%8A%A8%E4%BA%8B%E4%BB%B6.png" alt="信号启动事件">  <img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E7%A9%BA%E5%A4%9A%E4%B8%AA%E5%90%AF%E5%8A%A8%E4%BA%8B%E4%BB%B6.png" alt="多个启动事件"></td>
</tr>
<tr>
<td align="left">Parallel Multiple并行多个启动事件</td>
<td align="center"><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E5%B9%B6%E8%A1%8C%E5%A4%9A%E4%B8%AA%E5%90%AF%E5%8A%A8%E4%BA%8B%E4%BB%B6.png" alt="定时启动事件"></td>
</tr>
</tbody></table>
<h5 id="2-End-Event空结束事件"><a href="#2-End-Event空结束事件" class="headerlink" title="(2)End Event空结束事件"></a>(2)End Event空结束事件</h5><p>结束事件指定了流程实例中一个流程路径的结束。 </p>
<p>图形上，它看起来就是一个圆 拥有厚边框（可能） 内部有小图标。 图标指定了结束的时候 会执行哪种操作。</p>
<p>当流程到达事件时，不会抛出任何信号。 </p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E7%A9%BA%E7%BB%93%E6%9D%9F%E4%BA%8B%E4%BB%B6.png" alt="空结束事件"></p>
<p>空结束事件可以像下面一样定义，id是必填的，name是可选的。</p>
<figure class="highlight xml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">endEvent</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"end"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"myEnd"</span> /&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">`</span></pre></td></tr></table></figure>

<p>下面的例子显示了只使用空开始和结束事件的流程：<br> <figure class="highlight xml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">process</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"noneStartEndEvent"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"BPMN2 Example none start and end event"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">startEvent</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"start"</span> /&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">sequenceFlow</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"flow1"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"fromStartToEnd"</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">    <span class="hljs-attr">sourceRef</span>=<span class="hljs-string">"start"</span> <span class="hljs-attr">targetRef</span>=<span class="hljs-string">"end"</span> /&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">endEvent</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"end"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"End"</span> /&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">process</span>&gt;</span></span></pre></td></tr></table></figure></p>
<h5 id="3-Terminate-End-Event终止结束事件"><a href="#3-Terminate-End-Event终止结束事件" class="headerlink" title="(3)Terminate End Event终止结束事件"></a>(3)Terminate End Event终止结束事件</h5><p>终止和空结束事件的区别是 实际中流程的路径是如何处理的（或者使用BPMN 2.0的术语叫做token）。 终止结束事件会结束整个流程实例，而空结束事件只会结束当前流程路径。 他们都不会抛出任何事情 当到达结束事件的时候。</p>
<p>一个终止结束事件可以像下面定义。id是必填的，name是可选的。</p>
<figure class="highlight xml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">endEvent</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"terminateEnd"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"myTerminateEnd"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">terminateEventDefinition</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">endEvent</span>&gt;</span></span></pre></td></tr></table></figure>

<p>终止结束事件被描绘成结束事件一样（圆，厚边框）， 内部图标时一个完整的圆。在下面的例子中，完成task1 会结束流程实例，当完成task2时只会结束到达结束事件 的流程路径，只剩下task1打开。</p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E7%BB%88%E6%AD%A2%E7%BB%93%E6%9D%9F%E4%BA%8B%E4%BB%B6%E7%A4%BA%E4%BE%8B.png" alt="终止结束事件示例"></p>
<h3 id="（4）除了三类基本执行语义的扩展内容"><a href="#（4）除了三类基本执行语义的扩展内容" class="headerlink" title="（4）除了三类基本执行语义的扩展内容"></a>（4）除了三类基本执行语义的扩展内容</h3><h4 id="1-Data数据"><a href="#1-Data数据" class="headerlink" title="1.Data数据"></a>1.Data数据</h4><ul>
<li>①.Data Objects 数据对象</li>
<li>②.Data Inputs 数据输入</li>
<li>③.Data OutPuts 数据输出</li>
<li>④.Data Stores 数据存储</li>
</ul>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/Data%E6%95%B0%E6%8D%AE.png" alt="Data数据"></p>
<h4 id="2-Swimlanes泳道"><a href="#2-Swimlanes泳道" class="headerlink" title="2.Swimlanes泳道"></a>2.Swimlanes泳道</h4><p><strong>①.Pools 泳池</strong></p>
<p>描述流程中的一个参与者。可以看做是将一系列活动区别于其他池的一个图形容器，一般用于B2B的上下文中。</p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/Pool%E6%B1%A0.png" alt="Pool泳池"></p>
<p><strong>②.Lanes 泳道</strong> </p>
<p>泳道就是在池里面再细分，可以是垂直的也可以是水平的，泳道也用于组织和分类活动。</p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/Lane%E6%B3%B3%E9%81%93.png" alt="Lane"></p>
<h4 id="3-Artifacts工件"><a href="#3-Artifacts工件" class="headerlink" title="3.Artifacts工件"></a>3.Artifacts工件</h4><p><strong>①.Group 组</strong></p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/Group%E7%BB%84.png" alt="Group"> </p>
<p><strong>②.Text Annotation 文本注释</strong></p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/TextAnnotation%E6%96%87%E6%9C%AC%E6%B3%A8%E9%87%8A.png" alt="TextAnnotation"></p>
<h3 id="（5）一个具体的例子"><a href="#（5）一个具体的例子" class="headerlink" title="（5）一个具体的例子"></a>（5）一个具体的例子</h3><p>这是一个常见的请假业务流程定义。</p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E6%B5%81%E7%A8%8B%E7%A4%BA%E4%BE%8B.png" alt="流程示例"></p>
<p>这个例子中所所用流程定义说明：</p>
<p><img src="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/%E7%A4%BA%E4%BE%8B%E6%89%80%E7%94%A8%E6%B5%81%E7%A8%8B%E5%AE%9A%E4%B9%89.png" alt="示例所用流程定义"></p>
<h3 id="（6）BPMN2-0术语"><a href="#（6）BPMN2-0术语" class="headerlink" title="（6）BPMN2.0术语"></a>（6）BPMN2.0术语</h3><p>附件：<a href="http://172.18.3.103/aneid/docs/tree/master/03_技术准备/支撑服务/工作流/docs/bpmn/BPMN2术语表.docx" target="_blank" rel="noopener">BPMN2术语表</a></p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2021-10-12T09:27:11.000Z">2021-10-12</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    1 小时 读完 (大约 9618 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2021/10/12/BIM%E4%BB%8B%E7%BB%8D/">BIM介绍</a>
            
        </h1>
        <div class="content">
            <p>什么是BIM?</p>
<p>进入2017年以后，一个被称之为“BIM”的新事物出现在中国的建筑业中，瞬时间所有的施工企业都面临着接触BIM的挑战。</p>
<p>BIM是源自于“Building Information Modeling”的缩写，中文译为“建筑信息模型”。该技术通过数字化手段，在计算机中建立出一个虚拟建筑，该虚拟建筑会提供一个单一、完整、包含逻辑关系的建筑信息库。需要注意的是，在这其中“信息”的内涵不仅仅是几何形状描述的视觉信息，还包含大量的非几何信息，如材料的耐火等级和传热系数、构件的造价和采购信息等等。其本质是一个按照建筑直观物理形态构建的数据库，其中记录了各阶段的所有数据信息。建筑信息模型（BIM）应用的精髓在于这些数据能贯穿项目的整个寿命期，对项目的建造及后期的运营管理持续发挥作用。</p>
<p><img src="http://cdn-ali.aecichina.com/qiniu/ueditor%2F15135874430.png" alt="BIM图文全解！十分钟了解BIM"></p>
<p>BIM基本特性</p>
<p>BIM是以建筑工程项目的各项相关信息数据为基础而建立的建筑模型。通过数字信息仿真，模拟建筑物所具有的真实信息。BIM是以从设计、施工到运营协调、项目信息为基础而构建的集成流程，它具有可视化、协调性、模拟性、优化性和可出图性5大特点。建筑公司通过使用BIM，可以在整个流程中将统一的信息创新、设计和绘制出项目，还可以通过真实性模拟和建筑可视化来更好地沟通，以便让项目各方了解工期、现场实时情况、成本和环境影响等项目基本信息。</p>
<p><strong>(一) 可视化</strong></p>
<p>可视化，即“所见即所得”的形式，对于建筑行业来说，可视化真正运用在建筑业地作用非常大。例如，经常拿到的施工图纸只是各个构件的信息，在图纸上以线条绘制表达，但是真正的构造形式就需要建筑业人员去自行想象了。如果建筑结构简单，那么没有太大的问题，但是近几年形式各异、复杂造型的建筑不断推出，那么光靠想象就不太实际了。所以BIM提供了可视化的思路，将以往的线条式的构件，形成一种三维的立体实物图形展示在人们的面前。</p>
<p><img src="http://cdn-ali.aecichina.com/qiniu/ueditor%2F15135874438.png" alt="BIM图文全解！十分钟了解BIM"></p>
<p>以前，建筑业也会制作设计方面的效果图，但是这种效果图是分包给专业的效果图制作团队，根据线条式信息识读设计制作出来的，并不是通过构件的信息自动生成的，因此缺少了同构件之间的互动性和反馈性。而BIM提到的可视化，则是一种能够同构件之间形成互动性和反馈性的可视化。在BIM建筑信息模型中，由于整个过程都是可视的，所以可以用于效果图的展示和报表的生成。更重要的是通过建筑可视化，可以在项目的设计、建造和运营过程中进行沟通、讨论和决策。</p>
<p><strong>(二) 协调性</strong></p>
<p>协调性是建筑业中的重点内容，无论是施工单位和设计单位还是业主，都在做着协调及相互配合的工作。一旦在项目的实施过程中遇到了问题，就需要各相关人员组织起来进行协调会议，找出施工中问题发生的原因及解决办法，然后做出相应变更、补救措施等来解决问题。那么，问题的协调就只能等出现问题后再进行协调吗?在设计时，由于各专业设计师之间的沟通不到位，往往会出现各种专业之间的碰撞问题，例如，在对暖通(供热、供燃气、通风及空调工程)等专业中的管道进行布置时，可能遇到构件阻碍管线的布置。这种问题是施工中常遇到的碰撞问题，而BIM的协调性服务，可以帮助处理这种问题，也就是说BIM建筑信息模型可在建筑物建造前期，对各专业的碰撞问题进行协调，生成并提供出协调数据。当然，BIM的协调作用也不止应用于解决各专业间的碰撞问题，它还可以解决电梯井布置与其他设计布置及净空要求的协调、防火分区与其他设计布置的协调以及地下排水布置与其他设计布置的协调等问题。</p>
<p><strong>(三) 模拟性</strong></p>
<p>BIM的模拟性并不是只能模拟、设计出建筑物的模型，还可以模拟难以在真实世界中进行操作的事件。在设计阶段，BIM可以对设计上需要进行模拟的一些事件进行模拟实验，例如，节能模拟、紧急疏散模拟、日照模拟和热能传导模拟等。在招投标和施工阶段可以进行4D模拟(3D模型加项目的发展时间)，也就是根据施工的组织设计模拟实际施工，从而确定合理的施工方案。同时还可以进行5D模拟(基于3D模型的造价控制)，从而实现成本控制。在后期运营阶段，还可以进行日常紧急情况处理方式的模拟，如地震人员逃生模拟和消防人员疏散模拟等。</p>
<p><img src="http://cdn-ali.aecichina.com/qiniu/ueditor%2F15135874447.png" alt="BIM图文全解！十分钟了解BIM"></p>
<p><strong>(四) 优化性</strong></p>
<p>事实上，整个设计、施工和运营的过程就是一个不断优化的过程，在BIM的基础上，可以更好地进行优化。优化通常受信息、复杂程度和时间的制约。准确的信息影响优化的最终结果，BIM模型提供了建筑物的实际存在的信息，包括几何信息、物理信息以及规则信息。对于高度复杂的项目，由于参与人员本身的原因，往往无法掌握所有的信息，因此需要借助一定的科学技术和设备的帮助。现代建筑物的复杂程度大多超过参与人员本身的能力极限，BIM及与其配套的各种优化工具提供了对复杂项目进行优化的服务。</p>
<p>基于BIM的优化，可以完成以下两种任务：</p>
<p>第1种：对项目方案的优化。把项目设计和投资回报分析结合起来，可以实时计算出设计变化对投资回报的影响。这样业主对设计方案的选择就不会停留在对形状的评价上，而是哪种项目设计方案更有利于自身的需求。</p>
<p>第2种：对特殊项目的设计优化。在大空间随处可看到异型设计，如裙楼、幕墙和屋顶等。这些内容看似占整个建筑的比例不大，但是占投资和工作量的比例却往往很大，而且通常是施工难度较大和施工问题较多的地方，对这些内容的设计施工方案进行优化，可以显著地改善工期和造价。</p>
<p><img src="http://cdn-ali.aecichina.com/qiniu/ueditor%2F15135874449.png" alt="BIM图文全解！十分钟了解BIM"></p>
<p><strong>(五) 可出图性</strong></p>
<p>使用BIM绘制的图纸，不同于建筑设计院所设计的图纸或者一些构件加工的图纸，而是通过对建筑物进行可视化展示、协调、模拟和优化以后，绘制出的综合管线图（经过碰撞检查和设计修改，消除了相应错误）、综合结构留洞图（预埋套管图）以及碰撞检查侦错报告和建议改进方案。</p>
<p>BIM与工程造价的交流</p>
<p><strong>（一）BIM对造价的影响</strong></p>
<p>BIM对于造价来说很有可能会改变造价的整个工作流程，包括造价员的整个工作思维模式，传统的造价工作模式是：识图→算量（目前是软件提量+手工算量）→套项→调整材料价、调整取费，完成造价。这样一个过程有很多重复的工作，并且很多环节是需要大量的人工劳动力来解决造价中遇到的复杂问题，在可研、设计、招标、施工阶段需要重复计算不同阶段的造价。这样的工作模式势必会增加很多额外的成本，尤其后期设计中的变更修改阶段，每一次修改都需要重新核对一下图纸的改变程度，在传统的单机单专业的工作方式，很多设计修改不会被造价人员做发现，这样的造价计算肯定会和实际的清单会有很多误差。而基于BIM下的造价可以在不同阶段计算不同阶段的造价清单，只要模型建立的足够精细就可以得到十分精准的造价信息。</p>
<p>工程造价分为三个部分，算量问题，组价问题和合同问题。现阶段来看，BIM技术的普及对工程造价的冲击主要局限于算量问题上。BIM作为应用软件，更加简化了工程量的计算，使造价师从算量的繁琐工作中脱离出来，大量减少了计算工作，将更多的目光放在组价和合同问题上。</p>
<p>另外BIM技术使各阶段数据无缝对接，实现全过程、全要素可靠、准确地工程造价管理。这在一定程度上打破了之前由于各阶段数据不连续，各环节之间协同共享存在障碍，导致工程信息不透明，致使工程项目”水深“现象。</p>
<p><strong>(二) BIM是否会取代造价</strong></p>
<p>前面提到，BIM的普及，会让造价师的目光更多的集中在组价和合同问题上。对于价格，合同，建设工程前后的费用控制，相关法律和规章是以工程经验积累起来的。技术软件再万能，在没有标准可循的组价、合同法律法规的理解等方面也不能和人脑比拼。当工程量不需要计算的时候，造价师会更有精力去做成本控制等一些控制造价的核心内容。所以BIM只能技术给造价师提供更宽、更高的职业空间。</p>
<p>在国外，工料测量师被业主称为“费用经理”。他们的业务不止于单一环节的“计价”、“造价”，更在于全过程“控价”。从工程量预测，到投标招标决策；从工程可行性判断，到工程成本管理，工料测量师都可以从经济角度予以解决方案。反观国内造价师，“造价”二字当顶，已经明示其本职。目前国内造价师的工作也确实以算量、套价为主，很少实现全过程成本管控。</p>
<p><img src="http://cdn-ali.aecichina.com/qiniu/ueditor%2F15135874442.png" alt="BIM图文全解！十分钟了解BIM"></p>
<p>所以未来造价工程师的咨询业务很可能会改变，不再是单一的造价内容，而是关注于工程项目全过程的成本管控咨询。但是BIM业务也不会完全取代造价业务，原因如下：</p>
<p>BIM即便发展到人工智能的程度，始终不如人懂得其他人的“心理活动”，对敏感性问题完全无能。 建设工程是为人服务的。人有种种立场和差异化感受。用户与用户之间，企业与企业之间，社会与社会之间，甚至这三者之间，追求往往不那么一致。用户体验、造价规范与工程效益的同步协调，涉及种种微妙的利害权衡。国内的工程造价，不仅是经济账，也是心理战。</p>
<p>更实时更适配的BIM算法始终依赖人的输入。BIM计算实质是工程经验的数据化，但实际的工程实践不是BIM模型所能实现的。所以工程经验数据化的进度和精度取决于人对工程的理解。</p>
<p><strong>(三)BIM如何运用于造价工作</strong></p>
<p>以BIM模型为基础按照BIM建筑模型的各个构件自动挂接上对应的清单和定额，这样就可以实时的计算出造价清单，如果模型有变更修改也可以在造价中有所体现，真的达到一处修改实时计量的工作模式。这样不但提高了算量的工作效率而且还提高了清单精确度，并且在BIM模型中我们可以批量修改、多工程链接、可视化操作等一系列手段来灵活的完成我们的工作任务，BIM以全新的协同工作方式代替传统的单机工作模式。</p>
<p>但是从行业的角度来看，我们造价工作者不应该局限本专业的范围，我们在头脑应该有一个BIM宏观的概念，首先了解BIM在整个建筑生命周期都能做什么，其次是掌握造价行业的新软件新技术，头脑中一定要时刻建立一个模型化、协同化的思维模式。</p>
<p>BIM作为工具，它的存在是简便造价师的工作量。也纠正了一直以来造价师应该把握的方向：造价师不是算量员，他们的存在是为了更好的进行工程成本控制。BIM本身并不能成为解决方案，也不能发挥作用，真正的解决方案是行业从业人员充分挖掘和利用BIM价值更好、更快完成工程任务。BIM简化了造价师的重复算量工作，为造价师的发展提供了更宽、更高的空间！</p>
<p><img src="http://p3.pstatp.com/large/434a00039461d870c412" alt="BIM图文全解！十分钟了解BIM"></p>
<p><strong>(四)造价过程中BIM应用难点</strong></p>
<p>组织层面</p>
<p>首先从企业战略上来讲，企业的规模和性质不同会导致应用 BIM 的目标有所差异，比如万达集团等大型企业采取整套开发散售模式、融合开发和经营的方式，此种背景下以全生命周期制定企业 BIM 应用目标。企业不同的定位导致 BIM 技术应用目标上有所不同，进而对企业信息需求、期望功能等产生影响，所以，企业应当充分考虑自身的定位和性质，然后制定企业发展战略。</p>
<p>其次，从制度上来讲，企业制定制度是为了约束员工行为，从而保证工作的顺利开展。应用 BIM 技术时会增加企业的资金压力，一方面传统工作方式和新型 BIM 管理模式的交替会短期增加企业成本；另一方面，新技术利用率低致使新旧工作方式重叠造成资源重复消耗，增加企业资金负担。此外，BIM 技术对技术人员有着较高的要求，企业需要在人员上投入更多的资金。</p>
<p>此外，从项目管理角度看，BIM 技术在全生命周期中不同阶段需要建立相应的方法，当前在国内企业项目管理中各个阶段和专业之间并没有做好良好的沟通，所以信息缺乏，难以实现统筹管理，导致 BIM 技术应用出现障碍。</p>
<p>技术方法</p>
<p>\1. 工作流程的制约。企业造价管理包括设计阶段、施工阶段、工程变更等诸多方面因素的内容，在不同的阶段造价管理侧重点也不同，比如策划期需要做好估算，设计图纸期需要做好预算工作等。目前很多企业都需要依靠设计单位设计出相关的 BIM 模型来实现企业造价的管理，但是在造价管理工作流程中有很多有待完善之处。我国要求造价结果由造价人员完全负责，而造价人员需要在 BIM 早期设计中和设计人员共同完成构件信息的定义，但是目前我国很多企业没有做到这一点。在 BIM 技术应用中，需要根据设计阶段模型创建施工图预算，进而得到投标清单，在这项工作中需要投入大量的时间和经历，导致很多企业对此技术的应用望而却步。</p>
<p>\2. 造价软件和 BIM 软件信息不对称。不同类型的企业对构件信息有着不同的要求，导致 BIM 软件模型设计和应用具有一定的不同之处。目前 BIM 软件中缺乏对施工工艺、部件、清单计算规范要求的考虑，没有有效将材料、工艺做出分类，最终导致 BIM 在应用中出现不同程度的问题，所以，为了实现 BIM 技术在造价管理中的应用，应当充分考虑其中的差异。</p>
<p>\3. 知识产权问题。BIM 技术的应用还会涉及到知识产权问题，设计人员需要在 BIM 技术设计中对模型进行搭建和确认。创建完的 BIM 模型含有丰富的信息资源，但是如何合理有效地使用成为了一项难以把握的工作。BIM 模型在使用中有的操作、变更等工作都需要专门的人员完成，导致项目各阶段 BIM 难以形成链条，阻碍了该技术的推广和应用。</p>
<p><img src="http://cdn-ali.aecichina.com/qiniu/ueditor%2F15135874444.png" alt="BIM图文全解！十分钟了解BIM"></p>
<p>经济方面</p>
<p>从经济方面来讲，BIM 技术的应用出现障碍主要可以体现在三个方面，第一，政府缺乏相应的机理政策，企业财政收支上存在问题。虽然国家认可并推广该技术的应用，但是目前政府并没有发布关于 BIM 技术应用的相关标准要求，也就是说法律法规有所欠缺。第二，企业的经济压力，上文已经提到过企业在应用 BIM 技术是需要承担的经济压力，这是阻碍 BIM 技术应用的一大原因。第三，BIM 应用结果受到内部技术人员激励政策的影响。管理者确定了决策后需要技术人员实现，中国社会在事物认知、处理等方面和 BIM 精细化和数据化管理的理念存在较大的差异，所以需要考虑激励政策的合理应用。</p>
<p>BIM模型的构架</p>
<p>BIM模型（Building Information Model）是设施所有信息的数字化表达，是一个可以作为设施虚拟替代物的信息化电子模型，是共享信息的资源，也是Building Information Modeling和Building Information Management的基础。</p>
<p>人们常以为BIM模型是一个单一的模型，但到了实际操作层面，由于项目所处的阶段不同、专业分工不同、实现目标不同等多种原因，项目的不同参与方还必须拥有各自的模型，例如场地模型、建筑模型、结构模型、设备模型、施工模型、竣工模型等。这些模型是从属于项目总体模型的子模型，但规模比项目的总体模型要小。</p>
<p><img src="http://p3.pstatp.com/large/434a00039463449e9d91" alt="BIM图文全解！十分钟了解BIM"></p>
<p>所有的子模型都是在同一个基础模型上生成的，这个基础模型包括了建筑物最基本的构架：场地的地理坐标与范围、柱、梁、楼板、墙体、楼层、建筑空间等，而专业的子模型就是在基础模型的上面添加各自的专业构件形成的，这里专业子模型与基础模型的关系就相当一个引用与被引用的关系，基础模型的所有信息被各个子模型共享。</p>
<p>BIM生态系统</p>
<p>BIM应用是与计算机和网络系统密切相关的，如何从软硬件的角度搭建起BIM应用系统的框架是BIM应用的必要条件，但是无论从纵向的全生命周期来说，还是横向的各行各业的项目参与方来说，BIM应用的广泛性都给BIM系统应用框架的搭建提出了很高的要求，必须保证在设施全生命周期中的BIM应用充分实现信息交换。目前建筑业的信息表达与交换的国际标准技术是IFC标准，如何在系统中直接传递、交换IFC数据，那就需要设置一个BIM服务器，BIM服务器与BIM知识库一起组成一个以IFC格式为网络的数据集成与应用平台。</p>
<p><img src="http://cdn-ali.aecichina.com/qiniu/ueditor%2F15135874457.png" alt="BIM图文全解！十分钟了解BIM"></p>
<p>用户进行相关应用时可通过BIM服务器提取所需的信息，同时也可以对模型中的信息进行扩展，然后将扩展的模型信息重新提交给服务器，这样就实现了BIM数据的存储、管理、交换和应用。再进一步，如果BIM服务器实现以集成BIM为基础，就可以实现对象级别的数据管理以及权限配置，能支持多用户协作和同步修改。</p>
<p>BIM全周期实施规划</p>
<p>采用BIM技术，不仅可以实现设计阶段的协同设计，施工阶段的建造全过程一体化和运营阶段对建筑物的智能化维护和设施管理，同时还能打破从业主到设计、施工运营之间的隔阂和界限，实现对建筑的全寿命周期管理。</p>
<p>在2010年美国宾夕法尼亚州立大学的计算机集成化施工研究组经研究写成的《BIM项目实施计划指南》第二版中，发表了【BIM技术的25种常见的应用图】，如下：</p>
<p><img src="http://cdn-ali.aecichina.com/qiniu/ueditor%2F151358744510.png" alt="BIM图文全解！十分钟了解BIM"></p>
<p>这25种应用跨越了设施全生命周期的四个阶段，即规划阶段（项目前期策划阶段）、设计阶段、施工阶段、运营阶段。我国通过借鉴上述对BIM应用的分类框架，结合目前国内事实现状，归纳得出【项目四阶段中的20种BIM典型应用】，如下：</p>
<p><img src="http://cdn-ali.aecichina.com/qiniu/ueditor%2F15135874450.png" alt="BIM图文全解！十分钟了解BIM"></p>
<p>建筑业的工序在国内外实质上大同小异，BIM的应用也是如此，但有些应用二者的划分尺度不一样，如前者的“3D协调”与后者的“管线综合”类似，但后者的描述过于狭窄，好像仅限于管线的碰撞分析，而结构梁柱引起的净空高度不够等其他构建协调优化问题就不管了，所以前者的描述较为全面。</p>
<p>以下就项目前期策划阶段、设计阶段、施工阶段和运营阶段中BIM的应用进行一个概括性介绍：</p>
<p><strong>(一) 项目前期策划阶段</strong></p>
<p>项目前期策划阶段对整个建筑工程项目的影响很大，美国HOK建筑师事务所麦克利米曾提出著名的麦克利米曲线图：</p>
<p><img src="http://cdn-ali.aecichina.com/qiniu/ueditor%2F15135874459.png" alt="BIM图文全解！十分钟了解BIM"></p>
<p>图表表明在项目前期的优化对于项目的成本和功能影响是最大的，而优化设计的费用是最低的；而在项目后期优化对于成本和功能影响在逐渐变小，而优化设计的费用却逐步增高。出于上述原因，在项目的前期应当尽早应用BIM技术。</p>
<p>BIM技术应用在项目前期的工作有很多，包括现状建模与模型维护、场地分析、成本估算、阶段规划、规划编制、建筑策划等。</p>
<p>投资估算</p>
<p>应用BIM系统强大的信息统计功能，在方案阶段可运用数据指标等方法获得较为准确的土建工程量及土建造价，同时可用于不同方案的对比，可以快速得出成本的变动情况，权衡出不同方案的造价优劣，为项目决策提供重要而准确的依据。BIM技术可运用计算机强大的数据处理能力进行投资估算，这大大减轻了造价工程师的计算工作量，造价工程师可节省时间从事更有价值的工作如确定施工方案、评估风险等，进一步能细致考虑施工中许多节约成本等专业问题，这些对于编制高质量的预算来说非常重要。</p>
<p>现状模型</p>
<p>根据现有的资料把现状图纸导入到基于BIM技术的软件中，创建出道路、建筑物、河流、绿化以及高程的变化起伏，并根据规划条件创建出本地块的用地红线及道路红线，并生成面积指标。</p>
<p>总图规划</p>
<p>在现状模型的基础上根据容积率、绿化率、建筑密度等建筑控制条件创建工程的建筑体块各种方案，创建体量模型。做好总图规划、道路交通规划、绿地景观规划、竖向规划以及管线综合规划。</p>
<p>环境评估</p>
<p>根据项目的经纬度，借助相关的软件采集此地的太阳及气候数据，并基于BIM模型数据利用相关的分析软件进行气候分析，对方案进行环境影响评估，包括日照环境影响、风环境影响、热环境影响、声环境影响等评估。某些项目还需要进行交通影响模拟。</p>
<p><strong>(二) 设计阶段</strong></p>
<p>BIM在建筑设计的应用范围非常广泛，无论在设计方案论证，还是在设计创作、协同设计、建筑性能分析、结构分析，以及在绿色建筑评估、规范验证、工程量统计等许多方面都有广泛的应用。</p>
<p>设计方案论证</p>
<p>BIM三维模型展示的设计效果十分方便评审人员、业主对方案进行评估，甚至可以就当前设计方案讨论施工可行性以及如何削减成本、缩短工期等问题，可最修改方案提供切实可行的方案。由于是用可视化方式进行，可获得来自最终用户和业主的积极反馈，使决策的时间大大减少，促成共识。</p>
<p>设计创作</p>
<p>由于在BIM软件中组成整个设计的就是门、窗、墙体等单个3D构件元素，则设计过程就是不断确定和修改各种构件的参数，而这些建筑构件在软件中是数据关联、智能互动的。而最终设计成果的交付就是BIM模型，所有平、立、剖二维图纸都可以根据模型随意生成，由于图纸来源都是同一个BIM模型，所以所有图纸和图表数据都是互相关联的，也是实时互动的，从根本上避免了不同视图不同专业图纸出现的不一致现象。</p>
<p>协同设计</p>
<p>BIM技术使不同专业的甚至是身处异地的设计人员都能够通过网络在同一个BIM 模型上展开协同设计，使设计能够协调进行。以往各专业各视角之间不协调的事情时有发生，即使花费了大量人力物力对图纸进行审查仍然不能把不协调的问题全部改正。有些问题到了施工过程才能发现，给材料、成本、工期造成了很大的损失。应用BIM技术以及BIM服务器，通过协同设计和可视化分析就可以及时解决上述设计中的不协调问题，保证了后期施工的顺利进行。</p>
<p>绿色建筑评估</p>
<p>BIM模型中包含了用于建筑性能分析的各种数据，只要数据完备，将数据通过IFC、gbXML等交换格式输入到相关的分析软件中，即可进行当前项目的节能分析、采光分析、日照分析、通风分析以及最终的绿色建筑评估。</p>
<p>工程量统计</p>
<p>BIM模型信息的完备性大大简化了设计阶段对工程量的统计工作，模型的每个构件都和BIM数据库的成本库相关联，当设计师在对构件进行变更时，成本估算都会实时更新。</p>
<p>在用二维CAD技术进行设计时，绘图的工作量很大，设计师无法花很多时间对设计方案进行静心推敲。应用BIM技术，只要完成了设计构想，确定了BIM模型的最后构成，马上就可以根据模型生成各种施工图，而且由于BIM技术的协调性，后期调整设计的工作量是很小的，这样设计质量和图纸质量都得到了保障。</p>
<p><strong>(三) 施工阶段</strong></p>
<p>BIM技术在施工阶段可以有如下多个方面的应用：3D协调/管线综合、支持深化设计、场地使用规划、施工系统设计、施工进度模拟、施工组织模拟、数字化建造、施工质量与进度监控、物料跟踪等。</p>
<p>碰撞综合协调</p>
<p>在施工开始前利用BIM模型的可视化特性对各个专业（建筑、结构、给排水、机电、消防、电梯等）的设计进行空间协调，检查各个专业管道之间的碰撞以及管道与结构的碰撞。如发现碰撞及时调整，这样就较好地避免施工中管道发生碰撞和拆除重新安装的问题。</p>
<p>施工方案分析</p>
<p>在BIM模型上对施工计划和施工方案进行分析模拟，充分利用空间和资源整合，消除冲突，得到最优施工计划和方案。特别是对于新形式、新结构、新工艺和复杂节点，可以充分利用BIM的参数化和可视化特性对节点进行施工流程、结构拆解、配套工器具等角度的分析模拟，可以改进施工方案实现可施工性，以达到降低成本、缩短工期、减少错误和浪费的目的。</p>
<p>数字化建造</p>
<p>数字化建造的前提是详尽的数字化信息，而BIM模型的构件信息都以数字化形式存储。例如像数控机床这些用数字化建造的设备需要的就是描述构件的数字化信息，这些数字化信息为数控机床提供了构件精确的定位信息，为建造提供了必要条件。</p>
<p>施工科学管理</p>
<p>通过BIM技术与3D激光扫描、视频、图片、GPS、移动通讯、RFID（二维码等射频识别技术）、互联网等技术的集成，可以实现对现场的构件、设备以及施工进度和质量的实时跟踪。另外通过BIM技术和管理信息系统的集成，可以有效支持造价、采购、库存、财务等的动态精确管理，减少库存开支，在竣工时可以生成项目竣工模型和相关文件，有利于后续的运营管理。并且业主、设计方、预制厂商、材料供应商等可利用BIM模型的信息集成化与施工方进行沟通，提高效率减少错误。</p>
<p>总的来说，应用BIM技术可以为建筑施工带来新的面貌。</p>
<p><strong>(四) 运营阶段</strong></p>
<p>在运营维护阶段BIM可以有如下这些方面的应用：竣工模型交付；维护计划；建筑系统分析；资产管理；空间管理与分析；防灾计划与灾害应急模拟。</p>
<p>竣工模型交付与维护计划：施工方竣工后对BIM模型进行必要的测试和调整再向业主提交，这样运营维护管理方得到的不只是设计和竣工图纸，还能得到反映真实状况的BIM模型，里面包含了施工过程记录、材料使用情况、设备的调试记录以及状态等资料。BIM能将建筑物空间信息、设备信息和其他信息有机地整合起来，结合运营维护管理系统可以充分发挥空间定位和数据记录的优势，合理制定运营、管理、维护计划，尽可能降低运营过程中的突发事件。</p>
<p>资产管理</p>
<p>通过BIM建立维护工作的历史纪录，可以对设施和设备的状态进行跟踪，对一些重要设备的适用状态提前预判，并自动根据维护记录和保养计划提示到期需保养的设备和设施，对故障的设备从派工维修到完工验收、回访等均进行记录，实现过程化管理。另外如果基于BIM的资产管理系统能和诸如停车场管理系统、智能监控系统、安全防护系统等物联网结合起来，实行集中后台控制与管理，则能很好地解决资产的实时监控、实时查询和实时定位，并且实现各个系统之间地互联、互通和信息共享。</p>
<p>防灾模拟</p>
<p>基于BIM模型丰富的信息，可以将模型以IFC等交换格式导入灾害模拟分析软件，分析灾害发生的原因，制定防灾措施与应急预案。灾害发生后，将BIM模型以可视化方式提供给救援人员，让救援人员迅速找到合适救灾路线，提高救灾成效。</p>
<p>空间管理</p>
<p>应用BIM技术可以处理各种空间变更的请求，合理安排各种应用的需求，并记录空间的使用、出租、退租的情况，实现空间的全过程管理。</p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2021-09-27T02:21:45.000Z">2021-09-27</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    1 小时 读完 (大约 10578 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2021/09/27/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%9F%A5%E8%AF%86%E4%BD%93%E7%B3%BB/">微服务知识体系</a>
            
        </h1>
        <div class="content">
            <h1 id="SpringCloud资料"><a href="#SpringCloud资料" class="headerlink" title="SpringCloud资料"></a>SpringCloud资料</h1><h1 id="微服务资料"><a href="#微服务资料" class="headerlink" title="微服务资料"></a>微服务资料</h1><h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><p>目录…………………………………………………………………………………………………………………….. 2</p>
<p>1   SpringCloud简介………………………………………………………………………………………………. 1</p>
<p>1.1 什么是微服务…………………………………………………………………………………………………… 1</p>
<p>1.2 CAP定理…………………………………………………………………………………………………………… 1</p>
<p>1.3 微服务架构图…………………………………………………………………………………………………… 2</p>
<p>1.4 SpringCloud Netflix………………………………………………………………………………………………. 7</p>
<p>1.5 Spring Cloud Alibaba…………………………………………………………………………………………… 10</p>
<p>1.6 微服务之间的通讯…………………………………………………………………………………………… 10</p>
<p>1.7 主流微服务注册中心浅析和对比………………………………………………………………………… 10</p>
<p>1.8 单体优先还是微服务？…………………………………………………………………………………….. 11</p>
<p>2   微服务框架……………………………………………………………………………………………………. 11</p>
<p>2.1 参考微服务文件结构………………………………………………………………………………………… 11</p>
<p>2.2 服务划分……………………………………………………………………………………………………….. 16</p>
<h1 id><a href="#" class="headerlink" title></a></h1><p>**<br>**</p>
<h1 id="1-SpringCloud简介"><a href="#1-SpringCloud简介" class="headerlink" title="1  SpringCloud简介"></a>1  SpringCloud简介</h1><h2 id="1-1-什么是微服务"><a href="#1-1-什么是微服务" class="headerlink" title="1.1 什么是微服务"></a>1.1 什么是微服务</h2><p>微服务架构是一个分布式系统，按照业务进行划分成为不同的服务单元，解决单体系统性能等不足。</p>
<p>微服务是一种架构风格，一个大型软件应用由多个服务单元组成。系统中的服务单元可以单独部署，各个服务单元之间是松耦合的。</p>
<h2 id="1-2-CAP定理"><a href="#1-2-CAP定理" class="headerlink" title="1.2 CAP定理"></a>1.2 CAP定理</h2><p>CAP定理，指的是在一个分布式系统中， Consistency（一致性）、 Availability（可用性）、Partition tolerance（分区容错性），三者不可得兼。</p>
<p><strong>一致性（C**</strong>）：**在分布式系统中的所有数据备份，在同一时刻是否同样的值。（等同于所有节点访问同一份最新的数据副本）</p>
<p><strong>可用性（A**</strong>）：**在集群中一部分节点故障后，集群整体是否还能响应客户端的读写请求。（对数据更新具备高可用性）</p>
<p><strong>分区容忍性（P**</strong>）：**以实际效果而言，分区相当于对通信的时限要求。系统如果不能在时限内达成数据一致性，就意味着发生了分区的情况，必须就当前操作在C和A之间做出选择。</p>
<p>CAP原则的精髓就是要么AP，要么CP，要么AC，但是不存在CAP。如果在某个分布式系统中数据无副本， 那么系统必然满足强一致性条件， 因为只有独一数据，不会出现数据不一致的情况，此时C和P两要素具备，但是如果系统发生了网络分区状况或者宕机，必然导致某些数据不可以访问，此时可用性条件就不能被满足，即在此情况下获得了CP系统，但是CAP不可同时满足。因此在进行分布式架构设计时，必须做出取舍。</p>
<p><strong>Zookeeper**</strong>和Consul<strong><strong>保证的是CP</strong></strong>，而Eureka<strong><strong>则是AP</strong></strong>，Nacos<strong><strong>不仅支持CP</strong></strong>也支持AP<strong>**。</strong></p>
<h2 id="1-3-微服务架构图"><a href="#1-3-微服务架构图" class="headerlink" title="1.3 微服务架构图"></a>1.3 微服务架构图</h2><h3 id="1-3-1-Eurake微服务架构图1"><a href="#1-3-1-Eurake微服务架构图1" class="headerlink" title="1.3.1 Eurake微服务架构图1"></a>1.3.1 Eurake微服务架构图1</h3><p><img src="file:////Users/luxiqiang/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image001.jpg" alt="preview"></p>
<h3 id="1-3-2-Eurake微服务架构图2"><a href="#1-3-2-Eurake微服务架构图2" class="headerlink" title="1.3.2 Eurake微服务架构图2"></a>1.3.2 Eurake微服务架构图2</h3><p><a href="https://www.processon.com/view/5b7d2f1fe4b075b9fe22d3d2?fromnew=1" target="_blank" rel="noopener">https://www.processon.com/view/5b7d2f1fe4b075b9fe22d3d2?fromnew=1</a></p>
<p><img src="file:////Users/luxiqiang/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image002.png" alt="img"></p>
<h3 id="1-3-3-Eurake微服务架构图3"><a href="#1-3-3-Eurake微服务架构图3" class="headerlink" title="1.3.3 Eurake微服务架构图3"></a>1.3.3 Eurake微服务架构图3</h3><p><a href="https://www.processon.com/view/5ed36dd5e401fd0735a531cd?fromnew=1" target="_blank" rel="noopener">https://www.processon.com/view/5ed36dd5e401fd0735a531cd?fromnew=1</a></p>
<p><img src="file:////Users/luxiqiang/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image003.png" alt="img"></p>
<h3 id="1-3-4-Alibaba微服务架构图4"><a href="#1-3-4-Alibaba微服务架构图4" class="headerlink" title="1.3.4 Alibaba微服务架构图4"></a>1.3.4 Alibaba微服务架构图4</h3><p><a href="https://www.processon.com/view/5db03daee4b0e433944b5a68?fromnew=1" target="_blank" rel="noopener">https://www.processon.com/view/5db03daee4b0e433944b5a68?fromnew=1</a></p>
<p><img src="file:////Users/luxiqiang/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image004.png" alt="img"></p>
<h3 id="1-3-5-Alibaba微服务架构图5"><a href="#1-3-5-Alibaba微服务架构图5" class="headerlink" title="1.3.5 Alibaba微服务架构图5"></a>1.3.5 Alibaba微服务架构图5</h3><p><a href="https://www.processon.com/view/60c18dcbe401fd34a14ea35a?fromnew=1" target="_blank" rel="noopener">https://www.processon.com/view/60c18dcbe401fd34a14ea35a?fromnew=1</a></p>
<p><img src="file:////Users/luxiqiang/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image005.png" alt="img"></p>
<h3 id="1-3-6-Alibaba微服务架构图6"><a href="#1-3-6-Alibaba微服务架构图6" class="headerlink" title="1.3.6 Alibaba微服务架构图6"></a>1.3.6 Alibaba微服务架构图6</h3><p><a href="https://www.processon.com/view/5dc2c0ffe4b0e433945eefe9?fromnew=1" target="_blank" rel="noopener">https://www.processon.com/view/5dc2c0ffe4b0e433945eefe9?fromnew=1</a></p>
<p><img src="file:////Users/luxiqiang/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image006.png" alt="img"></p>
<p><a href="https://www.processon.com/view/60e503da0e3e745f07eb05aa?fromnew=1" target="_blank" rel="noopener">https://www.processon.com/view/60e503da0e3e745f07eb05aa?fromnew=1</a></p>
<p><img src="file:////Users/luxiqiang/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image007.png" alt="img"></p>
<p><a href="https://www.processon.com/view/5fbc7ad8e401fd2d6ed50d8f?fromnew=1" target="_blank" rel="noopener">https://www.processon.com/view/5fbc7ad8e401fd2d6ed50d8f?fromnew=1</a></p>
<p><img src="file:////Users/luxiqiang/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image008.png" alt="img"></p>
<h2 id="1-4-SpringCloud-Netflix"><a href="#1-4-SpringCloud-Netflix" class="headerlink" title="1.4 SpringCloud Netflix"></a>1.4 SpringCloud Netflix</h2><p>微服务架构的逻辑结构组成，包括各种微服务、注册发现、服务网关、熔断器、统一配置、跟踪服务等。</p>
<h3 id="1-4-1-Feign"><a href="#1-4-1-Feign" class="headerlink" title="1.4.1 Feign"></a>1.4.1 Feign</h3><p>Feign(接口调用)：微服务之间通过Rest接口通讯，Spring Cloud提供Feign框架来支持Rest的调用，Feign使得不同进程的Rest接口调用得以用优雅的方式进行，这种优雅表现得就像同一个进程调用一样。</p>
<h3 id="1-4-2-Eureka"><a href="#1-4-2-Eureka" class="headerlink" title="1.4.2 Eureka"></a>1.4.2 Eureka</h3><p>Netflix eureka(注册发现)：微服务模式下，一个大的Web应用通常都被拆分为很多比较小的web应用(服务)，这个时候就需要有一个地方保存这些服务的相关信息，才能让各个小的应用彼此知道对方，这时就需要在注册中心进行注册。</p>
<p>每个应用启动时向配置的注册中心注册自己的信息（ip地址，端口号, 服务名称等信息），注册中心将他们保存起来，服务间相互调用的时候，通过服务名称就可以到注册中心找到对应的服务信息，从而进行通讯。</p>
<p>注册与发现服务为微服务之间的调用带来了方便，解决了硬编码的问题。服务间只通过对方的服务id，而无需知道其ip和端口即可以获取对方方服务。</p>
<h3 id="1-4-3-Ribbon"><a href="#1-4-3-Ribbon" class="headerlink" title="1.4.3 Ribbon"></a>1.4.3 Ribbon</h3><p>Ribbon(负载均衡)：Ribbon是Netflix发布的负载均衡器，它有助于控制HTTP和TCP客户端的行为。为Ribbon配置服务提供者的地址列表后，Ribbon就可基于某种负载均衡算法，自动地帮助服务消费者去请求。</p>
<p>Ribbon默认为我们提供了很多的负载均衡算法，例如轮询、随机等。当然，我们也可为Ribbon实现自定义的负载均衡算法。</p>
<p>在SpringCloud中，当Ribbon与Eureka配合使用时，Ribbon可自动从EurekaServer获取服务提供者的地址列表，并基于负载均衡算法，请求其中一个服务提供者的实例</p>
<p>（为了服务的可靠性，一个微服务可能部署多个实例）</p>
<h3 id="1-4-4-Hystrix"><a href="#1-4-4-Hystrix" class="headerlink" title="1.4.4 Hystrix"></a>1.4.4 Hystrix</h3><p><strong>Hystrix(**</strong>熔断器)<strong>**：</strong>当服务提供者响应非常缓慢，那么消费者对提供者的请求就会被强制等待，直到提供者响应或超时。</p>
<p>在高负载场景下，如果不做任何处理，此类问题可能会导致服务消费者的资源耗竭甚至整个系统的崩溃（雪崩效应），Hystrix正是为了防止此类问题发生。</p>
<p>Hystrix是由Netflix开源的一个延迟和容错库，用于隔离访问远程系统、服务或者第三方库，防止级联失败，从而提升系统的可用性与容错性。</p>
<p><strong>Hystrix**</strong>主要通过以下几点实现延迟和容错：**</p>
<p><strong>包裹请求：</strong>使用HystrixCommand（或HystrixObservableCommand）包裹对依赖的调用逻辑，每个命令在独立线程中执行。这使用了设计模式中的“命令模式”。</p>
<p><strong>跳闸机制：</strong>当某服务的错误率超过一定阈值时，Hystrix可以自动或者手动跳闸，停止请求该服务一段时间。</p>
<p><strong>资源隔离：</strong>Hystrix为每个依赖都维护了一个小型的线程池（或者信号量）。如果该线程池已满，发往该依赖的请求就被立即拒绝，而不是排队等候，从而加速失败判定。</p>
<p><strong>监控：</strong>Hystrix可以近乎实时地监控运行指标和配置的变化，例如成功、失败、超时和被拒绝的请求等。</p>
<p><strong>回退机制：</strong>当请求失败、超时、被拒绝，或当断路器打开时，执行回退逻辑。回退逻辑可由开发人员指定。</p>
<h3 id="1-4-5-Zuul"><a href="#1-4-5-Zuul" class="headerlink" title="1.4.5 Zuul"></a>1.4.5 Zuul</h3><p>Zuul(微服务网关) ：不同的微服务一般会有不同的网络地址，而外部客户端可能需要调用多个服务的接口才能完成一个业务需求。</p>
<p>例如一个电影购票的手机APP，可能调用多个微服务的接口才能完成一次购票的业务流程</p>
<p>如果让客户端直接与各个微服务通信，会有以下的问题：</p>
<p>1、客户端会多次请求不同的微服务，增加了客户端的复杂性。</p>
<p>2、存在跨域请求，在一定场景下处理相对复杂。</p>
<p>3、认证复杂，每个服务都需要独立认证。</p>
<p>4、难以重构，随着项目的迭代，可能需要重新划分微服务。</p>
<p>例如，可能将多个服务合并成一个或者将一个服务拆分成多个。如果客户端直接与微服务通信，那么重构将很难实施。</p>
<p>某些微服务可能使用了对防火墙/浏览器不友好的协议，直接访问时会有一定的困难。</p>
<p>以上问题可借助微服务网关解决。微服务网关是介于客户端和服务器端之间的中间层，所有的外部请求都会先经过微服务网关。</p>
<p>使用微服务网关后，微服务网关将封装应用程序的内部结构，客户端只用跟网关交互，而无须直接调用特定微服务的接口。</p>
<p>这样，开发就可以得到简化。不仅如此，使用微服务网关还有以下优点：</p>
<p>易于监控。可在微服务网关收集监控数据并将其推送到外部系统进行分析。</p>
<p>易于认证。可在微服务网关上进行认证，然后再将请求转发到后端的微服务，而无须在每个微服务中进行认证。</p>
<p>减少了客户端与各个微服务之间的交互次数。</p>
<h3 id="1-4-6-Config"><a href="#1-4-6-Config" class="headerlink" title="1.4.6 Config"></a>1.4.6 Config</h3><p>Spring cloud Config（ 统一配置服务）：对于传统的单体应用，常使用配置文件管理所有配置。</p>
<p>例如一个SpringBoot开发的单体应用，可将配置内容放在application.yml文件中。如果需要切换环境，可设置多个Profile，并在启动应用时指定spring.profiles.active={profile}。</p>
<p>然而，在微服务架构中，微服务的配置管理一般有以下需求：</p>
<p>集中管理配置。一个使用微服务架构的应用系统可能会包含成百上千个微服务，因此集中管理配置是非常有必要的。</p>
<p>不同环境，不同配置。例如，数据源配置在不同的环境（开发、测试、预发布、生产等）中是不同的。</p>
<p>运行期间可动态调整。例如，可根据各个微服务的负载情况，动态调整数据源连接池大小或熔断阈值，并且在调整配置时不停止微服务。</p>
<p>配置修改后可自动更新。如配置内容发生变化，微服务能够自动更新配置。</p>
<p>综上所述，对于微服务架构而言，一个通用的配置管理机制是必不可少的，常见做法是使用配置服务器管理配置。</p>
<p>Spring cloud bus利用Git或SVN等管理配置、采用Kafka或者RabbitMQ等消息总线通知所有应用，从而实现配置的自动更新并且刷新所有微服务实例的配置。</p>
<h3 id="1-4-7-Zipkin"><a href="#1-4-7-Zipkin" class="headerlink" title="1.4.7 Zipkin"></a>1.4.7 Zipkin</h3><p>Sleuth+ZipKin(跟踪服务)：Sleuth和Zipkin结合使用可以通过图形化的界面查看微服务请求的延迟情况以及各个微服务的依赖情况。</p>
<p>需要注意的是Spring boot2及以上不在支持Zipkin的自定义，需要到官方网站下载ZipKin相关的jar包。</p>
<h2 id="1-5-Spring-Cloud-Alibaba"><a href="#1-5-Spring-Cloud-Alibaba" class="headerlink" title="1.5 Spring Cloud Alibaba"></a>1.5 Spring Cloud Alibaba</h2><p><strong>Nacos**</strong>：**一个更易于构建云原生应用的动态服务发现、配置管理和服务管理平台。</p>
<p><strong>Sentinel**</strong>：**把流量作为切入点，从流量控制、熔断降级、系统负载保护等多个维度保护服务的稳定性。</p>
<p><strong>RocketMQ**</strong>：**开源的分布式消息系统，基于高可用分布式集群技术，提供低延时的、高可靠的消息发布与订阅服务。</p>
<p><strong>Dubbo**</strong>：**这个就不用多说了，在国内应用非常广泛的一款高性能 Java RPC 框架。</p>
<p><strong>Seata**</strong>：**阿里巴巴开源产品，一个易于使用的高性能微服务分布式事务解决方案。</p>
<p><strong>Arthas**</strong>：**开源的Java动态追踪工具，基于字节码增强技术，功能非常强大。</p>
<h2 id="1-6-微服务之间的通讯"><a href="#1-6-微服务之间的通讯" class="headerlink" title="1.6 微服务之间的通讯"></a>1.6 微服务之间的通讯</h2><h3 id="1-6-1-同步"><a href="#1-6-1-同步" class="headerlink" title="1.6.1 同步"></a>1.6.1 同步</h3><p>REST HTTP 协议、RPC TCP 协议。</p>
<h3 id="1-6-2-异步"><a href="#1-6-2-异步" class="headerlink" title="1.6.2 异步"></a>1.6.2 异步</h3><p>消息中间件，常见的消息中间件有 Kafka、ActiveMQ、RabbitMQ、RocketMQ ，常见的协议有 AMQP、MQTTP、STOMP、XMPP。</p>
<h2 id="1-7-主流微服务注册中心浅析和对比"><a href="#1-7-主流微服务注册中心浅析和对比" class="headerlink" title="1.7 主流微服务注册中心浅析和对比"></a>1.7 主流微服务注册中心浅析和对比</h2><p><a href="https://developer.aliyun.com/article/698930" target="_blank" rel="noopener">https://developer.aliyun.com/article/698930</a></p>
<table>
<thead>
<tr>
<th></th>
<th><strong>Nacos</strong></th>
<th><strong>Eureka</strong></th>
<th><strong>Consul</strong></th>
<th><strong>CoreDNS</strong></th>
<th><strong>Zookeeper</strong></th>
</tr>
</thead>
<tbody><tr>
<td>一致性协议</td>
<td>CP+AP</td>
<td>AP</td>
<td>CP</td>
<td>—</td>
<td>CP</td>
</tr>
<tr>
<td>健康检查</td>
<td>TCP/HTTP/MYSQL/Client Beat</td>
<td>Client Beat</td>
<td>TCP/HTTP/gRPC/Cmd</td>
<td>—</td>
<td>Keep Alive</td>
</tr>
<tr>
<td>负载均衡策略</td>
<td>权重/metadata/Selector</td>
<td>Ribbon</td>
<td>Fabio</td>
<td>RoundRobin</td>
<td>—</td>
</tr>
<tr>
<td>雪崩保护</td>
<td>有</td>
<td>有</td>
<td>无</td>
<td>无</td>
<td>无</td>
</tr>
<tr>
<td>自动注销实例</td>
<td>支持</td>
<td>支持</td>
<td>不支持</td>
<td>不支持</td>
<td>支持</td>
</tr>
<tr>
<td>访问协议</td>
<td>HTTP/DNS</td>
<td>HTTP</td>
<td>HTTP/DNS</td>
<td>DNS</td>
<td>TCP</td>
</tr>
<tr>
<td>监听支持</td>
<td>支持</td>
<td>支持</td>
<td>支持</td>
<td>不支持</td>
<td>支持</td>
</tr>
<tr>
<td>多数据中心</td>
<td>支持</td>
<td>支持</td>
<td>支持</td>
<td>不支持</td>
<td>不支持</td>
</tr>
<tr>
<td>跨注册中心同步</td>
<td>支持</td>
<td>不支持</td>
<td>支持</td>
<td>不支持</td>
<td>不支持</td>
</tr>
<tr>
<td>SpringCloud集成</td>
<td>支持</td>
<td>支持</td>
<td>支持</td>
<td>不支持</td>
<td>不支持</td>
</tr>
<tr>
<td>Dubbo集成</td>
<td>支持</td>
<td>不支持</td>
<td>不支持</td>
<td>不支持</td>
<td>支持</td>
</tr>
<tr>
<td>K8S集成</td>
<td>支持</td>
<td>不支持</td>
<td>支持</td>
<td>支持</td>
<td>不支持</td>
</tr>
</tbody></table>
<h2 id="1-8-单体优先还是微服务？"><a href="#1-8-单体优先还是微服务？" class="headerlink" title="1.8 单体优先还是微服务？"></a>1.8 单体优先还是微服务？</h2><p><a href="https://zhuanlan.zhihu.com/p/52638618" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/52638618</a></p>
<h2 id="1-9-监控服务"><a href="#1-9-监控服务" class="headerlink" title="1.9 监控服务"></a>1.9 监控服务</h2><p><img src="file:////Users/luxiqiang/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image009.png" alt="img"></p>
<h3 id="1-9-1-Nacos"><a href="#1-9-1-Nacos" class="headerlink" title="1.9.1 Nacos"></a>1.9.1 Nacos</h3><p><a href="http://localhost:8001/nacos" target="_blank" rel="noopener">http://localhost:8001/nacos</a></p>
<p><img src="file:////Users/luxiqiang/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image010.png" alt="img"></p>
<h3 id="1-9-2-SkyWalking"><a href="#1-9-2-SkyWalking" class="headerlink" title="1.9.2 SkyWalking"></a>1.9.2 SkyWalking</h3><p>可以从<a href="http://skywalking.apache.org/downloads下载apache-skywalking-apm-$version.tar.gz包。" target="_blank" rel="noopener">http://skywalking.apache.org/downloads下载apache-skywalking-apm-$version.tar.gz包。</a></p>
<p>skywalking提供了一个可视化的监控平台，安装好之后，在浏览器中输入(<a href="http://localhost:8080" target="_blank" rel="noopener">http://localhost:8080</a> (opens new window))就可以访问了。</p>
<p>配置vm参数-idea配置vm参数</p>
<p>-javaagent:D:\20.Vue\apache-skywalking-apm-bin\agent\skywalking-agent.jar</p>
<p>-Dskywalking.agent.service_name=febs-gateway</p>
<p>-Dskywalking.collector.backend_service=localhost:11800</p>
<p><img src="file:////Users/luxiqiang/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image011.png" alt="img"></p>
<h3 id="1-9-3-Knife4j"><a href="#1-9-3-Knife4j" class="headerlink" title="1.9.3 Knife4j"></a>1.9.3 Knife4j</h3><p><a href="https://localhost:8301/doc.html" target="_blank" rel="noopener">https://localhost:8301/doc.html</a></p>
<p><img src="file:////Users/luxiqiang/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image012.png" alt="img"></p>
<h3 id="1-9-4-Spring-Boot-Admin"><a href="#1-9-4-Spring-Boot-Admin" class="headerlink" title="1.9.4 Spring Boot Admin"></a>1.9.4 Spring Boot Admin</h3><p><a href="http://localhost:8401/applications" target="_blank" rel="noopener">http://localhost:8401/applications</a></p>
<p><img src="file:////Users/luxiqiang/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image013.png" alt="img"></p>
<h3 id="1-9-5-TxManager"><a href="#1-9-5-TxManager" class="headerlink" title="1.9.5 TxManager"></a>1.9.5 TxManager</h3><p><a href="http://localhost:8501/admin/index.html#/" target="_blank" rel="noopener">http://localhost:8501/admin/index.html#/</a></p>
<p><img src="file:////Users/luxiqiang/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image014.png" alt="img"></p>
<h2 id="1-10-分布式事务LCN-–-TM-服务端server-TC-客户端-spring-boot-使用）"><a href="#1-10-分布式事务LCN-–-TM-服务端server-TC-客户端-spring-boot-使用）" class="headerlink" title="1.10 分布式事务LCN – TM (服务端server ) + TC ( 客户端-spring-boot 使用）"></a>1.10 分布式事务LCN – TM (服务端server ) + TC ( 客户端-spring-boot 使用）</h2><p>LCN基本实现原理</p>
<p>1.发起方与参与方都与我们的LCN管理器一直保持长连接；</p>
<p>2.发起方在调用接口之前，先向LCN管理器申请一个全局的事务分组id；</p>
<p>3.发起方调用接口的时候在请求头中传递事务分组id；</p>
<p>4.参与方获取到请求头中有事务分组的id的，则当前业务逻辑执行完实现假关闭，不会提交或者回滚当前的事务。</p>
<p>5.发起方调用完接口后，如果出现异常的情况下，在通知给事务协调者回滚事务，这时候事务协调则告诉给参与方回滚当前的事务。</p>
<p><a href="https://blog.csdn.net/qq_41463655/article/details/104996363" target="_blank" rel="noopener">https://blog.csdn.net/qq_41463655/article/details/104996363</a></p>
<p><a href="https://juejin.cn/post/6844904127865208839" target="_blank" rel="noopener">https://juejin.cn/post/6844904127865208839</a></p>
<h2 id="1-11-参考项目资料"><a href="#1-11-参考项目资料" class="headerlink" title="1.11 参考项目资料"></a>1.11 参考项目资料</h2><p><a href="https://gitee.com/log4j/pig" target="_blank" rel="noopener">https://gitee.com/log4j/pig</a></p>
<p><a href="https://gitee.com/matevip/matecloud" target="_blank" rel="noopener">https://gitee.com/matevip/matecloud</a></p>
<p><a href="https://gitee.com/mrbirdd/FEBS-Cloud?_from=gitee_search" target="_blank" rel="noopener">https://gitee.com/mrbirdd/FEBS-Cloud?_from=gitee_search</a></p>
<h1 id="2-微服务框架"><a href="#2-微服务框架" class="headerlink" title="2  微服务框架"></a>2  微服务框架</h1><h2 id="2-1-参考微服务文件结构"><a href="#2-1-参考微服务文件结构" class="headerlink" title="2.1 参考微服务文件结构"></a>2.1 参考微服务文件结构</h2><h3 id="2-1-1-SpringBlade"><a href="#2-1-1-SpringBlade" class="headerlink" title="2.1.1 SpringBlade"></a>2.1.1 SpringBlade</h3><p><img src="file:////Users/luxiqiang/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image015.png" alt="img"></p>
<h3 id="2-1-2-Pig微服务结构"><a href="#2-1-2-Pig微服务结构" class="headerlink" title="2.1.2 Pig微服务结构"></a>2.1.2 Pig微服务结构</h3><p><img src="file:////Users/luxiqiang/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image016.png" alt="img"></p>
<h3 id="2-1-3-BIM-项目微服务文件结构"><a href="#2-1-3-BIM-项目微服务文件结构" class="headerlink" title="2.1.3 BIM 项目微服务文件结构"></a>2.1.3 BIM 项目微服务文件结构</h3><p>├─base // 基础依赖库</p>
<p>│ ├─common</p>
<p>│ ├─message-help-starter</p>
<p>│ ├─message.help</p>
<p>│ ├─security.client</p>
<p>│ ├─server.core</p>
<p>│ └─server.support</p>
<p>├─database // 数据库相关配置</p>
<p>├─logs</p>
<p>├─requests</p>
<p>│ └─config-servers</p>
<p>└─servers // 服务包</p>
<p>  ├─batch.model // 模型服务(BIM业务的)</p>
<p>  │ ├─res</p>
<p>  │ ├─src</p>
<p>  ├─business-server // 项目业务服务目录</p>
<p>  │ ├─er</p>
<p>  │ ├─server-api-bpm // bpm流程api服务</p>
<p>  │ │ └─src</p>
<p>  │ ├─server-business // 项目服务</p>
<p>  │ │ ├─configDev</p>
<p>  │ │ ├─configPro</p>
<p>  │ │ ├─configTest</p>
<p>  │ │ ├─sql</p>
<p>  │ │ ├─src</p>
<p>  │ ├─server-doc // 档案服务</p>
<p>  │ │ ├─configDev</p>
<p>  │ │ ├─configPro</p>
<p>  │ │ ├─configTest</p>
<p>  │ │ └─src</p>
<p>  │ ├─server-labour // 劳务管理</p>
<p>  │ │ ├─configDev</p>
<p>  │ │ ├─configPro</p>
<p>  │ │ ├─configTest</p>
<p>  │ │ └─src</p>
<p>  │ ├─server-news // 新闻管理</p>
<p>  │ │ ├─configDev</p>
<p>  │ │ ├─configPro</p>
<p>  │ │ ├─configTest</p>
<p>  │ │ ├─src</p>
<p>  │ ├─server-quality // 质量管理</p>
<p>  │ │ ├─doc</p>
<p>  │ │ ├─sql</p>
<p>  │ │ └─src</p>
<p>  │ ├─server-safety // 安全管理</p>
<p>  │ │ ├─configDev</p>
<p>  │ │ ├─configPro</p>
<p>  │ │ ├─configTest</p>
<p>  │ │ ├─src</p>
<p>  │ ├─server-schedule</p>
<p>  │ │ ├─configDev</p>
<p>  │ │ ├─configPro</p>
<p>  │ │ ├─configTest</p>
<p>  │ │ ├─src</p>
<p>  │ ├─server-site // 现场管理</p>
<p>  │ │ ├─configDev</p>
<p>  │ │ ├─configPro</p>
<p>  │ │ ├─configTest</p>
<p>  │ │ └─src</p>
<p>  │ └─server-steel</p>
<p>  │   ├─configDev</p>
<p>  │   ├─configPro</p>
<p>  │   ├─configTest</p>
<p>  │   └─src</p>
<p>  ├─server-cost // 合同与产值</p>
<p>  │ ├─configDev</p>
<p>  │ ├─configPro</p>
<p>  │ ├─configTest</p>
<p>  │ ├─docs</p>
<p>  │ ├─src</p>
<p>  ├─funcs // 支撑性功能，旧项目移植过来，可以归到base</p>
<p>  │ ├─fastdfs</p>
<p>  │ ├─fastdfs-client-java</p>
<p>  │ ├─tus.upload</p>
<p>  │ └─video.ffmpeg</p>
<p>  ├─starters // starter（自定义的一些starter）</p>
<p>  │ ├─fastdfs-spring-boot-starter</p>
<p>  │ └─server.file // 文件服务，可以当到 sys-manage-center</p>
<p>  └─sys-manage-center // 框架性微服务</p>
<p>​    ├─api-gateway // 网关服务</p>
<p>​    │ ├─configDev</p>
<p>​    │ ├─configPro</p>
<p>​    │ ├─configTest</p>
<p>​    │ ├─src</p>
<p>​    ├─auth-center // 授权服务</p>
<p>​    │ ├─configDev</p>
<p>​    │ ├─configPro</p>
<p>​    │ ├─configTest</p>
<p>​    │ ├─docs</p>
<p>​    │ ├─src</p>
<p>​    ├─bpm-center // 流程服务</p>
<p>​    │ ├─configDev</p>
<p>​    │ ├─configPro</p>
<p>​    │ ├─configTest</p>
<p>​    │ ├─docs</p>
<p>​    │ ├─sql</p>
<p>​    │ ├─src</p>
<p>​    ├─config // 配置中心</p>
<p>​    │ ├─configDev</p>
<p>​    │ ├─configPro</p>
<p>​    │ ├─configTest</p>
<p>​    │ ├─src</p>
<p>​    ├─register // 注册中心</p>
<p>​    │ ├─configDev</p>
<p>​     │ ├─configPro</p>
<p>​    │ ├─configTest</p>
<p>​    │ ├─src</p>
<p>​    └─user-center // 用户中心</p>
<p>​      ├─configDev</p>
<p>​      ├─configPro</p>
<p>​      ├─configTest</p>
<p>​      ├─doc</p>
<p>​      ├─sql</p>
<p>​      ├─src</p>
<p>原来规划了一个api层但是common里面要统一实体，维护起来很麻烦，就没维护了</p>
<p>各服务数据库隔离，原则上不允许跨库跨模式查询</p>
<h3 id="2-1-4-Ebid-电子招投标项目微服务文件结构"><a href="#2-1-4-Ebid-电子招投标项目微服务文件结构" class="headerlink" title="2.1.4 Ebid 电子招投标项目微服务文件结构"></a>2.1.4 Ebid 电子招投标项目微服务文件结构</h3><p><img src="file:////Users/luxiqiang/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image017.png" alt="img"></p>
<h2 id="2-2-服务划分"><a href="#2-2-服务划分" class="headerlink" title="2.2 服务划分"></a>2.2 服务划分</h2><h3 id="2-2-1-服务划分"><a href="#2-2-1-服务划分" class="headerlink" title="2.2.1 服务划分"></a>2.2.1 服务划分</h3><p>微服务的划分方法，常见的是两种，按业务能力和按子域。有的观点，认为两种划分可以根据不同的情况进行选择。而有的观点，认为应该这样划分而不要那样划分。</p>
<p>“子域”，就是DDD中的”子域”。</p>
<p>“业务能力”，是一个专用名词，指的是一个连续的业务过程，其中不需要中断，也不需要别的业务过程的参与。这些业务过程自然组织起来，比如首尾相连，或者，由用户参与来自然连接。</p>
<p>两种不同的服务划分风格，反映了对业务本身的不同的描述与划分的风格。</p>
<p>比较形象地讲，按子域划分，就是把业务划成一块一块的。按业务能力划分，就是把业务划成一段一段的。一块一块的，描述业务概念和它们之间的关系。一段一段的，描述业务执行的步骤和过程。</p>
<p>按业务能力划分的优势主要在运行时。各个服务的运行时依赖被尽量减少。在服务性能、可用性方面不会相互牵绊，可以做到最好。</p>
<p>而按子域划分的优势主要在设计时和演进时。有利于应对业务的规模发展、复杂性增加和分别演进。</p>
<h3 id="2-2-2-共享实体"><a href="#2-2-2-共享实体" class="headerlink" title="2.2.2 共享实体"></a>2.2.2 共享实体</h3><p>\1.  做基础包负责实体的管理，但是没有必要，一个是不同服务可能完全是两种语言，共享实体的问题不存在，2.同样语言，不同服务的编写团队不同，风格不同，规范不同，反而会引起工程管理的复杂，所以既然是微服务就遵循它的优势，足够独立；</p>
<p>\2.  微服务的主要优点体现在这里：你可以按照你的情况自己决定你在多大程度上共享实体。不同的语言、不同的团队、不同的业务节奏、实体上不同的关注角度，都可以导致你对实体共享的程度不同，而这些程度都可以在微服务的架构中得到支持。而且当你的共享程度在演进中发生变化的时候，微服务架构也能支持。</p>
<p>\3.  请求和响应 以DTO 的形式放到一个公共的包中 gradle编译可控制哪些类不要编译 按需编译 然后DTO 和 DO 间采用 mapstruct 转换。</p>
<p>\4.  解决方法有三个：1.单独将user实体类放入common包中，如果这样，user实体类的增删改查方法再auth中，但是实体类却在common中，难免有些奇怪，后期维护的时候可能会找不到这个实体类。2.将所有的entity都放入common包中。这样算然比较统一，但是对本系统进行分割，本来就是因为系统的业务比较独立，除了某些特殊情况外，实体类应该是不会有任何的共有。3.观察了一下，hr这边虽然引用了user类，但实际上只是想获取user类中的邮箱字段，既然如此，就直接写个接口返回Map即可。最后采用的是第三种解决办法，虽然说是彻底解耦了，但是只是调用一次接口就返回一个字符串，也不知道是否是最佳方案。</p>
<p>\5.  独立的服务独立的数据源 entity公用就没有分库的意义了。</p>
<h3 id="2-2-3-POJO-DTO"><a href="#2-2-3-POJO-DTO" class="headerlink" title="2.2.3 POJO DTO"></a>2.2.3 POJO DTO</h3><p>DTO（Data Transfer Object）数据传输对象，服务间的交互使用DTO来解耦</p>
<p>VO（Value Object）值对象，前端展示的数据</p>
<p>PO（Persistant Object）持久对象</p>
<p>BO（Business Object）业务对象，服务内部使用的业务对象，用来存储数据库提取的数据</p>
<p>系统和系统的复杂度不同，协作水平不同而定，协作时保证概念一致</p>
<p>DTO 和 DO 间采用dozer + lombok， mapstruct 转换</p>
<h2 id="2-3-微服务项目规划"><a href="#2-3-微服务项目规划" class="headerlink" title="2.3 微服务项目规划"></a>2.3 微服务项目规划</h2><h3 id="2-3-1-技术选型"><a href="#2-3-1-技术选型" class="headerlink" title="2.3.1 技术选型"></a>2.3.1 技术选型</h3><p>Spring Cloud Alibaba </p>
<p>SpringCloud GateWay 网关 </p>
<p>Nacos：服务发现、配置管理和服务管理</p>
<p>Feign: 服务间调用</p>
<p>Redis:</p>
<p>RocketMQ：</p>
<p><strong>可选：</strong></p>
<p>Sentinel：流量控制、熔断降级、负载保护</p>
<p>Ribbon:负载均衡</p>
<p>Spring Cloud LoadBalancer：客户端负载均衡</p>
<p>Seata：分布式事务</p>
<p>Skywalking:链路追踪</p>
<p>任务调度：</p>
<p>Grafana：大屏展示-服务监控</p>
<p>Prometheus：监控报警-服务监控</p>
<p>Zipkin：调用链跟踪-服务监控</p>
<p>EPK：日志中心-服务监控</p>
<p>Security：安全审计-服务监控</p>
<h3 id="2-3-2-项目文件目录规划"><a href="#2-3-2-项目文件目录规划" class="headerlink" title="2.3.2 项目文件目录规划"></a>2.3.2 项目文件目录规划</h3><p>微服务项目名称：<strong>rdp-cloud</strong></p>
<p>rdp-base – 公共工具类核心包</p>
<p>rdp-common – 公共类包</p>
<p>rdp-auth – 授权服务</p>
<p>rdp-services – 微服务</p>
<p>|–service-flowable – 流程微服务</p>
<p>|–service-user – 用户微服务</p>
<p>|–service-generator – 代码生成微服务</p>
<p>|–service-system –系统功能微服务</p>
<p>|–service-jog –任务服务</p>
<p>|……</p>
<p>rdp-service-api – 微服务间接口定义模块</p>
<p>rdp-ops – 微服务基础模块</p>
<p>|–gateway –Spring Cloud Gateway网关</p>
<p>|–register –Nacos Server</p>
<p>|–monitor –服务监控</p>
<p>|–sentinel-dashboard –流量高可用</p>
<p>\1. 基础类包与公共类包的处理方式？随业务变化和基本不变的类处理方式？</p>
<p>\2. 微服务间 DTO 类的定义及处理方式？</p>
<p>\3. rdp-services 业务服务统一归此文件下。</p>
<p>\4. rdp-ops 微服务架构相关的扩展统一归此文件下。</p>
<h2 id="2-4-系统介绍"><a href="#2-4-系统介绍" class="headerlink" title="2.4 系统介绍"></a>2.4 系统介绍</h2><h3 id="2-4-1-密码授权"><a href="#2-4-1-密码授权" class="headerlink" title="2.4.1 密码授权"></a>2.4.1 密码授权</h3><p>1.获取验证码</p>
<p>GET <a href="http://localhost:8802/auth/captcha?key=6113" target="_blank" rel="noopener">http://localhost:8802/auth/captcha?key=6113</a></p>
<p>\2. 密码登录获取Token</p>
<p>Post <a href="http://localhost:8802/auth/oauth/token" target="_blank" rel="noopener">http://localhost:8802/auth/oauth/token</a></p>
<p><img src="file:////Users/luxiqiang/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image018.png" alt="img"></p>
<p><strong>返回Response</strong>:</p>
<p>{“access_token”:”2a60eb6a-779e-4911-9ed4-902f978d8299”,”token_type”:”bearer”,”refresh_token”:”1fde4fa4-3083-4e40-a714-fd4cf492f7a0”,”expires_in”:86399,”scope”:”all”}</p>
<p><strong>Authorization</strong>: Basic base64encode(username+”:”+password),username:第三方应用名称，password:密码。</p>
<p><strong>使用PostMan 时，可选择Basic Auth</strong></p>
<p><img src="file:////Users/luxiqiang/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image019.png" alt="img"></p>
<p>3.通过token获取 用户信息及权限信息</p>
<p>Get <a href="http://localhost:8802/auth/user" target="_blank" rel="noopener">http://localhost:8802/auth/user</a></p>
<p><strong>Authorization</strong>: bearer 2a60eb6a-779e-4911-9ed4-902f978d8299</p>
<p><strong>Authorization=bearer+token</strong></p>
<p>4.检查token,检查token相应的用户及权限信息</p>
<p>POST <a href="http://localhost:8802/auth/oauth/check_token" target="_blank" rel="noopener">http://localhost:8802/auth/oauth/check_token</a> </p>
<p>Authorization: Basic ZmViczoxMjM0NTY=</p>
<p>token=b2633257-3e2d-447a-aa22-5f1fb2b4cada</p>
<p>5.刷新token,更新token 有效期</p>
<p><a href="http://localhost:8802/auth/oauth/token" target="_blank" rel="noopener">http://localhost:8802/auth/oauth/token</a></p>
<p><img src="file:////Users/luxiqiang/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image020.png" alt="img"></p>
<h1 id="3-授权、认证服务"><a href="#3-授权、认证服务" class="headerlink" title="3  授权、认证服务"></a>3  授权、认证服务</h1><h2 id="3-1-spring-cloud-starter-security"><a href="#3-1-spring-cloud-starter-security" class="headerlink" title="3.1 spring-cloud-starter-security"></a>3.1 spring-cloud-starter-security</h2><p>spring-cloud-starter-security主要用来认证和授权, 怎么授权呢? spring-cloud-starter-security提供许多拦截器, 当你在登录的时候, 他就把你拦下来检查,看有没有登录信息, 如果没有就不给过, 在requestMapping上, 由于加了需要某某权限才能访问此方法, 于是又被拦下检查, 这次检查有没有需要的权限。</p>
<h2 id="3-2-spring-cloud-starter-oauth2"><a href="#3-2-spring-cloud-starter-oauth2" class="headerlink" title="3.2 spring-cloud-starter-oauth2"></a>3.2 spring-cloud-starter-oauth2</h2><p>spring-cloud-starter-oauth2主要用来认证, 它只负责发放令牌, 你只要带着它要求的参数, 通过它给的路径去访问它, 他就给你一个令牌, 别的事他不管。</p>
<p>OAuth 2 有四种授权模式，分别是授权码模式（authorization code）、简化模式（implicit）、密码模式（resource owner password credentials）、客户端模式（client credentials）。</p>
<p>公司内部有很多个服务，可以专门提取出一个认证中心，这个认证中心就充当上面所说的权威认证平台的角色，所有的服务都要到这个认证中心做认证。</p>
<p>对于多服务的平台，可以使用 OAuth2 实现服务的单点登录，只做一次登录，就可以在多个服务中自由穿行，当然仅限于授权范围内的服务和接口。</p>
<p>配置最多的就是认证服务端，验证账号、密码，存储 token，检查 token ,刷新 token 等都是认证服务端的工作。</p>
<p>spring-cloud-starter-oauth2包含了 spring-cloud-starter-security，所以不用再单独引入了。</p>
<p>参考资料：</p>
<p>code 参数换取 Token，access_token ，使用它，就可以去获取用户的资源了</p>
<p><a href="https://www.cnblogs.com/xiaofengwang/p/11376881.html" target="_blank" rel="noopener">https://www.cnblogs.com/xiaofengwang/p/11376881.html</a></p>
<p><a href="https://www.jianshu.com/p/a711ea5ad965" target="_blank" rel="noopener">https://www.jianshu.com/p/a711ea5ad965</a></p>
<p><a href="https://blog.csdn.net/j754379117/article/details/70175198" target="_blank" rel="noopener">https://blog.csdn.net/j754379117/article/details/70175198</a></p>
<p><a href="https://www.cnblogs.com/fengzheng/p/11724625.html" target="_blank" rel="noopener">https://www.cnblogs.com/fengzheng/p/11724625.html</a></p>
<p><a href="https://www.cnblogs.com/fengzheng/p/11810340.html" target="_blank" rel="noopener">https://www.cnblogs.com/fengzheng/p/11810340.html</a></p>
<p><img src="file:////Users/luxiqiang/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image021.png" alt="img"></p>
<p>流程图中，包含四个角色。</p>
<p>ResourceOwner为资源所有者，即为用户</p>
<p>User-Agent为浏览器</p>
<p>AuthorizationServer为认证服务器，可以理解为用户资源托管方，比如企业微信服务端</p>
<p>Client为第三方服务</p>
<p>调用流程为：</p>
<p>A) 用户访问第三方服务，第三方服务通过构造OAuth2链接（参数包括当前第三方服务的身份ID，以及重定向URI），将用户引导到认证服务器的授权页</p>
<p>B) 用户选择是否同意授权</p>
<p>C) 若用户同意授权，则认证服务器将用户重定向到第一步指定的重定向URI，同时附上一个授权码。</p>
<p>D) 第三方服务收到授权码，带上授权码来源的重定向URI，向认证服务器申请凭证。</p>
<p>E) 认证服务器检查授权码和重定向URI的有效性，通过后颁发AccessToken（调用凭证）</p>
<p><strong>D)**</strong>与E)<strong>**的调用为后台调用，不通过浏览器进行</strong></p>
<h3 id="3-2-1-oauth中的角色"><a href="#3-2-1-oauth中的角色" class="headerlink" title="3.2.1 oauth中的角色"></a>3.2.1 oauth中的角色</h3><p><strong>client</strong>：调用资源服务器API的应用</p>
<p><strong>Oauth</strong> 2.0 Provider：包括Authorization Server和Resource Server</p>
<p>（1）<strong>Authorization Server</strong>：认证服务器，进行认证和授权</p>
<p>（2）<strong>Resource Server</strong>：资源服务器，保护受保护的资源</p>
<p><strong>user</strong>：资源的拥有者</p>
<p><strong>Oauth 2.0 Provider**</strong>介绍**</p>
<p><strong>Authorization Server:</strong></p>
<p>（1）AuthorizationEndpoint:进行授权的服务，Default URL: /oauth/authorize</p>
<p>（2）TokenEndpoint：获取token的服务，Default URL: /oauth/token</p>
<p><strong>Resource Server</strong>:</p>
<p>OAuth2AuthenticationProcessingFilter：给带有访问令牌的请求加载认证</p>
<h3 id="3-2-2-Authorization-Server"><a href="#3-2-2-Authorization-Server" class="headerlink" title="3.2.2 Authorization Server"></a>3.2.2 Authorization Server</h3><p>1、  创建两个配置类，一个继承AuthorizationServerConfigurerAdapter，一个继承WebSecurityConfigurerAdapter。</p>
<p>2、  主要的两种注解：</p>
<p><strong>@EnableAuthorizationServer</strong>：声明一个认证服务器，当用此注解后，应用启动后将自动生成几个Endpoint：</p>
<p>/oauth/authorize：验证</p>
<p>/oauth/token：获取token</p>
<p>/oauth/confirm_access：用户授权</p>
<p>/oauth/error：认证失败</p>
<p>/oauth/check_token：资源服务器用来校验token</p>
<p>/oauth/token_key：如果jwt模式则可以用此来从认证服务器获取公钥</p>
<p>以上这些endpoint都在源码里的endpoint包里面。</p>
<p><strong>@Beans</strong>：需要实现AuthorizationServerConfigurer</p>
<p><strong>AuthorizationServerConfigurer**</strong>包含三种配置：**</p>
<p>ClientDetailsServiceConfigurer：client客户端的信息配置</p>
<p>AuthorizationServerSecurityConfigurer：声明安全约束，哪些允许访问，哪些不允许访问</p>
<p>AuthorizationServerEndpointsConfigurer：声明授权和token的端点以及token的服务的一些配置信息，比如采用什么存储方式、token的有效期等</p>
<h3 id="3-2-3-授权码授权过程"><a href="#3-2-3-授权码授权过程" class="headerlink" title="3.2.3 授权码授权过程"></a>3.2.3 授权码授权过程</h3><p><img src="file:////Users/luxiqiang/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image023.png" alt="img"></p>
<p>1.授权登录：用户打开第三方应用页面<strong>自动跳转</strong>到平台授权页面或者<strong>点击打开</strong>跳转到授权页面；<strong>不同平台有不同的授权页面地址</strong>。</p>
<p>2.授权平台：跳转页面的传参appid、redirect_uri等参数进行验证，通过则返回授权提示页面。</p>
<p>3.返回授权提示页面，提示用户授权的范围及应用，询问是否允许授权。</p>
<p>4.用户点击允许授权第三方应用，申请分配code。</p>
<p>5.向授权平台申请生成code，平台验证参数生成code。</p>
<p>6.返回code并重定向到第三方应用链接（<strong>不同平台返回链接不一样</strong>）。</p>
<p>7.返回第三方应用前端，第三方应用以Code向第三方服务端申请登录（带上授权平台属性）。</p>
<p>8.第三方服务端以code向<strong>相应授权平台</strong>申请token。</p>
<p>9.授权平台验证参数，返回token及时效信息。</p>
<p>10.第三方服务端以token到<strong>相应平台</strong>取资源信息（用户信息）。</p>
<p>11.返回资源信息，第三方服务端保存平台token及用户信息。</p>
<p>12.第三方服务端进行登录操作并返回登录信息。</p>
<p><strong>注：</strong></p>
<p><strong>1、</strong> <strong>第2**</strong>、3<strong><strong>、4</strong></strong>、5<strong>**步可能存在合并的情况。</strong></p>
<p><strong>2、</strong> <strong>第11**</strong>步用户信息，需要区分租户，保存用户信息及平台ID<strong><strong>，用户在平台上的ID</strong></strong>。**</p>
<p><strong>3、</strong> <strong>第12**</strong>步在第三方登录授权** <strong>与</strong> <strong>平台授权区分，以及有效时间区分。</strong></p>
<p><strong>4、</strong> <strong>第6**</strong>步重定向到第三方前端地址方便控制，也可重定到第三方服务端。**</p>
<h1 id="4-Java基础知识"><a href="#4-Java基础知识" class="headerlink" title="4  Java基础知识"></a>4  Java基础知识</h1><h2 id="4-1-EnableAutoConfiguration"><a href="#4-1-EnableAutoConfiguration" class="headerlink" title="4.1 EnableAutoConfiguration"></a>4.1 EnableAutoConfiguration</h2><p>在一些扩展项目上，我们无法直接操作 spring 容器，可以通过 在任意src目录下添加 文件写入我们的 配置类，/META-INF/spring.factories</p>
<p>键值为： org.springframework.boot.autoconfigure.EnableAutoConfiguration</p>
<h2 id="4-2-Filter"><a href="#4-2-Filter" class="headerlink" title="4.2 Filter"></a>4.2 Filter</h2><p>　　Servlet过滤器Fileter是一个小型的web组件，它们通过拦截请求和响应，以便查看、提取或以某种方式操作客户端和服务器之间交换的数据，实现“过滤”的功能。Filter通常封装了一些功能的web组件，过滤器提供了一种面向对象的模块化机制，将任务封装到一个可插入的组件中， Filter组件通过配置文件来声明，并动态的代理。</p>
<h2 id="4-3-Spring"><a href="#4-3-Spring" class="headerlink" title="4.3 Spring"></a>4.3 Spring</h2><p>控制反转IOC、依赖注入、容器管理对象的生命周期、反射机制。</p>
<p>面向切面编程（AOP）框架、AspectJ、代理模式。</p>
<p>Spring 中使用的对象都由 IoC 容器管理，不需要我们手动使用 new 运算符创建对象。由 IoC 容器管理的对象称为 Spring Bean，Spring Bean 就是 Java 对象，和使用 new 运算符创建的对象没有区别。</p>
<p>Spring 通过读取 XML 或 Java 注解中的信息来获取哪些对象需要实例化。</p>
<p><a href="http://c.biancheng.net/spring_boot/" target="_blank" rel="noopener">http://c.biancheng.net/spring_boot/</a></p>
<h3 id="4-3-1-IOC"><a href="#4-3-1-IOC" class="headerlink" title="4.3.1 IOC"></a>4.3.1 IOC</h3><p>在传统的Java编程中，当需要用到某个对象的时候，我们都是主动显式创建一个对象实例（new）。使用Spring后就不需要这样做了，因为Spring会帮我们在需要用到某些对象的地方自动注入该对象，而无须我们自己去创建。这种模式俗称控制反转，即IOC（Inversion of Control）。</p>
<p>@ComponentScan注解来扫描组件并注册，路径下所有被@Controller、@Service、@Repository和@Component注解标注的类都会被纳入IOC容器中。</p>
<h3 id="4-3-2-注解"><a href="#4-3-2-注解" class="headerlink" title="4.3.2 注解"></a>4.3.2 注解</h3><p>@SpringBootApplication 来标注一个主程序类，说明这是一个Spring Boot应用，@SpringBootApplication是一个复合注解，包括@ComponentScan，@SpringBootConfiguration，@EnableAutoConfiguration。</p>
<p>@RestController的意思就是controller里面的方法都以json格式输出。</p>
<p>@Component将类添加进容器，@ConfigurationProperties配置文件中的数据注入到类中。</p>
<p>@SpringBootConfiguration继承自@Configuration，二者功能也一致，标注当前类是配置类，并会将当前类内声明的一个或多个以@Bean注解标记的方法的实例纳入到srping容器中，并且实例名就是方法名。</p>
<p>@EnableAutoConfiguration的作用启动自动的配置。</p>
<p>@EnableAutoConfiguration注解的意思就是Springboot根据你添加的jar包来配置你项目的默认配置，比如根据spring-boot-starter-web，来判断你的项目是否需要添加了webmvc和tomcat，就会自动的帮你配置web项目中所需要的默认配置。</p>
<p>@ComponentScan，扫描当前包及其子包下被@Component，@Controller，@Service，@Repository注解标记的类并纳入到spring容器中进行管理。</p>
<p>@ResponseBody 表示该方法的返回结果直接写入HTTP response body中，一般在异步获取数据时使用，用于构建RESTful的api。在使用@RequestMapping后，返回值通常解析为跳转路径，加上@esponsebody后返回结果不会被解析为跳转路径，而是直接写入HTTP response body中。比如异步获取json数据，加上@Responsebody后，会直接返回json数据。该注解一般会配合@RequestMapping一起使用。</p>
<p>@Controller 用于定义控制器类，在spring项目中由控制器负责将用户发来的URL请求转发到对应的服务接口（service层），一般这个注解在类中，通常方法需要配合注解@RequestMapping。</p>
<p>@RestController用于标注控制层组件(如struts中的action)，@ResponseBody和@Controller的合集。</p>
<p>@Service一般用于修饰service层的组件。</p>
<p>@Repository 使用@Repository注解可以确保DAO或者repositories提供异常转译，这个注解修饰的DAO或者repositories类会被ComponetScan发现并配置，同时也不需要为它们提供XML配置项。</p>
<p>@Bean用@Bean标注方法等价于XML中配置的bean。</p>
<p>@Value注入Spring boot application.properties配置的属性的值。</p>
<p>@PropertySource 如果将所有的配置都集中到 application.properties 或 application.yml 中，那么这个配置文件会十分的臃肿且难以维护，因此我们通常会将与 Spring Boot 无关的配置（例如自定义配置）提取出来，写在一个单独的配置文件中，并在对应的 JavaBean 上使用 @PropertySource 注解指向该配置文件。</p>
<p>@ImportResource Spring Boot 中是不包含任何的 Spring 配置文件的，即使我们手动添加 Spring 配置文件到项目中，也不会被识别。那么 Spring Boot 项目中真的就无法导入 Spring 配置吗？答案是否定的。</p>
<p>Spring Boot 为了我们提供了以下 2 种方式来导入 Spring 配置：</p>
<p>使用 @ImportResource 注解加载 Spring 配置文件</p>
<p>使用全注解方式加载 Spring 配置</p>
<p><a href="https://www.cnblogs.com/aademeng/articles/11218079.html" target="_blank" rel="noopener">https://www.cnblogs.com/aademeng/articles/11218079.html</a></p>
<h3 id="4-3-3-配置绑定"><a href="#4-3-3-配置绑定" class="headerlink" title="4.3.3 配置绑定"></a>4.3.3 配置绑定</h3><p>SpringBoot 提供了以下 2 种方式进行配置绑定：</p>
<p>使用 @ConfigurationProperties 注解</p>
<p>使用 @Value 注解</p>
<p>只有在容器中的组件，才会拥有 SpringBoot 提供的强大功能。如果我们想要使用 @ConfigurationProperties 注解进行配置绑定，那么首先就要保证该对 JavaBean 对象在 IoC 容器中，所以需要用到 @Component 注解来添加组件到容器中。</p>
<p>@PropertySource(value = “classpath:person.properties”)//指向对应的配置文件</p>
<p>@Component</p>
<p>@ConfigurationProperties(prefix = “person”)</p>
<p>public class Person {</p>
<p>@Value(“${person.lastName}”)</p>
<p>private String lastName;</p>
<p>yml 配置</p>
<p>与 properties 文件类似，我们也可以添加 4 个配置文件：</p>
<p>applcation.yml：默认配置</p>
<p>application-dev.yml：开发环境配置</p>
<p>application-test.yml：测试环境配置</p>
<p>application-prod.yml：生产环境配置</p>
<h3 id="4-3-4-Spring-Boot统一日志框架"><a href="#4-3-4-Spring-Boot统一日志框架" class="headerlink" title="4.3.4 Spring Boot统一日志框架"></a>4.3.4 Spring Boot统一日志框架</h3><p>SpringBoot 底层使用 slf4j+logback 的方式记录日志，当我们引入了依赖了其他日志框架的第三方框架（例如 Hibernate）时，只需要把这个框架所依赖的日志框架排除，即可实现日志框架的统一，示例代码如下。</p>
<dependency>

<p>  <groupid>org.apache.activemq</groupid></p>
<p>  <artifactid>activemq-console</artifactid></p>
<p>  <version>${activemq.version}</version></p>
<hr>
<p>​    ****</p>
<p>​      <strong>commons-logging</strong></p>
<p>​      <strong>commons-logging</strong></p>
<p>​    ****</p>
<hr>
</dependency>



<h3 id="4-3-5-Spring-Boot拦截器"><a href="#4-3-5-Spring-Boot拦截器" class="headerlink" title="4.3.5 Spring Boot拦截器"></a>4.3.5 Spring Boot拦截器</h3><p>定义拦截器</p>
<p>在 Spring Boot 中定义拦截器十分的简单，只需要创建一个拦截器类，并实现 HandlerInterceptor 接口即可。</p>
<p>注册拦截器</p>
<p>创建一个实现了 WebMvcConfigurer 接口的配置类（使用了 @Configuration 注解的类），重写 addInterceptors() 方法，并在该方法中调用 registry.addInterceptor() 方法将自定义的拦截器注册到容器中。</p>
<p>指定拦截规则</p>
<p>在使用 registry.addInterceptor() 方法将拦截器注册到容器中后，我们便可以继续指定拦截器的拦截规则了。</p>
<h3 id="4-3-6-数据源Druid"><a href="#4-3-6-数据源Druid" class="headerlink" title="4.3.6 数据源Druid"></a>4.3.6 数据源Druid</h3><p>Druid 是阿里巴巴推出的一款开源的高性能数据源产品，Druid 支持所有 JDBC 兼容的数据库，包括 Oracle、MySQL、SQL Server 和 H2 等等。Druid 不仅结合了 C3P0、DBCP 和 PROXOOL 等数据源产品的优点，同时还加入了强大的监控功能。通过 Druid 的监控功能，可以实时观察数据库连接池和 SQL 的运行情况，帮助用户及时排查出系统中存在的问题。</p>
<h3 id="4-3-7-Spring-AOP：基于AspectJ注解开发"><a href="#4-3-7-Spring-AOP：基于AspectJ注解开发" class="headerlink" title="4.3.7 Spring AOP：基于AspectJ注解开发"></a>4.3.7 Spring AOP：基于AspectJ注解开发</h3><p>AOP底层为动态代理，AOP指的是：在程序运行期间动态地将某段代码切入到指定方法指定位置进行运行的编程方式，相关设计模式为代理模式。面向切面编程（AOP）框架、AspectJ、代理模式。</p>
<p><strong>定义切面@Aspect</strong></p>
<p>@Aspect</p>
<p>public class AspectModule {</p>
<p><strong>定义切入点@Pointcut</strong></p>
<p>// 要求：方法必须是private，返回值类型为void，名称自定义，没有参数</p>
<p>@Pointcut(“execution(<em>net.biancheng..</em>.*(..))”)</p>
<p>private void myPointCut() {</p>
<p>}</p>
<p><strong>定义通知advice</strong></p>
<p>@AspectJ 支持 5 种类型的 advice，以下为使用 @Before 的示例。</p>
<p>@Before(“myPointCut()”)</p>
<p>public void beforeAdvice(){</p>
<h3 id="4-3-8-事务"><a href="#4-3-8-事务" class="headerlink" title="4.3.8 事务"></a>4.3.8 事务</h3><p>事务具有以下 4 个特性，即原子性、一致性、隔离性和持久性，这 4 个属性称为 ACID 特性。</p>
<p>原子性（Atomicity）：一个事务是一个不可分割的工作单位，事务中包括的动作要么都做要么都不做。</p>
<p>一致性（Consistency）：事务必须保证数据库从一个一致性状态变到另一个一致性状态，一致性和原子性是密切相关的。</p>
<p>隔离性（Isolation）：一个事务的执行不能被其它事务干扰，即一个事务内部的操作及使用的数据对并发的其它事务是隔离的，并发执行的各个事务之间不能互相打扰。</p>
<p>持久性（Durability）：持久性也称为永久性，指一个事务一旦提交，它对数据库中数据的改变就是永久性的，后面的其它操作和故障都不应该对其有任何影响。</p>
<h3 id="4-3-9-java的反射机制"><a href="#4-3-9-java的反射机制" class="headerlink" title="4.3.9 java的反射机制"></a>4.3.9 java的反射机制</h3><p>Java语言允许通过程序化的方式间接对Class的对象实例操作，Class文件由类装载器装载后，在JVM中将形成一份描述Class结构的元信息对象，通过该元信息对象可以获知Class的结构信息：构造函数、属性和方法等。Java允许用户借由这个Class相关的元信息对象间接调用Class对象的功能.</p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2021-09-18T09:12:12.000Z">2021-09-18</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    13 分钟 读完 (大约 1947 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2021/09/18/bpmn%E6%B5%81%E7%A8%8B%E6%A8%A1%E5%BC%8F/">bpmn流程模式</a>
            
        </h1>
        <div class="content">
            <p>BPM常见的流程模式有：顺序流程、会签流程、或签流程、分支流程、并行流程、子流程、任意流程等，这些流程模式均在BPMN2.0规范中有明确的定义，activiti、flowable、camunda等开源工作流引擎也都支持这些模式，以下重点介绍会签流程、或签流程、分支流程、并行流程这四种流程模式。</p>
<p>一、会签流程<br>1、适用场景<br>会签是一种联合审批的特殊审批节点，可理解为一种多人投票机制，一个任务需要多个人同时处理，然后汇总多个人的意见，决定流程下一步该如何执行。流程设计时，若会签审批节点中设置多个参与人，流程运行时，会签节点任务需要多人共同处理，然后汇总多人的处理意见，决定会签节点的处理结果。<br>例如：员工发起采购申请，需经过多名领导共同审批后，才决定是否可以采购，只要其中1名领导不同意，便退回申请人。</p>
<p><img src="https://img-blog.csdnimg.cn/20210415232105746.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3d4ejI1OA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<p>2、具体规则<br>会签分并行会签和顺序会签两种：<br>并行会签：指同一个审批节点设置多个人，如ABC三人，三人会同时收到待办，需全部同意之后，审批才可到下一审批节点。<br>顺序会签：指同一个审批节点设置多个人，如ABC三人，三人按顺序依次收到待办，即A先审批，A提交后B才能审批，需全部同意之后，审批才可到下一审批节点。</p>
<p>3、设置方法<br>BPMN2.0规范中提供了bpmn:multiInstanceLoopCharacteristics多实例循环的模型定义，activiti、flowable、camunda等开源工作流引擎均支持该属性，云程BPM基于camunda实现，对bpmn:multiInstanceLoopCharacteristics进行了封装，提供了界面可视化配置功能，并支持多人并行会签和多人顺序会签的功能，顺序会签在一些特定的业务场景下是有用的，个别中国特色流程需求有审批顺序的要求。</p>
<p><img src="https://img-blog.csdnimg.cn/20210415232131424.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3d4ejI1OA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<p>二、或签流程<br>1、适用场景<br>一个流程审批节点里有多个处理人，任意一个人处理后就能进入下一个节点。<br>例如：员工发起采购申请，提交给多名领导审批，只要有一名领导同意即可提交到下一节点。</p>
<p><img src="https://img-blog.csdnimg.cn/20210415232309212.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3d4ejI1OA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<p>2、具体规则<br>指同一个审批节点设置多个人，如ABC三人，三人会同时收到审批待办，只要其中任意一人审批即可到下一审批节点。</p>
<p>3、设置方法<br>BPMN2.0规范中提供了bpmn:multiInstanceLoopCharacteristics多实例循环的模型定义，并通过bpmn:completionCondition标签定义多实例完成条件，activiti、flowable、camunda等开源工作流引擎均支持该属性，云程BPM基于camunda实现，对bpmn:multiInstanceLoopCharacteristics和bpmn:completionCondition进行了封装，提供了界面可视化配置功能，配置多人办理规则为“多人任意”即可实现该功能。</p>
<p><img src="https://img-blog.csdnimg.cn/2021041523233911.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3d4ejI1OA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<p>三、分支流程<br>1、适用场景<br>分支流程的适用场景：流程中某个节点后有多个分支节点，根据不同条件执行不同的分支，即不同的数据会走不同的流程路径。<br>例如：请假申请，可根据请假天数走不同的审批路径，3天以内请假由人力资源审批，超过3天的请假由公司领导审批。</p>
<p><img src="https://img-blog.csdnimg.cn/20210415232404880.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3d4ejI1OA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<p>2、具体规则<br>1、分支流程使用【排他网关】，连接在【排他网关】后面的线条，有分流作用，点击线条可设置流转条件；<br>2、上一节点点击【提交】后，根据【排他网关】设置按顺序判断所有分支流转条件，出现满足流转条件时，就进入相应的分支节点。<br>3、如果不设置，表示无条件限制，会直接进入该节点；如果设置了流转条件，则只有满足条件才会进入该节点；如果所有的条件都不满足，则会流转到设置的默认方向；如果有多个条件满足，则会按设置的条件顺序判断，直到出现第一个满足的条件，就进入该节点。</p>
<p>3、设置方法<br>BPMN2.0规范中提供了bpmn:exclusiveGateway排他网关标签，activiti、flowable、camunda等开源工作流引擎均支持该标签，云程BPM基于camunda实现，严格遵照标准的BPMN2.0网关模型，并提供了界面可视化配置功能。</p>
<p><img src="https://img-blog.csdnimg.cn/20210415232437371.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3d4ejI1OA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<p>四、并行流程<br>1、适用场景<br>并行流程适用场景：流程中某个节点后有多个节点需要并行执行，节点的处理人需同时收到流程待办，各自处理待办，当所有分支线上的节点都执行后，流程才进入到下一个节点。<br>例如：员工提交请假申请，同时送部门经理和人力资源部审批，需要部门经理和人力资源全部审批通过后，才算流程审批通过。</p>
<p><img src="https://img-blog.csdnimg.cn/20210415232511851.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3d4ejI1OA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<p>2、具体规则<br>1、【并行网关】必须成双使用，连接在【并行网关】后面的线条，才有并流作用；<br>2、上一节点点击【提交】后，无论线条是否设置条件，都自动进入所有的分支节点。当所有分支都执行后，才进入这些分支同时连接的下一个节点；</p>
<p>3、设置方法<br>BPMN2.0规范中提供了bpmn:parallelGateway并行网关标签，activiti、flowable、camunda等开源工作流引擎均支持该标签，云程BPM基于camunda实现，严格遵照标准的BPMN2.0网关模型，并提供了界面可视化配置功能。</p>
<p><img src="https://img-blog.csdnimg.cn/20210415232536820.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3d4ejI1OA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2021-09-17T06:57:23.000Z">2021-09-17</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    19 分钟 读完 (大约 2809 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2021/09/17/%E5%B7%A5%E4%BD%9C%E6%B5%81%E8%AE%BE%E8%AE%A1/">工作流设计</a>
            
        </h1>
        <div class="content">
            <h2 id="7个方面总结：审批工作流设计"><a href="#7个方面总结：审批工作流设计" class="headerlink" title="7个方面总结：审批工作流设计"></a>7个方面总结：审批工作流设计</h2><p>工作流是后台系统的核心和灵魂，而审批则是工作流中的最基础的应用场景。在公司管理和运转中引入审批工作流，替代原本的纸质申请和审批，可以达到以下目标：</p>
<ul>
<li>提高公司的运转效率</li>
<li>公司管理制度规范化</li>
<li>系统留档，便于追溯</li>
<li>环保</li>
</ul>
<p>本文将从角色、内容、流程、动作、权限、配置、效率7个方面，对审批工作流的产品设计进行总结。</p>
<p><strong>一. 角色</strong></p>
<p>在一个公司中，每个人都会有自己的岗位职责和层级之分，不同的岗位和层级定位不一样，需要完成的任务也不一样。在审批流程中，我们只抽象划分为两类：</p>
<p>角色1：发起人</p>
<p>审批的发起人需要完成的主要是事务性、操作性的工作，同时也是一个审批流程的Owner，是最关心审批进展的人。因此在发起人的角度，在创建完审批事项后，还需要完善相关信息、催促审批人及时审批、处理驳回修改意见、重新提交等。发起人角度设计的要点总结如下：</p>
<ul>
<li>兼容统一发起入口和业务场景触发</li>
<li>常用的审批事项要方便找到</li>
<li>有统一汇总的审批管理页面</li>
</ul>
<p>角色2：审批人</p>
<p>审批人在流程中需要完成的主要是决策性的工作，因此在审批人的视角，内容和操作都应该尽量精简：</p>
<ul>
<li>只看到最重要的信息，避免信息过多影响判断</li>
<li>只进行必要操作，不能有过多选择或过多输入，影响决策效率</li>
<li>统一的页面进行审批操作和管理</li>
<li>需要有审批历史，以便追溯</li>
</ul>
<p><strong>二. 内容</strong> </p>
<p>\1. 提炼最小集合</p>
<p>根据审批事项的不同，需要流转的内容也是不同的。对于审批流程的设计来说，需要在实际业务中提炼出最核心的内容，一则可以减轻发起人的工作负担（发起一个审批要填一堆的资料相信没人会开心），二则可以提高决策的准确性和效率。</p>
<p>例如一个请假审批流程，核心就是请假时间、事由和请假类型；而一个立项投决的审批，则需要重点展示立项会的表决结果，同时还需要把会议记录做为附件带上，以便在必要时可以查看，在交互上，这里同样需要注意内容的归类、收纳。</p>
<p>设计要点总结如下：</p>
<ul>
<li>内容尽可能精炼</li>
<li>有些内容是必要的，但系统可以自行获取就不要让发起人再输入一遍</li>
<li>预置常用的内容，用选择的方式替代输入的方式，同时也提高了内容的规范性</li>
</ul>
<p>\2. 查看和修改</p>
<p>在审批的过程中，有时候需要让不同的审批人查看不同的内容，且限定有些人有修改权限而有些人只有只读权限，这都会在后面的“权限”里总结。</p>
<p>三. 流程 1. 自主选定审批人流程</p>
<p>这是一种比较轻量、灵活的审批流程形式，适用于公司规模不大、流程没有标准化的情况。要点是发起人发起一个审批事项并提交时，需要自行选择下一个环节的审批人。而下一个环节的审批人审批通过后，可以选择继续流转到再下一个人去审批，或者结束这个流程。</p>
<p>\2. 串行流程</p>
<p>串行流程就是每一个审批环节的人审批通过后，才会进入到下一个环节。每个环节的驳回，可以根据业务需要，设计成驳回到发起人、驳回到上一个环节或驳回到指定环节重新审批，或兼而有之，做为选项供审批人选择。</p>
<p><img src="https://www.zhidieyun.com/files/8/9/cf/4d112748a503126322ceba146e01fa2ba0d8cf98.jpg" alt="img"></p>
<p>\3. 并行流程</p>
<p>并行流程是一个审批环节需要几个人或角色审批通过才算通过，可以有以下两种方式：</p>
<ul>
<li>任意一个人审批通过即进入下一环节</li>
<li>必须所有人审批通过才进入下一环节</li>
</ul>
<p>上述第一个方式比较好理解，第二个方式和串行流程容易混淆，即同样是要多个人审批，到底是一个接一个、还是同时通过才算通过？到底用哪种方式，区别是审批人是不是同一个级别，并行的方式其实类似于同级别的会签，而串行方式适合有上下层级关系的情况。</p>
<p>并行流程的驳回则相对简单，一般是设计成有一个人驳回则该环节即算驳回。</p>
<p><img src="https://www.zhidieyun.com/files/e/8/e1/f831f19d79550958d747bd9edd5c21eb608ce18e.jpg" alt="img"></p>
<p>\4. 条件触发流程</p>
<p>条件触发流程在审批工作流中也比较常见，设计上就是某个审批环节要由谁/或哪个角色审批，需要取决于条件判断。例如金额低于1万元由财务总监审批通过后即结束，金额在1万元以上则由副总裁审批通过后即结束。</p>
<p><img src="https://www.zhidieyun.com/files/b/e/07/b12119d73c458a39d9bca9529976ca144f5507eb.png" alt="img"></p>
<p>\5. 混合流程</p>
<p>混合流程顾名思义就是混合了以上几种流程，还是以上述金额审批为例，我们修改成：金额低于1万元的，由财务审批通过后即结束；金额在1万元到10万元的，需要先由财务审批，之后交由副总裁审批通过后即结束；金额高于10万元的，需要由董事长和总裁一同审批通过后才结束。</p>
<p><img src="https://www.zhidieyun.com/files/5/e/ac/2d12b9b1348fc3839de80149be59add7b511ace5.jpg" alt="img"></p>
<p><strong>四. 动作</strong> </p>
<p>\1. 通过</p>
<p>通过动作由审批人操作，是否需要输入通过原因、通过原因是否必填需要根据实际业务情况决定。要点总结如下：</p>
<ul>
<li>简单申请不需要填写通过原因，或者原因选填</li>
<li>通过原因需要填的话，可用于反馈或激励发起人的情况</li>
</ul>
<p>\2. 驳回修改</p>
<p>驳回修改动作由审批人操作，和通过不同，为了让发起人知道如何修改，驳回原因一般需要设定成必填项，否则发起人或上一个审批环节的人不知道为何被驳回、以及要如何修改。</p>
<p>驳回修改可根据业务需要，在以下逻辑中选择：</p>
<ul>
<li>驳回到发起人</li>
<li>驳回上一环节</li>
<li>驳回到选定的之前的某个审批环节</li>
</ul>
<p>\3. 重新提交</p>
<p>重新提交由发起人操作，和驳回修改是一一对应的。设计上要注意，审批人审批重新提交的内容时，需要附带上一次驳回修改的原因。</p>
<p>\4. 取消</p>
<p>取消动作可选，一般来说是发起人取消，而不是审批人取消，原因如下：</p>
<ul>
<li>审批人只关心一个审批事务过来后，判断并决策是通过还是驳回</li>
<li>取消和驳回含义容易混淆，区分不开</li>
</ul>
<p>在设计上，我们还可以做到发起人是否可取消可由配置项进行配置。</p>
<p><strong>五. 权限</strong></p>
<p>权限的控制贯穿在审批流程的方方面面，上述的角色、内容、流程和动作都会涉及到权限的控制。权限体系的设计是一个大工程，在审批流程中，采用基于角色的访问控制体系（RBAC）是一个不错的选择：</p>
<p>“基于角色的访问控制体系，包括用户、角色、目标、操作、许可权五个基本数据元素，每个角色至少具备一个权限，每个用户至少扮演一个角色，可以对完全不同的角色分配完全相同的访问权限，用户和角色是多对多的关系。”</p>
<p>设计要点总结如下：</p>
<ul>
<li>操作和许可权内容，可区分为功能权限和数据权限</li>
<li>什么人可以发起什么审批，由功能权限控制</li>
<li>什么人/角色在整个审批流程中可见什么数据，由数据权限控制</li>
<li>什么人/角色可以审批什么环节，由独立的审批配置控制，下一节会进行阐述</li>
</ul>
<p>关于权限可以参考笔者另一个篇文章：面向中小企业SaaS的权限管理系统</p>
<p><strong>六. 配置和扩展性</strong></p>
<p>审批工作流的配置灵活度和开发复杂度成反比，具体要灵活到什么程度，需要由业务需求决定。一般针对公司开发的中后台系统，灵活性相对较少，而面向多个公司的商业化的系统，则灵活性要求大大提高。配置的灵活性体现在以下方面：</p>
<ul>
<li>审批流程的类型可修改</li>
<li>具体的审批环节可增删改</li>
<li>各个环节审批人/角色可配置</li>
<li>审批相关的权限可变更</li>
</ul>
<p><strong>七. 效率</strong></p>
<p>工作流的核心目标是提高企业运行效率，如果线上审批流程效率还不如原来的纸质操作，那这个流程的设计就是失败的，也失去了意义。因此，在完成整个审批流程的设计之后，我们还需要花大精力对流程的效率进行审视和优化。对于审批流程效率的提升，总结的经验点如下：</p>
<ul>
<li>审批的操作尽可能精简，且操作含义明确</li>
<li>只要求输入必要的表单</li>
<li>待审批事项及时通知到审批人</li>
<li>审批进展及时通知发起人</li>
<li>发起人可选择主动催促审批人</li>
<li>做好下一步操作的引导</li>
</ul>
<p><strong>总结</strong></p>
<p>审批流程是中后台工作流的基础应用，我们在设计的过程中，把握的核心要点是“提高效率，规范管理”，在设计过程中要时时回头审视，以免脱离了这个最重要的目标。</p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2021-09-16T03:42:31.000Z">2021-09-16</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    28 分钟 读完 (大约 4211 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2021/09/16/hexo%E6%90%AD%E5%BB%BA%E6%B5%81%E7%A8%8B/">hexo搭建流程</a>
            
        </h1>
        <div class="content">
            <h1 id="使用hexo-github搭建免费个人博客详细教程"><a href="#使用hexo-github搭建免费个人博客详细教程" class="headerlink" title="使用hexo+github搭建免费个人博客详细教程"></a><a href="https://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html" target="_blank" rel="noopener">使用hexo+github搭建免费个人博客详细教程</a></h1><p>目录</p>
<ul>
<li>前言<ul>
<li><a href="https://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html#准备工作" target="_blank" rel="noopener">准备工作</a></li>
</ul>
</li>
<li>搭建github博客<ul>
<li><a href="https://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html#创建仓库" target="_blank" rel="noopener">创建仓库</a></li>
<li><a href="https://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html#绑定域名" target="_blank" rel="noopener">绑定域名</a></li>
</ul>
</li>
<li>配置SSH key<ul>
<li><a href="https://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html#测试是否成功" target="_blank" rel="noopener">测试是否成功</a></li>
</ul>
</li>
<li>使用hexo写博客<ul>
<li><a href="https://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html#hexo简介" target="_blank" rel="noopener">hexo简介</a></li>
<li><a href="https://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html#原理" target="_blank" rel="noopener">原理</a></li>
<li><a href="https://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html#注意事项" target="_blank" rel="noopener">注意事项</a></li>
<li><a href="https://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html#安装" target="_blank" rel="noopener">安装</a></li>
<li><a href="https://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html#初始化" target="_blank" rel="noopener">初始化</a></li>
<li><a href="https://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html#修改主题" target="_blank" rel="noopener">修改主题</a></li>
<li><a href="https://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html#上传之前" target="_blank" rel="noopener">上传之前</a></li>
<li><a href="https://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html#上传到github" target="_blank" rel="noopener">上传到github</a></li>
<li><a href="https://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html#保留cname、readmemd等文件" target="_blank" rel="noopener">保留CNAME、README.md等文件</a></li>
<li><a href="https://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html#常用hexo命令" target="_blank" rel="noopener">常用hexo命令</a></li>
<li><a href="https://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html#_configyml" target="_blank" rel="noopener">_config.yml</a></li>
<li>写博客<ul>
<li><a href="https://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html#写博客工具" target="_blank" rel="noopener">写博客工具</a></li>
<li><a href="https://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html#如何让博文列表不显示全部内容" target="_blank" rel="noopener">如何让博文列表不显示全部内容</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="https://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html#最终效果" target="_blank" rel="noopener">最终效果</a></li>
<li><a href="https://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html#参考" target="_blank" rel="noopener">参考</a></li>
</ul>
<p>本文目录（注意无法点击）：</p>
<p><img src="https://images2015.cnblogs.com/blog/352797/201608/352797-20160823212114605-1611269979.jpg" alt="img"></p>
<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>体验更加排版请访问原文链接：<a href="http://blog.liuxianan.com/build-blog-website-by-hexo-github.html" target="_blank" rel="noopener">http://blog.liuxianan.com/build-blog-website-by-hexo-github.html</a></p>
<p>使用github pages服务搭建博客的好处有：</p>
<ol>
<li>全是静态文件，访问速度快；</li>
<li>免费方便，不用花一分钱就可以搭建一个自由的个人博客，不需要服务器不需要后台；</li>
<li>可以随意绑定自己的域名，不仔细看的话根本看不出来你的网站是基于github的；</li>
<li>数据绝对安全，基于github的版本管理，想恢复到哪个历史版本都行；</li>
<li>博客内容可以轻松打包、转移、发布到其它平台；</li>
<li>等等；</li>
</ol>
<h2 id="1-1-准备工作"><a href="#1-1-准备工作" class="headerlink" title="1.1. 准备工作"></a>1.1. 准备工作</h2><p>在开始一切之前，你必须已经：</p>
<ul>
<li>有一个github账号，没有的话去注册一个；</li>
<li>安装了node.js、npm，并了解相关基础知识；</li>
<li>安装了git for windows（或者其它git客户端）</li>
</ul>
<p>本文所使用的环境：</p>
<ul>
<li>Windows8.1</li>
<li><a href="mailto:node.js@5.5.0" target="_blank" rel="noopener">node.js@5.5.0</a></li>
<li><a href="mailto:git@1.9.2" target="_blank" rel="noopener">git@1.9.2</a></li>
<li><a href="mailto:hexo@3.2.2" target="_blank" rel="noopener">hexo@3.2.2</a></li>
</ul>
<h1 id="搭建github博客"><a href="#搭建github博客" class="headerlink" title="搭建github博客"></a>搭建github博客</h1><h2 id="2-1-创建仓库"><a href="#2-1-创建仓库" class="headerlink" title="2.1. 创建仓库"></a>2.1. 创建仓库</h2><p>新建一个名为<code>你的用户名.github.io</code>的仓库，比如说，如果你的github用户名是test，那么你就新建<code>test.github.io</code>的仓库（必须是你的用户名，其它名称无效），将来你的网站访问地址就是 <a href="http://test.github.io/" target="_blank" rel="noopener">http://test.github.io</a> 了，是不是很方便？</p>
<p>由此可见，每一个github账户最多只能创建一个这样可以直接使用域名访问的仓库。</p>
<p>几个注意的地方：</p>
<ol>
<li>注册的邮箱一定要验证，否则不会成功；</li>
<li>仓库名字必须是：<code>username.github.io</code>，其中<code>username</code>是你的用户名；</li>
<li>仓库创建成功不会立即生效，需要过一段时间，大概10-30分钟，或者更久，我的等了半个小时才生效；</li>
</ol>
<p>创建成功后，默认会在你这个仓库里生成一些示例页面，以后你的网站所有代码都是放在这个仓库里啦。</p>
<h2 id="2-2-绑定域名"><a href="#2-2-绑定域名" class="headerlink" title="2.2. 绑定域名"></a>2.2. 绑定域名</h2><p>当然，你不绑定域名肯定也是可以的，就用默认的 <code>xxx.github.io</code> 来访问，如果你想更个性一点，想拥有一个属于自己的域名，那也是OK的。</p>
<p>首先你要注册一个域名，域名注册以前总是推荐去<code>godaddy</code>，现在觉得其实国内的阿里云也挺不错的，价格也不贵，毕竟是大公司，放心！</p>
<p>绑定域名分2种情况：带www和不带www的。</p>
<p>域名配置最常见有2种方式，CNAME和A记录，CNAME填写域名，A记录填写IP，由于不带www方式只能采用A记录，所以必须先ping一下<code>你的用户名.github.io</code>的IP，然后到你的域名DNS设置页，将A记录指向你ping出来的IP，将CNAME指向<code>你的用户名.github.io</code>，这样可以保证无论是否添加www都可以访问，如下：</p>
<p><img src="http://image.liuxianan.com/201608/20160823_191336_238_8683.png" alt="img"></p>
<p>然后到你的github项目根目录新建一个名为CNAME的文件（无后缀），里面填写你的域名，加不加www看你自己喜好，因为经测试：</p>
<ul>
<li>如果你填写的是没有www的，比如 mygit.me，那么无论是访问 <a href="http://www.mygit.me/" target="_blank" rel="noopener">http://www.mygit.me</a> 还是 <a href="http://mygit.me/" target="_blank" rel="noopener">http://mygit.me</a> ，都会自动跳转到 <a href="http://mygit.me/" target="_blank" rel="noopener">http://mygit.me</a></li>
<li>如果你填写的是带www的，比如 <a href="http://www.mygit.me" target="_blank" rel="noopener">www.mygit.me</a> ，那么无论是访问 <a href="http://www.mygit.me/" target="_blank" rel="noopener">http://www.mygit.me</a> 还是 <a href="http://mygit.me/" target="_blank" rel="noopener">http://mygit.me</a> ，都会自动跳转到 <a href="http://www.mygit.me/" target="_blank" rel="noopener">http://www.mygit.me</a></li>
<li>如果你填写的是其它子域名，比如 abc.mygit.me，那么访问 <a href="http://abc.mygit.me/" target="_blank" rel="noopener">http://abc.mygit.me</a> 没问题，但是访问 <a href="http://mygit.me/" target="_blank" rel="noopener">http://mygit.me</a> ，不会自动跳转到 <a href="http://abc.mygit.me/" target="_blank" rel="noopener">http://abc.mygit.me</a></li>
</ul>
<p>另外说一句，在你绑定了新域名之后，原来的<code>你的用户名.github.io</code>并没有失效，而是会自动跳转到你的新域名。</p>
<h1 id="配置SSH-key"><a href="#配置SSH-key" class="headerlink" title="配置SSH key"></a>配置SSH key</h1><p>为什么要配置这个呢？因为你提交代码肯定要拥有你的github权限才可以，但是直接使用用户名和密码太不安全了，所以我们使用ssh key来解决本地和服务器的连接问题。</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">$ <span class="hljs-built_in">cd</span> ~/. ssh <span class="hljs-comment">#检查本机已存在的ssh密钥</span></span></pre></td></tr></table></figure>

<p>如果提示：No such file or directory 说明你是第一次使用git。</p>
<figure class="highlight excel hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">ssh-keygen -<span class="hljs-built_in">t</span> rsa -C <span class="hljs-string">"邮件地址"</span></span></pre></td></tr></table></figure>

<p>然后连续3次回车，最终会生成一个文件在用户目录下，打开用户目录，找到<code>.ssh\id_rsa.pub</code>文件，记事本打开并复制里面的内容，打开你的github主页，进入个人设置 -&gt; SSH and GPG keys -&gt; New SSH key：</p>
<p><img src="http://image.liuxianan.com/201608/20160818_143914_495_9084.png" alt="img"></p>
<p>将刚复制的内容粘贴到key那里，title随便填，保存。</p>
<h2 id="3-1-测试是否成功"><a href="#3-1-测试是否成功" class="headerlink" title="3.1. 测试是否成功"></a>3.1. 测试是否成功</h2><figure class="highlight elixir hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-variable">$ </span>ssh -T git<span class="hljs-variable">@github</span>.com <span class="hljs-comment"># 注意邮箱地址不用改</span></span></pre></td></tr></table></figure>

<p>如果提示<code>Are you sure you want to continue connecting (yes/no)?</code>，输入yes，然后会看到：</p>
<blockquote>
<p>Hi liuxianan! You’ve successfully authenticated, but GitHub does not provide shell access.</p>
</blockquote>
<p>看到这个信息说明SSH已配置成功！</p>
<p>此时你还需要配置：</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">$ git <span class="hljs-keyword">config</span> --<span class="hljs-keyword">global</span> user<span class="hljs-variable">.name</span> <span class="hljs-string">"liuxianan"</span><span class="hljs-comment">// 你的github用户名，非昵称</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">$ git <span class="hljs-keyword">config</span> --<span class="hljs-keyword">global</span> user<span class="hljs-variable">.email</span>  <span class="hljs-string">"xxx@qq.com"</span><span class="hljs-comment">// 填写你的github注册邮箱</span></span></pre></td></tr></table></figure>

<p>具体这个配置是干嘛的我没仔细深究。</p>
<h1 id="使用hexo写博客"><a href="#使用hexo写博客" class="headerlink" title="使用hexo写博客"></a>使用hexo写博客</h1><h2 id="4-1-hexo简介"><a href="#4-1-hexo简介" class="headerlink" title="4.1. hexo简介"></a>4.1. hexo简介</h2><p>Hexo是一个简单、快速、强大的基于 Github Pages 的博客发布工具，支持Markdown格式，有众多优秀插件和主题。</p>
<p>官网： <a href="http://hexo.io/" target="_blank" rel="noopener">http://hexo.io</a><br>github: <a href="https://github.com/hexojs/hexo" target="_blank" rel="noopener">https://github.com/hexojs/hexo</a></p>
<h2 id="4-2-原理"><a href="#4-2-原理" class="headerlink" title="4.2. 原理"></a>4.2. 原理</h2><p>由于github pages存放的都是静态文件，博客存放的不只是文章内容，还有文章列表、分类、标签、翻页等动态内容，假如每次写完一篇文章都要手动更新博文目录和相关链接信息，相信谁都会疯掉，所以hexo所做的就是将这些md文件都放在本地，每次写完文章后调用写好的命令来批量完成相关页面的生成，然后再将有改动的页面提交到github。</p>
<h2 id="4-3-注意事项"><a href="#4-3-注意事项" class="headerlink" title="4.3. 注意事项"></a>4.3. 注意事项</h2><p>安装之前先来说几个注意事项：</p>
<ol>
<li>很多命令既可以用Windows的cmd来完成，也可以使用git bash来完成，但是部分命令会有一些问题，为避免不必要的问题，建议全部使用git bash来执行；</li>
<li>hexo不同版本差别比较大，网上很多文章的配置信息都是基于2.x的，所以注意不要被误导；</li>
<li>hexo有2种<code>_config.yml</code>文件，一个是根目录下的全局的<code>_config.yml</code>，一个是各个<code>theme</code>下的；</li>
</ol>
<h2 id="4-4-安装"><a href="#4-4-安装" class="headerlink" title="4.4. 安装"></a>4.4. 安装</h2><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">$ npm install -g hexo</span></pre></td></tr></table></figure>

<h2 id="4-5-初始化"><a href="#4-5-初始化" class="headerlink" title="4.5. 初始化"></a>4.5. 初始化</h2><p>在电脑的某个地方新建一个名为hexo的文件夹（名字可以随便取），比如我的是<code>F:\Workspaces\hexo</code>，由于这个文件夹将来就作为你存放代码的地方，所以最好不要随便放。</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">$ <span class="hljs-built_in">cd</span> /f/Workspaces/hexo/</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">$ hexo init</span></pre></td></tr></table></figure>

<p>hexo会自动下载一些文件到这个目录，包括node_modules，目录结构如下图：</p>
<p><img src="http://image.liuxianan.com/201608/20160818_115922_773_1148.png" alt="img"></p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">$ hexo g <span class="hljs-comment"># 生成</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">$ hexo s <span class="hljs-comment"># 启动服务</span></span></pre></td></tr></table></figure>

<p>执行以上命令之后，hexo就会在public文件夹生成相关html文件，这些文件将来都是要提交到github去的：</p>
<p><img src="http://image.liuxianan.com/201608/20160818_120700_028_2426.png" alt="img"></p>
<p><code>hexo s</code>是开启本地预览服务，打开浏览器访问 <a href="http://localhost:4000/" target="_blank" rel="noopener">http://localhost:4000</a> 即可看到内容，很多人会碰到浏览器一直在转圈但是就是加载不出来的问题，一般情况下是因为端口占用的缘故，因为4000这个端口太常见了，解决端口冲突问题请参考这篇文章：</p>
<p><a href="http://blog.liuxianan.com/windows-port-bind.html" target="_blank" rel="noopener">http://blog.liuxianan.com/windows-port-bind.html</a></p>
<p>第一次初始化的时候hexo已经帮我们写了一篇名为 Hello World 的文章，默认的主题比较丑，打开时就是这个样子：</p>
<p><img src="http://image.liuxianan.com/201608/20160818_132443_202_6848.png" alt="img"></p>
<h2 id="4-6-修改主题"><a href="#4-6-修改主题" class="headerlink" title="4.6. 修改主题"></a>4.6. 修改主题</h2><p>既然默认主题很丑，那我们别的不做，首先来替换一个好看点的主题。这是 <a href="https://hexo.io/themes/" target="_blank" rel="noopener">官方主题</a>。</p>
<p>个人比较喜欢的2个主题：<a href="https://github.com/pinggod/hexo-theme-jekyll" target="_blank" rel="noopener">hexo-theme-jekyll</a> 和 <a href="https://github.com/litten/hexo-theme-yilia" target="_blank" rel="noopener">hexo-theme-yilia</a>。</p>
<p>首先下载这个主题：</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">$ <span class="hljs-built_in">cd</span> /f/Workspaces/hexo/</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">$ git <span class="hljs-built_in">clone</span> https://github.com/litten/hexo-theme-yilia.git themes/yilia</span></pre></td></tr></table></figure>

<p>下载后的主题都在这里：</p>
<p><img src="http://image.liuxianan.com/201608/20160818_134500_245_0912.png" alt="img"></p>
<p>修改<code>_config.yml</code>中的<code>theme: landscape</code>改为<code>theme: yilia</code>，然后重新执行<code>hexo g</code>来重新生成。</p>
<p>如果出现一些莫名其妙的问题，可以先执行<code>hexo clean</code>来清理一下public的内容，然后再来重新生成和发布。</p>
<h2 id="4-7-上传之前"><a href="#4-7-上传之前" class="headerlink" title="4.7. 上传之前"></a>4.7. 上传之前</h2><p>在上传代码到github之前，一定要记得先把你以前所有代码下载下来（虽然github有版本管理，但备份一下总是好的），因为从hexo提交代码时会把你以前的所有代码都删掉。</p>
<h2 id="4-8-上传到github"><a href="#4-8-上传到github" class="headerlink" title="4.8. 上传到github"></a>4.8. 上传到github</h2><p>如果你一切都配置好了，发布上传很容易，一句<code>hexo d</code>就搞定，当然关键还是你要把所有东西配置好。</p>
<p>首先，<code>ssh key</code>肯定要配置好。</p>
<p>其次，配置<code>_config.yml</code>中有关deploy的部分：</p>
<p>正确写法：</p>
<figure class="highlight less hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-attribute">deploy</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">  <span class="hljs-attribute">type</span>: git</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">  <span class="hljs-attribute">repository</span>: git<span class="hljs-variable">@github</span>.<span class="hljs-attribute">com</span>:liuxianan/liuxianan.github.io.git</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">  <span class="hljs-attribute">branch</span>: master</span></pre></td></tr></table></figure>

<p>错误写法：</p>
<figure class="highlight less hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-attribute">deploy</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">  <span class="hljs-attribute">type</span>: github</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">  <span class="hljs-attribute">repository</span>: <span class="hljs-attribute">https</span>:<span class="hljs-comment">//github.com/liuxianan/liuxianan.github.io.git</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">  <span class="hljs-attribute">branch</span>: master</span></pre></td></tr></table></figure>

<p>后面一种写法是hexo2.x的写法，现在已经不行了，无论是哪种写法，此时直接执行<code>hexo d</code>的话一般会报如下错误：</p>
<figure class="highlight groovy hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">Deployer not <span class="hljs-string">found:</span> github 或者 Deployer not <span class="hljs-string">found:</span> git</span></pre></td></tr></table></figure>

<p>原因是还需要安装一个插件：</p>
<figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">npm <span class="hljs-keyword">install</span> hexo-deployer-git <span class="hljs-comment">--save</span></span></pre></td></tr></table></figure>

<p>其它命令不确定，部署这个命令一定要用git bash，否则会提示<code>Permission denied (publickey).</code></p>
<p>打开你的git bash，输入<code>hexo d</code>就会将本次有改动的代码全部提交，没有改动的不会：</p>
<p><img src="http://image.liuxianan.com/201608/20160818_140441_769_5024.png" alt="img"></p>
<h2 id="4-9-保留CNAME、README-md等文件"><a href="#4-9-保留CNAME、README-md等文件" class="headerlink" title="4.9. 保留CNAME、README.md等文件"></a>4.9. 保留CNAME、README.md等文件</h2><p>提交之后网页上一看，发现以前其它代码都没了，此时不要慌，一些非md文件可以把他们放到source文件夹下，这里的所有文件都会原样复制（除了md文件）到public目录的：</p>
<p><img src="http://image.liuxianan.com/201608/20160818_141037_580_8035.png" alt="img"></p>
<p>由于hexo默认会把所有md文件都转换成html，包括README.md，所有需要每次生成之后、上传之前，手动将README.md复制到public目录，并删除README.html。</p>
<h2 id="4-10-常用hexo命令"><a href="#4-10-常用hexo命令" class="headerlink" title="4.10. 常用hexo命令"></a>4.10. 常用hexo命令</h2><p>常见命令</p>
<figure class="highlight routeros hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">hexo new <span class="hljs-string">"postName"</span> #新建文章</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">hexo new<span class="hljs-built_in"> page </span><span class="hljs-string">"pageName"</span> #新建页面</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">hexo generate #生成静态页面至public目录</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">hexo<span class="hljs-built_in"> server </span>#开启预览访问端口（默认端口4000，<span class="hljs-string">'ctrl + c'</span>关闭server）</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">hexo deploy #部署到GitHub</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">hexo help  # 查看帮助</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">hexo version  #查看Hexo的版本</span></pre></td></tr></table></figure>

<p>缩写：</p>
<figure class="highlight routeros hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">hexo n == hexo new</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">hexo g == hexo generate</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">hexo s == hexo server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">hexo d == hexo deploy</span></pre></td></tr></table></figure>

<p>组合命令：</p>
<figure class="highlight nginx hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-attribute">hexo</span> s -g <span class="hljs-comment">#生成并本地预览</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">hexo d -g <span class="hljs-comment">#生成并上传</span></span></pre></td></tr></table></figure>

<h2 id="4-11-config-yml"><a href="#4-11-config-yml" class="headerlink" title="4.11. _config.yml"></a>4.11. _config.yml</h2><p>这里面都是一些全局配置，每个参数的意思都比较简单明了，所以就不作详细介绍了。</p>
<p>需要特别注意的地方是，冒号后面必须有一个空格，否则可能会出问题。</p>
<h2 id="4-12-写博客"><a href="#4-12-写博客" class="headerlink" title="4.12. 写博客"></a>4.12. 写博客</h2><p>定位到我们的hexo根目录，执行命令：</p>
<figure class="highlight actionscript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">hexo <span class="hljs-keyword">new</span> <span class="hljs-string">'my-first-blog'</span></span></pre></td></tr></table></figure>

<p>hexo会帮我们在<code>_posts</code>下生成相关md文件：</p>
<p><img src="http://image.liuxianan.com/201608/20160823_183047_352_1475.png" alt="img"></p>
<p>我们只需要打开这个文件就可以开始写博客了，默认生成如下内容：</p>
<p><img src="http://image.liuxianan.com/201608/20160823_183325_470_9306.png" alt="img"></p>
<p>当然你也可以直接自己新建md文件，用这个命令的好处是帮我们自动生成了时间。</p>
<p>一般完整格式如下：</p>
<figure class="highlight markdown hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">---</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">title: postName #文章页面上的显示名称，一般是中文</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">date: 2013-12-02 15:30:16 #文章生成时间，一般不改，当然也可以任意修改</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">categories: 默认分类 #分类</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">tags: [tag1,tag2,tag3] #文章标签，可空，多标签请用格式，注意:后面有个空格</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">description: 附加一段文章摘要，字数最好在140字以内，会出现在meta的description里面</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">---</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">以下是正文</span></pre></td></tr></table></figure>

<p>那么<code>hexo new page &#39;postName&#39;</code>命令和<code>hexo new &#39;postName&#39;</code>有什么区别呢？</p>
<figure class="highlight routeros hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">hexo new<span class="hljs-built_in"> page </span><span class="hljs-string">"my-second-blog"</span></span></pre></td></tr></table></figure>

<p>生成如下：</p>
<p><img src="http://image.liuxianan.com/201608/20160823_184852_854_6502.png" alt="img"></p>
<p>最终部署时生成：<code>hexo\public\my-second-blog\index.html</code>，但是它不会作为文章出现在博文目录。</p>
<h3 id="4-12-1-写博客工具"><a href="#4-12-1-写博客工具" class="headerlink" title="4.12.1. 写博客工具"></a>4.12.1. 写博客工具</h3><p>那么用什么工具写博客呢？这个我还没去找，以前自己使用editor.md简单弄了个，大家有好用的hexo写博客工具可以推荐个。</p>
<h3 id="4-12-2-如何让博文列表不显示全部内容"><a href="#4-12-2-如何让博文列表不显示全部内容" class="headerlink" title="4.12.2. 如何让博文列表不显示全部内容"></a>4.12.2. 如何让博文列表不显示全部内容</h3><p>默认情况下，生成的博文目录会显示全部的文章内容，如何设置文章摘要的长度呢？</p>
<p>答案是在合适的位置加上<code>&lt;!--more--&gt;</code>即可，例如：</p>
<figure class="highlight markdown hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-section"># 前言</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">使用github pages服务搭建博客的好处有：</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-bullet">1. </span>全是静态文件，访问速度快；</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-bullet">2. </span>免费方便，不用花一分钱就可以搭建一个自由的个人博客，不需要服务器不需要后台；</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-bullet">3. </span>可以随意绑定自己的域名，不仔细看的话根本看不出来你的网站是基于github的；</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-xml"><span class="hljs-comment">&lt;!--more--&gt;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-bullet">4. </span>数据绝对安全，基于github的版本管理，想恢复到哪个历史版本都行；</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-bullet">5. </span>博客内容可以轻松打包、转移、发布到其它平台；</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-bullet">6. </span>等等；</span></pre></td></tr></table></figure>

<p>最终效果：</p>
<p><img src="http://image.liuxianan.com/201608/20160823_184633_653_1893.png" alt="img"></p>
<h1 id="最终效果"><a href="#最终效果" class="headerlink" title="最终效果"></a>最终效果</h1><p>可以访问我的git博客来查看效果： <a href="http://mygit.me/" target="_blank" rel="noopener">http://mygit.me</a></p>
<p>不过呢，其实这个博客我只是拿来玩一玩的，没打算真的把它当博客，因为我已经有一个自己的博客了，哈哈！正因如此，本文仅限入门学习，关于hexo搭建个人博客的更高级玩法大家可以另找教程。</p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a href="http://www.cnblogs.com/zhcncn/p/4097881.html" target="_blank" rel="noopener">http://www.cnblogs.com/zhcncn/p/4097881.html</a></p>
<p><a href="http://www.jianshu.com/p/05289a4bc8b2" target="_blank" rel="noopener">http://www.jianshu.com/p/05289a4bc8b2</a></p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2021-09-16T03:07:54.000Z">2021-09-16</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    33 分钟 读完 (大约 4955 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2021/09/16/%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B%E5%BC%95%E6%93%8E/">工作流程引擎</a>
            
        </h1>
        <div class="content">
            <h1 id="0、为什么要使用工作流引擎"><a href="#0、为什么要使用工作流引擎" class="headerlink" title="0、为什么要使用工作流引擎"></a>0、为什么要使用工作流引擎</h1><p>假定我们有一个支付订单状态需要维护，它的状态图如下：</p>
<p>它的状态跃迁自左向右，清晰名了，而且没有<strong>处理角色</strong>的概念，此时我们使用代码控制好状态流转即可，无需使用框架。</p>
<p><img src="https://static001.geekbang.org/infoq/62/621f65d62a2689c09d894e8a33371d3f.png" alt="img"></p>
<p>再来看另外一个场景，假定我们有一个企业内部采购订单，它的状态图如下：</p>
<p><img src="https://static001.geekbang.org/infoq/23/233e0bfcd3dd3f5d5cc30741840af6bb.png" alt="img"></p>
<p>这个采购订单的状态复杂多变，状态的转换不稳定性很强，随时有可能增加新的状态；而且不同状态的处理人也是不同的，存在权限管理功能，若此时我们仍然使用一个状态字段来维持状态变更，无疑会困难重重。</p>
<p>工作流引擎就是为了解决这类问题而生的，我们可以观察当前实体(如支付订单、采购订单)是否具有如下特性，由此来确定是否需要引入工作流引擎。</p>
<ol>
<li>状态的个数及其稳定性，<strong>个数多且不稳定，适合使用工作流引擎</strong>。</li>
<li>每个状态的处理人，<strong>处理人角色多且不稳定，适合使用工作流引擎</strong>。</li>
</ol>
<p><strong>工作流引擎</strong>实际上是放大了状态管理的功能，它根据既有流程图（基于 BPMN2.0 规范）的指示，指定每一次状态跃迁的处理角色，在状态变更时<strong>持久化评论、表单、附件等数据，保存了完整处理轨迹</strong>。</p>
<p>工作流引擎最常见用于审批流程中，现在一线互联网公司也开始使用，并有快速推广的趋势，复杂繁多的业务流程如果采用 if else 实现那将是崩溃的，代码不可维护，业务流程在代码中可读性很差，所以高人设计了业务流程模型图示 BPMN2.0 规范，我们要做到就是把业务场景抽象为标准流程图，把流程图丢到流程引擎中按流程定义约定逐步流转，很显然扩展性和业务可描述性会好很多，所以工作流引擎主要用于解决复杂的业务，目前经常被提起的中台系统抽象业务为服务，也涉及大量智能的业务流程引擎做支撑。</p>
<h1 id="1、工作流概念"><a href="#1、工作流概念" class="headerlink" title="1、工作流概念"></a>1、工作流概念</h1><h3 id="1-1-流程的定义"><a href="#1-1-流程的定义" class="headerlink" title="1.1 流程的定义"></a>1.1 流程的定义</h3><p>从最朴素和最直接的角度看，<strong>我们按照条理和顺序做事情的过程，就是流程</strong>。</p>
<p>流程之父迈克尔.哈默是这样定义的： <strong>流程是把一个或多个输入转化对顾客有价值的输出的活动</strong>。</p>
<p>李.克拉耶夫斯基和拉里.里茨曼在其《运营管理–流程与价值链》第 7 版中是这样定义的：</p>
<p><strong>流程是一种或一组活动，这些活动利用一个或多个输入要素，对起进行转换并 3 使其增值，向顾客提供一种或多种产出。</strong></p>
<p>我们的理解是：</p>
<p><strong>流程就是一组活动按照一定的顺序组成的序列流，其顺序可能是串行的、并行的，或者两者的组合模式，例如面包制作流程中的“混合原料”，“揉面醒发”，“整形”，“烘烤”等活动。</strong></p>
<p>综上所述，流程一般具备六个要素：输入、活动、活动间的相互作用、输出、流程的服务对象和价值。</p>
<p>如下图所示：</p>
<p><img src="https://static001.geekbang.org/infoq/ab/abe7c8b7378220460199255858520e3a.png" alt="img"></p>
<h3 id="1-2-工作流参考模型"><a href="#1-2-工作流参考模型" class="headerlink" title="1.2 工作流参考模型"></a>1.2 工作流参考模型</h3><p>1993 年，工作流管理联盟（WfMC）成立，接着发布了著名的工作流参考模型（如下图所示）及接口规范。2002 年 10 月 25 日，WFMC 发布了 XPDL 1.0 规范(WFMC-TC-1025)、规范流程定义的 XML 描述形式。</p>
<p><img src="https://static001.geekbang.org/infoq/33/331c18d721a1ef650d6a4495c2259537.png" alt="img"></p>
<p>WFMC 定义的 5 类接口的功能：</p>
<ul>
<li>接口 1：过程定义输入输出接口，工作流服务和工作流建模工具间接口，包括工作流模型的解释和读写操作；</li>
<li>接口 2：客户端函数接口，工作流服务和客户应用之间的接口，这是最主要的接口规范，它约定所有客户方应用与工作流服务之间的功能操作方式；</li>
<li>接口 3：激活应用程序接口，工作流机和直接调用的应用程序之间的直接接口；</li>
<li>接口 4：工作流执行服务之间的互操作接口，工作流系统之间的互操作接口；</li>
<li>接口 5：系统管理与监控接口，工作流服务于工作流管理工具之间的接口；</li>
<li>1.3 主要应用场景</li>
</ul>
<p>一般 OA 都内置有一个轻量级的审批流引擎，适用于办公协同领域。BPM 呢，在中国主要适用于流程化信息化程度较高的制造业、零售业、房地产、金融业和政府事业单位，可以应用在企业战略、运营、管理等从上到下的各个场景。BPM 主要为这些行业中体量较大的公司客户服务。</p>
<h2 id="2、-工作流规范简介"><a href="#2、-工作流规范简介" class="headerlink" title="2、 工作流规范简介"></a>2、 工作流规范简介</h2><p>20 世纪 70 年代中期，工作流出现并运用于办公自动化领域，使流程管理技术第一次有了系统的技术规范。20 世纪 80 年代 初期，工作流伴随着 OA 系统走向商用，但是应用范围有限。至 80 年代后期，OA 系统的研究被群件和工作流管理系统所代替。20 世纪 90 年代以后，相关技术逐渐成熟，工作流管理联盟(WfMC)成立并发布了工作流参考模型。进入 21 世纪， BPM 更进一步发展。SOA 的出现使得流程管理技术从工作流转向业务流，基于此的一系列规范也相应被推出。</p>
<p><img src="https://static001.geekbang.org/infoq/34/34eb02c6898cc2202f81c8dedab4faa6.png" alt="img"></p>
<p>发展到目前，BPMN 规范最完善，现在主流工作流引擎产品，大多基于 BPMN2.0 规范实现的，这里只介绍 BPMN2.0 规范。</p>
<h3 id="2-1-BPMN2-0-规范"><a href="#2-1-BPMN2-0-规范" class="headerlink" title="2.1 BPMN2.0 规范"></a>2.1 BPMN2.0 规范</h3><p>业务流程模型和标记法（<strong>BPMN</strong>, Business Process Model and Notation）<strong>是一套图形化表示法</strong>，用于以图形的方式详细说明各种业务流程。</p>
<p>它最初由业务流程管理倡议组织（BPMI, Business Process Management Initiative）开发，名称为”Business Process Modeling Notation”，即“业务流程建模标记法”。BPMI 于 2005 年与对象管理组织（OMG, Object Management Group）合并。2011 年 1 月 OMG 发布 2.0 版本（时至今日，没人会用 1.0 版本了），同时改为现在的名称。</p>
<p>BPMN2.0 规范的实现，实质上是一个按照特定规范编写的 XML 文件，使用特定的 BPMN 设计器，即可以图形化的形式查看和编辑该文件。<strong>Camunda，Activiti，Flowable 等主流的 java 开源流程引擎，以代码的形式实现了这套图形化表示法，使任务的流转依赖图形，而非具体的实现代码</strong>。</p>
<p><strong>UML vs BPMN</strong></p>
<ul>
<li>UML 和 BPMN 之间唯一的正式关系是 OMG 维护两个开放标准。</li>
<li>UML(统一建模语言)作为一种可视化的建模语言，其中的活动图也适用于流程建模，但其支持深度不够。</li>
<li>BPMN 诞生时间晚于 UML，据称从某种意义上讲，UML Activity Diagrams 是 BPMN 的一个子集，也是 BPMN 的历史前身。</li>
</ul>
<p>BPMN2.0，流程主要涉及的对象：</p>
<p><img src="https://static001.geekbang.org/infoq/db/db8564b38a24e76d60da4abb48de2fb0.png" alt="img"></p>
<p><img src="https://static001.geekbang.org/infoq/bc/bc886931e179223273d6f1f64bbdd9a3.png" alt="img"></p>
<p>如上图所示，BPMN2.0 规范主要包含了三个部分 Activities(活动)、Gateway(网关)、Event(事件)。</p>
<p>下图在线流程设计器，设计的流程图效果如下：</p>
<p><img src="https://static001.geekbang.org/infoq/53/534eb874369ebba60b1985dffc1f83cb.png" alt="img"></p>
<h3 id="2-2-流程技术发展历史"><a href="#2-2-流程技术发展历史" class="headerlink" title="2.2 流程技术发展历史"></a>2.2 流程技术发展历史</h3><p>流程管理思想及方法论的发展，深刻影响着流程技术的发展，而流程技术的发展也反过来促进了流程管理思想的发展，二者相辅相成，互相促进。流程技术的发展大概经理了三个发展阶段：</p>
<ul>
<li><strong>工作流技术阶段</strong></li>
</ul>
<p>工作流技术在以“信息技术驱动的技术流程自动化”管理思想为主导的时代进入了新的热潮。此阶段的主要技术是 OO 技术、Web 1.0 及 ERP、OA 等，而 ERP 及 OA 都是基于工作流技术的应用。</p>
<ul>
<li><strong>BPM 技术阶段</strong></li>
</ul>
<p>在“业务流程为主导的管理思想”时期，业务流程管理系统/套件（BPMS）出现了，BPMS 所要解决的问题是怎么以业务流程为中心全面串联企业的经营活动。要达到这个目标，首先要全面梳理和设计企业的所有业务流程，最终通过 BPMS 进行落地实现。在这个时期，出现了 Web 服务，SOA 和 ESB（企业服务总线）等技术。</p>
<ul>
<li><strong>BPM 治理阶段</strong></li>
</ul>
<p>为了提高 BPM 实施的成功率及投资回报率而引入了一些新的管理思想和技术，这些管理思想及技术终极目标还是围绕 BPM 的。</p>
<p><img src="https://static001.geekbang.org/infoq/39/392f1b19b4ec48d8019b901c33ccccab.png" alt="img"></p>
<p><strong>流程规范、技术进展技术路线图</strong></p>
<h2 id="3、工作流和-BPM-的区别"><a href="#3、工作流和-BPM-的区别" class="headerlink" title="3、工作流和 BPM 的区别"></a>3、工作流和 BPM 的区别</h2><p>啥叫 BPM，来点小科普。讲 BPM，我们首先就要清楚什么叫业务流程，或者说什么是业务，然后才能明白什么叫业务流程管理。</p>
<p>业务流程简单来说就是业务处理流，或者说业务的流转过程。这里重要的不是“流程”二字，而是“业务”二字。注意，类似于请假不能算是企业的“业务”。例如，你去见一个新客户，客户问你，你的公司主要做什么业务？你总不能说我们公司是做“请假”业务的吧？那么到底业务流程关注的是什么样的业务呢？一句话，对顾客产生价值的流程就是我们这里所关注的“业务流程”。</p>
<ul>
<li>产品和服务的设计与开发</li>
<li>产品和服务的市场营销与销售</li>
<li>产品和服务的交付</li>
<li>客户服务管理</li>
</ul>
<p>业务流程管理是一种以规范化地构造端到端的卓越业务流程为中心，以持续地提高组织业务绩效为目的的系统化管理方法。</p>
<h3 id="3-1-定义不同"><a href="#3-1-定义不同" class="headerlink" title="3.1 定义不同"></a>3.1 定义不同</h3><p>工作流系统是指通过电子版代替纸质版帮助企业处理所有内部事务，实现各种审批工作，支持协同工作中的一部分。</p>
<p>BPM 系统即业务流程是指企业、政府以及其它各种组织,为了达到其业务目标,利用技术实现业务自动化，协助企业业务发展。</p>
<h3 id="3-2-流程架构不同"><a href="#3-2-流程架构不同" class="headerlink" title="3.2 流程架构不同"></a>3.2 流程架构不同</h3><p>工作流系统是从企业内部出发，单一只对企业本部门或者本业务的业务需求，部门与部门之间流程无法衔接，信息的共享和传递困难，存在大量流程断点。</p>
<p>而 BPM 系统可以实现各流程之间可以衔接、协调，避免了流程孤岛的产生。同时，在激烈的市场竞争环境下，对提高整个业务流程运行的效率、成本、等满足客户的需求。</p>
<h3 id="3-3-应用不同"><a href="#3-3-应用不同" class="headerlink" title="3.3 应用不同"></a>3.3 应用不同</h3><p>工作流系统是为帮助企业解决“办公自动化”、“流程自动化”而诞生的应用技术，却不对业务流程进行优化的，功能较单一。</p>
<p>而 BPM 系统可以对业务全过程进行管理，如分析，整合、协助等，确保工作流能够按计划实施。</p>
<h3 id="3-4-集成功能不同"><a href="#3-4-集成功能不同" class="headerlink" title="3.4 集成功能不同"></a>3.4 集成功能不同</h3><p>工作流系统只能对单一业务进行处理。</p>
<p>BPM 可以帮助软件开发人员来集成第三方的应用软件。例如 ERP、PLM、财务软件等可以通过 BPM 平台进行集成。</p>
<h3 id="3-5-流程的持续改进不同"><a href="#3-5-流程的持续改进不同" class="headerlink" title="3.5 流程的持续改进不同"></a>3.5 流程的持续改进不同</h3><p>工作流系统由于业务人员对其缺少认识和关注，及工作流系统本身缺少对内部业务的连接，因此很难对流程进行持续改进。</p>
<p>而 BPM 系统由于可以帮助业务人员密切关注信息系统内嵌流程与其它业务流程衔接关系，可以及时进行流程的调整、改进等，最终是为了优化、提升和自动化处理业务流程。</p>
<p>总之，随着信息技术的高速发展，业务不断扩大，工作流技术一直是企业信息化建设不可或缺的一部分。不管是办公自动化 OA 系统，还是企业 ERP 系统的部署，利用工作流系统和 BPM 系统都是可以提高企业运行效率的。</p>
<p><img src="https://static001.geekbang.org/infoq/17/17be6cbd6a96de6be417948ea6c9ad9f.png" alt="img"></p>
<p><img src="https://static001.geekbang.org/infoq/3c/3cbdc6a491bb85b2a803b7400a64aa9b.png" alt="img"></p>
<h2 id="4、市场上工作流厂商分类"><a href="#4、市场上工作流厂商分类" class="headerlink" title="4、市场上工作流厂商分类"></a>4、市场上工作流厂商分类</h2><p>只提供工作流产品。这类厂商产品单一，尽管产品质量能够得到保证，但是发展最为困难。技术在这里不是第一竞争力。</p>
<p>提供工作流产品和快速开发平台。这类厂商在工作流的基础上提供开发框架进一步简化编程，相比第一类厂商会更有竞争力，但是其发展受到系统集成商的限制。</p>
<p>提供工作流产品和业务套件/平台，同时自己接项目。与单纯的快速开发平台相比，业务平台显然站在了一个更高的层次上。在软件开发中，最大的浪费往往并不在于技术本身，而是在于对业务的不熟悉，在于核心领域模型的频繁变动。对用户而言，根据需要选择合适业务平台和相关服务无疑能够产生最大的价值。这是目前生存状态比较好的厂商，多是老牌厂商或是有充足的资金。业务套件/平台能够给用户提供最大的价值。在任何时候，直接面对最终用户就是王道。</p>
<p><strong>工作流厂商的机会在哪里？</strong></p>
<p>最重要的就是，将产品面向最终用户。</p>
<ul>
<li>提供行业应用业务套件。能够做到对某类应用的快速实施，很多功能能够做到开箱即用。</li>
<li>转向 BPMS。这个需要两方面的努力：一是业务方面需要与业务流程咨询公司进行合作；二是产品需要增加 BPMS 特性。</li>
<li>自己做项目。大公司靠财务，小公司靠销售。</li>
</ul>
<p><img src="https://static001.geekbang.org/infoq/2f/2f28d3e76c56e053f99e5fc36cdd04ab.png" alt="img"></p>
<h2 id="5、流程引擎发展趋势"><a href="#5、流程引擎发展趋势" class="headerlink" title="5、流程引擎发展趋势"></a>5、流程引擎发展趋势</h2><h3 id="5-1-趋势一：中台化"><a href="#5-1-趋势一：中台化" class="headerlink" title="5.1 趋势一：中台化"></a>5.1 趋势一：中台化</h3><p>对于信息化软件的演进，从流程线和开发部署方式两条线来看，分别从轻到重和从重到轻发展，交汇于数字中台。从部署 开发一线来看，传统的开发部署模式时间长、成本高、系统割裂，不能满足企业实现“成本效益”的需求，因而数字中台 转型成为必然的选择。</p>
<p><img src="https://static001.geekbang.org/infoq/45/45e3b9f6c29ce91cf7b8abc07e3fe123.png" alt="img"></p>
<h3 id="5-2-趋势二：低代码"><a href="#5-2-趋势二：低代码" class="headerlink" title="5.2 趋势二：低代码"></a>5.2 趋势二：低代码</h3><p>需求端的 复杂多变对软件开发提出了新的要求，市场要求软件的开发的速度越快越好、交付时间越来越短，“低代码”应运而生。 BPM 在未来也将充分与低代码相结合，BPM 的低代码化主要包含设计端的应用。开发人员寻找通用的开发活动，然后为 所有环节构建一个基本代码并将它们封装在某个可视化的模块里。基于这些模块，业务人员就可以通过拖拉拽的方式，在 可视化的设计器上像“搭积木”一样，对表单、流程和应用进行搭建。这种方式极大地提高了软件开发的敏捷性，同时实 现了“以客户为中心”，使公司更好的响应市场。</p>
<h3 id="5-3-趋势三：智能化"><a href="#5-3-趋势三：智能化" class="headerlink" title="5.3 趋势三：智能化"></a>5.3 趋势三：智能化</h3><p>业务流程管理（BPM）已成为企业内部优化的选择。流程的优化通过节省时间并降低成本为公司带来竞争优势，使员工更 有效地工作。随着市场的成熟度日益提高，各种新兴技术不断发展，BPM 自身也需要与时代结合，不断发展。未来 BPM 将进一步与 RPA（机器人流程自动化）、AI（人工智能）等智能化技术相结合，为企业提供更敏捷、优质的服务。</p>
<h2 id="6、开源流程引擎"><a href="#6、开源流程引擎" class="headerlink" title="6、开源流程引擎"></a>6、开源流程引擎</h2><p>目前 java 主流的开源流程引擎，有 jBPM，Activiti，Camunda，Flowable 等。</p>
<p><img src="https://static001.geekbang.org/infoq/39/39102db51f97b6a0b5f5ce405107f7d9.jpeg?x-oss-process=image/resize,p_80/auto-orient,1" alt="img"></p>
<p><img src="https://static001.geekbang.org/infoq/39/39102db51f97b6a0b5f5ce405107f7d9.jpeg?x-oss-process=image/resize,p_80/auto-orient,1" alt="img"></p>
<p><img src="https://static001.geekbang.org/infoq/93/93b2a1acc4d85f2bfff46d7daab25158.jpeg?x-oss-process=image/resize,p_80/auto-orient,1" alt="img"></p>
<p><img src="https://static001.geekbang.org/infoq/0a/0ac5fddfd0f64c63ce459c4ef0d513eb.jpeg?x-oss-process=image/resize,p_80/auto-orient,1" alt="img"></p>
<p><img src="https://static001.geekbang.org/infoq/9f/9f94b0b008a5263a48fb38bffa16c248.jpeg?x-oss-process=image/resize,p_80/auto-orient,1" alt="img"></p>
<p><img src="https://static001.geekbang.org/infoq/46/46db875d592a6b7029ff6ed840dce57a.jpeg?x-oss-process=image/resize,p_80/auto-orient,1" alt="img"></p>
<p><img src="https://static001.geekbang.org/infoq/21/211dd42b68e4586a281c63cf845c020b.jpeg?x-oss-process=image/resize,p_80/auto-orient,1" alt="img"></p>
<p><img src="https://static001.geekbang.org/infoq/4b/4b55e54e20c695ce3f6b44844865c62a.jpeg?x-oss-process=image/resize,p_80/auto-orient,1" alt="img"></p>
<p><img src="https://static001.geekbang.org/infoq/86/863beea0f45998ca91762fe65e71027c.jpeg?x-oss-process=image/resize,p_80/auto-orient,1" alt="img"></p>
<p><img src="https://static001.geekbang.org/infoq/69/6909702ad3c8f46bb992e91014f330aa.jpeg?x-oss-process=image/resize,p_80/auto-orient,1" alt="img"></p>
<p><img src="https://static001.geekbang.org/infoq/fa/fa8faadc55eae777171d36e595bed017.jpeg?x-oss-process=image/resize,p_80/auto-orient,1" alt="img"></p>
<p><img src="https://static001.geekbang.org/infoq/25/2548176f6404c0ef3181b698e4de63c4.jpeg?x-oss-process=image/resize,p_80/auto-orient,1" alt="img"></p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2021-09-08T08:59:44.000Z">2021-09-08</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    9 分钟 读完 (大约 1401 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2021/09/08/iOS%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%95%B4%E7%90%86/">iOS性能优化整理</a>
            
        </h1>
        <div class="content">
            <h1 id="iOS性能优化整理"><a href="#iOS性能优化整理" class="headerlink" title="iOS性能优化整理"></a>iOS性能优化整理</h1><h3 id="一、性能优化–卡顿"><a href="#一、性能优化–卡顿" class="headerlink" title="一、性能优化–卡顿"></a>一、性能优化–卡顿</h3><p>卡顿的原因主要是CPU、GPU引起的</p>
<p>CPU(中央处理器): 对象的创建和销毁、对象属性的调整、布局计算、文本的计算和排版、图片的格式转换和解码、图像的绘制(Core Graphics)<br>GPU(图形处理器)：纹理的渲染</p>
<p><img src="https://upload-images.jianshu.io/upload_images/3409012-6dc0f656a135c00a.png?imageMogr2/auto-orient/strip%7CimageView2/2/format/webp" alt="img"></p>
<ul>
<li><h5 id="卡顿优化–CPU"><a href="#卡顿优化–CPU" class="headerlink" title="卡顿优化–CPU"></a>卡顿优化–CPU</h5><figure class="highlight objectivec hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">尽量试用轻量级对象，比如用不到事件处理的地方可以考虑试用<span class="hljs-built_in">CALayer</span>取代<span class="hljs-built_in">UIView</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">不要频繁的调用<span class="hljs-built_in">UIView</span>的相关属性，比如frame、bounds、transform等属性，尽量减少不必要的修改</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">尽量提前计算好布局，在有需要时一次性调整对应的属性，不要多次修改属性</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">Autolayout会比直接设置frame消耗更多的CPU资源</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">图片的size最好刚好跟<span class="hljs-built_in">UIImageView</span>的size保持一致</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">控制一下线程的最大并发数量</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">尽量把耗时的操作放在子线程，比如文本处理（尺寸计算、绘制），图片处理（解码、绘制）</span></pre></td></tr></table></figure>



</li>
</ul>
<ul>
<li><h5 id="卡顿优化–GPU"><a href="#卡顿优化–GPU" class="headerlink" title="卡顿优化–GPU"></a>卡顿优化–GPU</h5><figure class="highlight angelscript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">尽量避免短时间内大量图片的显示，尽可能多张突变合成一张显示。</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">GPU能处理的最大纹理尺寸是  <span class="hljs-number">4096</span> x <span class="hljs-number">4096</span>，一旦超过这个尺寸，就会占用CPU资源进行处理，所以纹理尺寸尽量不要超过这个尺寸</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">尽量减少试图数量和层次</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">减少透明的视图(alpha &lt; <span class="hljs-number">1</span>)，不透明的就设置opaque为YES</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">尽量避免出现离屏渲染(设置view的圆角、遮罩、阴影)</span></pre></td></tr></table></figure>
</li>
<li><h5 id="离屏渲染"><a href="#离屏渲染" class="headerlink" title="离屏渲染"></a>离屏渲染</h5><p>在OpenGL中，GPU有两种渲染方式</p>
<ol>
<li><p>on-Screen Rendering：当前屏幕渲染，在当前用于显示的屏幕缓冲区进行渲染操作</p>
</li>
<li><p>off-Screen Rendering：离屏渲染，在当前屏幕缓冲区以外开辟一个新的缓冲区进行渲染操作。</p>
<p>离屏渲染消耗性能的原因：</p>
<figure class="highlight angelscript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-number">1</span>、需要创建新的缓冲区</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-number">2</span>、离屏渲染的整个过程，需要多次切换上下文环境，显示从当前屏幕切换到离屏，等到离屏渲染结束后，将离屏缓冲区的渲染结果显示到屏幕上，又需要将上下文环境从离屏切换到当前屏幕。</span></pre></td></tr></table></figure>

<p>哪些操作会触发离屏渲染</p>
<figure class="highlight yaml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-number">1</span><span class="hljs-string">.</span> <span class="hljs-string">光栅化，layer.shouldRasterize</span>  <span class="hljs-string">=</span> <span class="hljs-literal">YES</span><span class="hljs-string">;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-number">2</span><span class="hljs-string">.</span> <span class="hljs-string">遮罩，layer.mask</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-number">3</span><span class="hljs-string">.</span> <span class="hljs-string">圆角，同时设置layer.masksToBounds</span> <span class="hljs-string">=</span> <span class="hljs-literal">YES</span><span class="hljs-string">，layer.cornerRadius</span> <span class="hljs-string">大于</span> <span class="hljs-number">0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    <span class="hljs-string">可以考虑通过CoreGraphice绘制裁剪圆角，或者叫美工提供圆角图片。</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-number">4</span><span class="hljs-string">.</span> <span class="hljs-string">阴影，layer.shadowXXX，如果设置了layer.shadowPath</span> <span class="hljs-string">就不会产生离屏渲染</span></span></pre></td></tr></table></figure>

</li>
</ol>
</li>
</ul>
<h3 id="二、性能优化–耗电优化"><a href="#二、性能优化–耗电优化" class="headerlink" title="二、性能优化–耗电优化"></a>二、性能优化–耗电优化</h3><p><strong>app中主要的耗电来源于： CPU处理、网络、定位、图像处理</strong></p>
<p>优化方案：</p>
<ul>
<li>尽可能降低CPU、GPU功耗</li>
<li>减少使用定时器</li>
<li>优化I/O操作，例如：</li>
</ul>
<figure class="highlight angelscript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-number">1.</span> 尽量不要频繁的写入小数据，最好批量一次写入</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-number">2.</span> 读写大量重要数据时，考虑用dispatch_io，其提供了基于GCD的异步操作文件I/O的的API。用dispatch_io系统会优化磁盘访问</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-number">3.</span> 数据量比较大时，建议使用数据库(比如SQLite、CoreData)</span></pre></td></tr></table></figure>

<ul>
<li><h4 id="网络优化"><a href="#网络优化" class="headerlink" title="网络优化"></a>网络优化</h4></li>
</ul>
<figure class="highlight angelscript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-number">1.</span> 减少、压缩网络数据</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-number">2.</span> 如果多次请求的结果是相同的，尽量使用缓存</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-number">3.</span> 使用断点续传，否则网络不稳定时可能多次传输相同的内容</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-number">4.</span> 网络不可用时，不要尝试执行网路请求</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-number">5.</span> 让用户可以取消长时间运行或者速度很慢的网络操作，设置合适的超时时间</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-number">6.</span> 批量传输，比如：下载视频时，不要传输很小的数据包，直接下载整个文件或者一大块一大块的下载。如果下载广告，一次性多下载一些，然后在慢慢展示。如果下载电子邮件，一次下载多封，不要一封一封的下载</span></pre></td></tr></table></figure>

<ul>
<li><h4 id="定位优化"><a href="#定位优化" class="headerlink" title="定位优化"></a>定位优化</h4><figure class="highlight angelscript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-number">1</span>、如果只是需要快速确认用户位置，最好用CLLocationManager的requestLocation，定位完后，会自动让定位硬件断电。</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-number">2</span>、如果不是导航应用，尽量不要实时更新位置，定位完毕就关掉定位服务</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-number">3</span>、尽量降低定位精度，比如尽量不要使用最高的kCLLocationAccuracyBest</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="hljs-number">4</span>、需要后台定位时，尽量设置pausesLocationUpdatesAutomaticall为YES，如果用户不太可能移动的时候系统会自动暂停位置更新</span></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="三、-性能优化-–-APP启动优化"><a href="#三、-性能优化-–-APP启动优化" class="headerlink" title="三、 性能优化 – APP启动优化"></a>三、 性能优化 – APP启动优化</h3><p><img src="https://upload-images.jianshu.io/upload_images/3409012-6526057bd0275d03.png?imageMogr2/auto-orient/strip%7CimageView2/2/format/webp" alt="img"></p>
<p>APP冷启动可以概括为三个阶段</p>
<blockquote>
<p>dyld</p>
<p>runtime</p>
<p>main</p>
</blockquote>
<p><img src="https://upload-images.jianshu.io/upload_images/3409012-4be7c1c7affd91ec.png?imageMogr2/auto-orient/strip%7CimageView2/2/format/webp" alt="img"></p>
<ul>
<li><h4 id="dyld"><a href="#dyld" class="headerlink" title="dyld"></a>dyld</h4></li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/3409012-cb82278600dfd514.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>
<ul>
<li><h4 id="runtime"><a href="#runtime" class="headerlink" title="runtime"></a>runtime</h4></li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/3409012-9b181aaab2e1f099.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>
<p><img src="https://upload-images.jianshu.io/upload_images/3409012-32280bf8410bc587.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>
<h4 id="APP启动优化方案："><a href="#APP启动优化方案：" class="headerlink" title="APP启动优化方案："></a>APP启动优化方案：</h4><p><img src="https://upload-images.jianshu.io/upload_images/3409012-16167c889a8c9995.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>
<h3 id="四、-安装包瘦身"><a href="#四、-安装包瘦身" class="headerlink" title="四、 安装包瘦身"></a>四、 安装包瘦身</h3><p><img src="https://upload-images.jianshu.io/upload_images/3409012-6f21d7fdf74ad18d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>

        </div>
        
        
        
    </div>
</div>









    
<div class="card card-transparent">
    <nav class="pagination is-centered" role="navigation" aria-label="pagination">
        <div class="pagination-previous is-invisible is-hidden-mobile">
            <a class="is-flex-grow has-text-black-ter" href="/page/0/">上一页</a>
        </div>
        <div class="pagination-next">
            <a class="is-flex-grow has-text-black-ter" href="/page/2/">下一页</a>
        </div>
        <ul class="pagination-list is-hidden-mobile">
            
            <li><a class="pagination-link is-current" href="/">1</a></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/2/">2</a></li>
            
        </ul>
    </nav>
</div>
</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered" style="flex-shrink: 1">
                <div>
                    
                    <figure class="image is-128x128 has-mb-6">
                        <img class="" src="/images/avatar.png" alt="卢希强">
                    </figure>
                    
                    <p class="is-size-4 is-block">
                        卢希强
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        90后青年
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>湖北武汉</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        文章
                    </p>
                    <p class="title has-text-weight-normal">
                        14
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        分类
                    </p>
                    <p class="title has-text-weight-normal">
                        0
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        标签
                    </p>
                    <p class="title has-text-weight-normal">
                        0
                    </p>
                </div>
            </div>
        </nav>
        
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/luxiqiang" target="_blank">
                关注我</a>
        </div>
        
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Github" href="https://github.com/luxiqiang">
                
                <i class="fab fa-github"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            链接
        </h3>
        <ul class="menu-list">
        
            <li>
                <a class="level is-mobile" href="https://hexo.io" target="_blank">
                    <span class="level-left">
                        <span class="level-item">Hexo</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">hexo.io</span>
                    </span>
                </a>
            </li>
        
        </ul>
        </div>
    </div>
</div>

    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                分类
            </h3>
            <ul class="menu-list">
            
            </ul>
        </div>
    </div>
</div>
    
        
    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
            <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            最新文章
        </h3>
        
        <article class="media">
            
            <a href="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="什么是工作流">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-10-12T11:16:47.000Z">2021-10-12</time></div>
                    <a href="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/" class="title has-link-black-ter is-size-6 has-text-weight-normal">什么是工作流</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2021/10/12/BIM%E4%BB%8B%E7%BB%8D/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="BIM介绍">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-10-12T09:27:11.000Z">2021-10-12</time></div>
                    <a href="/2021/10/12/BIM%E4%BB%8B%E7%BB%8D/" class="title has-link-black-ter is-size-6 has-text-weight-normal">BIM介绍</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2021/09/27/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%9F%A5%E8%AF%86%E4%BD%93%E7%B3%BB/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="微服务知识体系">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-09-27T02:21:45.000Z">2021-09-27</time></div>
                    <a href="/2021/09/27/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%9F%A5%E8%AF%86%E4%BD%93%E7%B3%BB/" class="title has-link-black-ter is-size-6 has-text-weight-normal">微服务知识体系</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2021/09/18/bpmn%E6%B5%81%E7%A8%8B%E6%A8%A1%E5%BC%8F/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="bpmn流程模式">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-09-18T09:12:12.000Z">2021-09-18</time></div>
                    <a href="/2021/09/18/bpmn%E6%B5%81%E7%A8%8B%E6%A8%A1%E5%BC%8F/" class="title has-link-black-ter is-size-6 has-text-weight-normal">bpmn流程模式</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2021/09/17/%E5%B7%A5%E4%BD%9C%E6%B5%81%E8%AE%BE%E8%AE%A1/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="工作流设计">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-09-17T06:57:23.000Z">2021-09-17</time></div>
                    <a href="/2021/09/17/%E5%B7%A5%E4%BD%9C%E6%B5%81%E8%AE%BE%E8%AE%A1/" class="title has-link-black-ter is-size-6 has-text-weight-normal">工作流设计</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            归档
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2021/10/">
                <span class="level-start">
                    <span class="level-item">十月 2021</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2021/09/">
                <span class="level-start">
                    <span class="level-item">九月 2021</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/04/">
                <span class="level-start">
                    <span class="level-item">四月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/12/">
                <span class="level-start">
                    <span class="level-item">十二月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                标签
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
            </div>
        </div>
    </div>
</div>
        
        </div>
    
</div>

                




<div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right ">
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            最新文章
        </h3>
        
        <article class="media">
            
            <a href="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="什么是工作流">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-10-12T11:16:47.000Z">2021-10-12</time></div>
                    <a href="/2021/10/12/%E4%BB%80%E4%B9%88%E6%98%AF%E5%B7%A5%E4%BD%9C%E6%B5%81/" class="title has-link-black-ter is-size-6 has-text-weight-normal">什么是工作流</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2021/10/12/BIM%E4%BB%8B%E7%BB%8D/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="BIM介绍">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-10-12T09:27:11.000Z">2021-10-12</time></div>
                    <a href="/2021/10/12/BIM%E4%BB%8B%E7%BB%8D/" class="title has-link-black-ter is-size-6 has-text-weight-normal">BIM介绍</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2021/09/27/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%9F%A5%E8%AF%86%E4%BD%93%E7%B3%BB/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="微服务知识体系">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-09-27T02:21:45.000Z">2021-09-27</time></div>
                    <a href="/2021/09/27/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%9F%A5%E8%AF%86%E4%BD%93%E7%B3%BB/" class="title has-link-black-ter is-size-6 has-text-weight-normal">微服务知识体系</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2021/09/18/bpmn%E6%B5%81%E7%A8%8B%E6%A8%A1%E5%BC%8F/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="bpmn流程模式">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-09-18T09:12:12.000Z">2021-09-18</time></div>
                    <a href="/2021/09/18/bpmn%E6%B5%81%E7%A8%8B%E6%A8%A1%E5%BC%8F/" class="title has-link-black-ter is-size-6 has-text-weight-normal">bpmn流程模式</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2021/09/17/%E5%B7%A5%E4%BD%9C%E6%B5%81%E8%AE%BE%E8%AE%A1/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="工作流设计">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-09-17T06:57:23.000Z">2021-09-17</time></div>
                    <a href="/2021/09/17/%E5%B7%A5%E4%BD%9C%E6%B5%81%E8%AE%BE%E8%AE%A1/" class="title has-link-black-ter is-size-6 has-text-weight-normal">工作流设计</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            归档
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2021/10/">
                <span class="level-start">
                    <span class="level-item">十月 2021</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2021/09/">
                <span class="level-start">
                    <span class="level-item">九月 2021</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/04/">
                <span class="level-start">
                    <span class="level-item">四月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/12/">
                <span class="level-start">
                    <span class="level-item">十二月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                标签
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
            </div>
        </div>
    </div>
</div>
    
    
</div>

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.svg" alt="luxq blog" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2021 卢希强&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & <a
                        href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>
                
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("zh-CN");</script>

<script>
var IcarusThemeSettings = {
    article: {
        highlight: {
            clipboard: true,
            fold: 'unfolded'
        }
    }
};
</script>


    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>



    
    
<script src="/js/animation.js"></script>

    
    
<script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
<script src="/js/gallery.js" defer></script>

    
    
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/" target="_blank" rel="noopener">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>

    
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>
    
    
<a id="back-to-top" title="回到顶端" href="javascript:;" target="_blank" rel="noopener">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>

    
    
    
    
    
    
    
    
    
    
    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="想要查找什么..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '页面',
                CATEGORIES: '分类',
                TAGS: '标签',
                UNTITLED: '(无标题)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>